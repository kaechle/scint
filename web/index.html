<!DOCTYPE html>
<html style="color-scheme: light dark;">

<head>
  <title>Scint</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <meta theme-color="#1e1e1e">
</head>

<body class="flex flex-col min-h-screen min-w-screen overflow-hidden">
  <div
    class="flex flex-col px-10 h-screen gap-0 spacing-0 overflow-y-auto leading-[1.3] text-md text-stone-50/90 pb-24">
    <div id="chat" class="flex flex-col gap-3 max-w-3xl mx-auto">

    </div>
  </div>

  <div x-data="chatApp()"
    class="w-full flex place-content-center align-items-center absolute bg-[#1e1e1e9e] border-t border-t-zinc-700/20 left-0 bottom-0 backdrop-blur-3xl h-16">
    <input id="input" type="text" placeholder="Scint" autocomplete="off" @keyup.enter="sendMessage()"
      class="w-full mx-6 mt-3.5 h-8 text-md focus:outline-none text-zinc-300 placeholder-zinc-600 bg-zinc-800/60 border border-1 border-zinc-600/50 rounded-full pl-4">
  </div>

  <script>
    function chatApp() {
      return {
        async sendMessage() {
          let inputField = document.getElementById('input');
          let message = inputField.value;
          inputField.value = '';

          let chat = document.getElementById('chat');
          chat.innerHTML += '<div class="flex max-w-[68%] self-end bg-[#6c96fc2c] border border-1 border-t-gray-200/20 border-x-slate-400/20 border-b-sky-300/10 shadow-xl py-3 px-4 rounded-3xl"><p>' +
            message + '</p></div>';

          try {
            let response = await fetch('http://localhost:5000/message', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({ message: message })
            });

            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }

            let data = await response.json();
            chat.innerHTML += '<div class="flex max-w-[68%] bg-[#7ca6fc09] border border-1 border-t-zinc-100/10 border-x-slate-300/10 border-b-blue-300/5 shadow-md py-3 px-4 text-stone-100/80 rounded-3xl"><p>' + data.response + '</p></div>';
          } catch (error) {
            console.log('There was a problem with the fetch operation: ' +
              error.message);
          }
        }
      }
    }
  </script>
</body>

</html>