[23-09-01 18:54] core.chat.init_chat: Starting chat process.
[23-09-01 18:54] core.handler.__init__: Calling message handler.
[23-09-01 18:54] core.handler.build_manifest: Building message package manifest.
[23-09-01 18:54] core.handler.format_message: Formatting message.
[23-09-01 18:54] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 18:54] core.data.db.insert_message: Inserting message into database.
[23-09-01 18:54] core.handler.store_message: Stored user message in the database.
[23-09-01 18:54] core.chat.init_chat: Response received: Hello Tim! How can I assist you today?
[23-09-01 18:54] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 18:54] core.data.db.insert_message: Inserting message into database.
[23-09-01 18:54] core.handler.store_message: Stored assistant message in the database.
[23-09-01 18:57] core.chat.init_chat: Starting chat process.
[23-09-01 18:57] core.handler.__init__: Calling message handler.
[23-09-01 18:57] core.handler.build_manifest: Building message package manifest.
[23-09-01 18:57] core.handler.format_message: Formatting message.
[23-09-01 18:57] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 18:57] core.data.db.insert_message: Inserting message into database.
[23-09-01 18:57] core.handler.store_message: Stored user message in the database.
[23-09-01 18:57] core.chat.init_chat: Response received: Hello, Tim! How can I assist you today?
[23-09-01 18:57] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 18:57] core.data.db.insert_message: Inserting message into database.
[23-09-01 18:57] core.handler.store_message: Stored assistant message in the database.
[23-09-01 19:01] core.chat.init_chat: Starting chat process.
[23-09-01 19:01] core.handler.__init__: Calling message handler.
[23-09-01 19:01] core.handler.build_manifest: Building message package manifest.
[23-09-01 19:01] core.handler.format_message: Formatting message.
[23-09-01 19:01] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:01] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:01] core.handler.store_message: Stored user message in the database.
[23-09-01 19:01] core.chat.init_chat: Response received: Hello Tim! How can I assist you today?
[23-09-01 19:01] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:01] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:01] core.handler.store_message: Stored assistant message in the database.
[23-09-01 19:04] core.chat.init_chat: Starting chat process.
[23-09-01 19:04] core.handler.__init__: Calling message handler.
[23-09-01 19:04] core.handler.build_manifest: Building message package manifest.
[23-09-01 19:04] core.handler.format_message: Formatting message.
[23-09-01 19:04] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:04] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:04] core.handler.store_message: Stored user message in the database.
[23-09-01 19:04] core.chat.init_chat: Response received: Hello, Tim! How can I assist you today?
[23-09-01 19:04] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:04] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:04] core.handler.store_message: Stored assistant message in the database.
[23-09-01 19:05] core.chat.init_chat: Starting chat process.
[23-09-01 19:05] core.handler.__init__: Calling message handler.
[23-09-01 19:05] core.handler.build_manifest: Building message package manifest.
[23-09-01 19:05] core.handler.format_message: Formatting message.
[23-09-01 19:05] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:05] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:05] core.handler.store_message: Stored user message in the database.
[23-09-01 19:05] core.chat.init_chat: Response received: Hello Tim! How can I assist you today?
[23-09-01 19:05] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:05] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:05] core.handler.store_message: Stored assistant message in the database.
[23-09-01 19:06] core.chat.init_chat: Starting chat process.
[23-09-01 19:06] core.handler.__init__: Calling message handler.
[23-09-01 19:06] core.handler.build_manifest: Building message package manifest.
[23-09-01 19:06] core.handler.format_message: Formatting message.
[23-09-01 19:06] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:06] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:06] core.handler.store_message: Stored user message in the database.
[23-09-01 19:07] core.chat.init_chat: Response received: Hello Tim! How can I assist you today?
[23-09-01 19:07] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:07] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:07] core.handler.store_message: Stored assistant message in the database.
[23-09-01 19:08] core.chat.init_chat: Starting chat process.
[23-09-01 19:08] core.handler.__init__: Calling message handler.
[23-09-01 19:08] core.handler.build_manifest: Building message package manifest.
[23-09-01 19:08] core.handler.format_message: Formatting message.
[23-09-01 19:08] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:08] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:08] core.handler.store_message: Stored user message in the database.
[23-09-01 19:08] core.chat.init_chat: Response received: 
<fg #bdc1ca>Hello, Tim! How can I assist you today?</fg #bdc1ca>
[23-09-01 19:08] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:08] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:08] core.handler.store_message: Stored assistant message in the database.
[23-09-01 19:11] core.chat.init_chat: Starting chat process.
[23-09-01 19:11] core.handler.__init__: Calling message handler.
[23-09-01 19:11] core.handler.build_manifest: Building message package manifest.
[23-09-01 19:11] core.handler.format_message: Formatting message.
[23-09-01 19:11] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:11] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:11] core.handler.store_message: Stored user message in the database.
[23-09-01 19:11] core.chat.init_chat: Response received: 
Hello, Tim! How can I assist you today?
[23-09-01 19:11] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:11] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:11] core.handler.store_message: Stored assistant message in the database.
[23-09-01 19:11] core.chat.init_chat: Starting chat process.
[23-09-01 19:11] core.handler.__init__: Calling message handler.
[23-09-01 19:11] core.handler.build_manifest: Building message package manifest.
[23-09-01 19:11] core.handler.format_message: Formatting message.
[23-09-01 19:11] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:11] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:11] core.handler.store_message: Stored user message in the database.
[23-09-01 19:11] core.chat.init_chat: Response received: 

Hello, Tim! How can I assist you today?

[23-09-01 19:11] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:11] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:11] core.handler.store_message: Stored assistant message in the database.
[23-09-01 19:15] core.chat.init_chat: Starting chat process.
[23-09-01 19:15] core.handler.__init__: Calling message handler.
[23-09-01 19:15] core.handler.build_manifest: Building message package manifest.
[23-09-01 19:15] core.handler.format_message: Formatting message.
[23-09-01 19:15] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:15] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:15] core.handler.store_message: Stored user message in the database.
[23-09-01 19:15] core.chat.init_chat: Response received.
 ❯ Hello, Tim! How can I assist you today?
[23-09-01 19:15] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:15] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:15] core.handler.store_message: Stored assistant message in the database.
[23-09-01 19:19] core.cli.run_cli: Starting CLI.
[23-09-01 19:22] core.cli.run_cli: Starting CLI.
[23-09-01 19:22] core.cli.run_cli: Starting CLI.
[23-09-01 19:23] core.chat.init_chat: Starting chat process.
[23-09-01 19:23] core.handler.__init__: Calling message handler.
[23-09-01 19:23] core.handler.build_manifest: Building message package manifest.
[23-09-01 19:23] core.handler.format_message: Formatting message.
[23-09-01 19:23] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:23] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:23] core.handler.store_message: Stored user message in the database.
[23-09-01 19:23] core.chat.init_chat: Response received.
 ❯ Hello Tim! How can I assist you today?
[23-09-01 19:23] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 19:23] core.data.db.insert_message: Inserting message into database.
[23-09-01 19:23] core.handler.store_message: Stored assistant message in the database.
[23-09-01 22:26] core.cli.run_cli: Starting CLI.
[23-09-01 22:27] core.cli.run_cli: Starting CLI.
[23-09-01 22:27] core.state.__init__: Application state initalized: idle
[23-09-01 22:31] core.cli.run_cli: Starting CLI.
[23-09-01 22:31] core.state.__init__: Application state initalized: idle
[23-09-01 23:06] core.cli.run_cli: Starting CLI.
[23-09-01 23:06] core.state.__init__: Application state initalized: idle
[23-09-01 23:06] core.chat.init_chat: Starting chat process.
[23-09-01 23:06] core.handler.__init__: Message handler initialized.
[23-09-01 23:06] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:06] core.handler.format_message: Formatting message.
[23-09-01 23:06] core.handler.format_message: Formatting message.
[23-09-01 23:06] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 23:06] core.data.db.insert_message: Inserting message into database.
[23-09-01 23:06] core.handler.store_message: Stored user message in the database.
[23-09-01 23:06] core.chat.init_chat: Starting chat process.
[23-09-01 23:06] core.handler.__init__: Message handler initialized.
[23-09-01 23:06] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:06] core.handler.format_message: Formatting message.
[23-09-01 23:06] core.handler.format_message: Formatting message.
[23-09-01 23:06] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 23:06] core.data.db.insert_message: Inserting message into database.
[23-09-01 23:06] core.handler.store_message: Stored user message in the database.
[23-09-01 23:06] core.chat.init_chat: Starting chat process.
[23-09-01 23:06] core.handler.__init__: Message handler initialized.
[23-09-01 23:06] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:06] core.handler.format_message: Formatting message.
[23-09-01 23:06] core.handler.format_message: Formatting message.
[23-09-01 23:06] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 23:06] core.data.db.insert_message: Inserting message into database.
[23-09-01 23:06] core.handler.store_message: Stored user message in the database.
[23-09-01 23:13] core.cli.run_cli: Starting CLI.
[23-09-01 23:13] core.state.__init__: Application state initalized: idle
[23-09-01 23:13] core.chat.init_chat: Starting chat process.
[23-09-01 23:13] core.handler.__init__: Message handler initialized.
[23-09-01 23:13] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:13] core.handler.format_message: Formatting message.
[23-09-01 23:13] core.chat.init_chat: There was a problem delivering the message manifest: unsupported operand type(s) for 'in': 'str' and 'EnumType'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 74, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x104320040>
    │       └ <function run at 0x1017d7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10174f6e0>
           │      └ <function Runner.run at 0x1017dfe20>
           └ <asyncio.runners.Runner object at 0x104218910>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/core/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1017dda80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104218910>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1017dd9e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1017df7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101721b20>
    └ <Handle <TaskStepMethWrapper object at 0x1031b88e0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1031b88e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1031b88e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1031b88e0>()>

  File "/Users/kaechle/Developer/projects/scint/core/cli.py", line 53, in run_cli
    await init_chat(user_message)  # type: ignore
          │         └ '/msg hello'
          └ <function init_chat at 0x1042cfec0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hello',)
                 └ <function init_chat at 0x1042cf600>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hello',)
                   └ <function init_chat at 0x1033e0900>

> File "/Users/kaechle/Developer/projects/scint/core/chat.py", line 18, in init_chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1042ce020>
                                └ <core.handler.MessageHandler object at 0x1041ecc10>

  File "/Users/kaechle/Developer/projects/scint/core/handler.py", line 56, in build_manifest
    sys_init = self.format_message(system_message, self.roles[0], "system")
               │    │              │               │    └ ['system', 'assistant', 'user']
               │    │              │               └ <core.handler.MessageHandler object at 0x1041ecc10>
               │    │              └ 'You are Scint, a stateful, collaborative, intelligent assistant. You have access to a secure sandbox environment which you c...
               │    └ <function MessageHandler.format_message at 0x1042cd080>
               └ <core.handler.MessageHandler object at 0x1041ecc10>

  File "/Users/kaechle/Developer/projects/scint/core/handler.py", line 31, in format_message
    if role not in Role:
       │           └ <enum 'Role'>
       └ 'system'

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/enum.py", line 740, in __contains__
    raise TypeError(

TypeError: unsupported operand type(s) for 'in': 'str' and 'EnumType'
[23-09-01 23:13] core.chat.init_chat: Starting chat process.
[23-09-01 23:13] core.handler.__init__: Message handler initialized.
[23-09-01 23:13] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:13] core.handler.format_message: Formatting message.
[23-09-01 23:13] core.chat.init_chat: There was a problem delivering the message manifest: unsupported operand type(s) for 'in': 'str' and 'EnumType'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 74, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x104320040>
    │       └ <function run at 0x1017d7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10174f6e0>
           │      └ <function Runner.run at 0x1017dfe20>
           └ <asyncio.runners.Runner object at 0x104218910>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/core/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1017dda80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104218910>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1017dd9e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1017df7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101721b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/core/cli.py", line 53, in run_cli
    await init_chat(user_message)  # type: ignore
          │         └ '/msg hello'
          └ <function init_chat at 0x1042cfec0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hello',)
                 └ <function init_chat at 0x1042cf600>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hello',)
                   └ <function init_chat at 0x1033e0900>

> File "/Users/kaechle/Developer/projects/scint/core/chat.py", line 18, in init_chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1042ce020>
                                └ <core.handler.MessageHandler object at 0x1041ec4d0>

  File "/Users/kaechle/Developer/projects/scint/core/handler.py", line 56, in build_manifest
    sys_init = self.format_message(system_message, self.roles[0], "system")
               │    │              │               │    └ ['system', 'assistant', 'user']
               │    │              │               └ <core.handler.MessageHandler object at 0x1041ec4d0>
               │    │              └ 'You are Scint, a stateful, collaborative, intelligent assistant. You have access to a secure sandbox environment which you c...
               │    └ <function MessageHandler.format_message at 0x1042cd080>
               └ <core.handler.MessageHandler object at 0x1041ec4d0>

  File "/Users/kaechle/Developer/projects/scint/core/handler.py", line 31, in format_message
    if role not in Role:
       │           └ <enum 'Role'>
       └ 'system'

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/enum.py", line 740, in __contains__
    raise TypeError(

TypeError: unsupported operand type(s) for 'in': 'str' and 'EnumType'
[23-09-01 23:13] core.chat.init_chat: Starting chat process.
[23-09-01 23:13] core.handler.__init__: Message handler initialized.
[23-09-01 23:13] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:13] core.handler.format_message: Formatting message.
[23-09-01 23:13] core.chat.init_chat: There was a problem delivering the message manifest: unsupported operand type(s) for 'in': 'str' and 'EnumType'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 74, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x104320040>
    │       └ <function run at 0x1017d7c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10174f6e0>
           │      └ <function Runner.run at 0x1017dfe20>
           └ <asyncio.runners.Runner object at 0x104218910>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/core/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1017dda80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104218910>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1017dd9e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1017df7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101721b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/core/cli.py", line 53, in run_cli
    await init_chat(user_message)  # type: ignore
          │         └ '/msg hello'
          └ <function init_chat at 0x1042cfec0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hello',)
                 └ <function init_chat at 0x1042cf600>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hello',)
                   └ <function init_chat at 0x1033e0900>

> File "/Users/kaechle/Developer/projects/scint/core/chat.py", line 18, in init_chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1042ce020>
                                └ <core.handler.MessageHandler object at 0x104271910>

  File "/Users/kaechle/Developer/projects/scint/core/handler.py", line 56, in build_manifest
    sys_init = self.format_message(system_message, self.roles[0], "system")
               │    │              │               │    └ ['system', 'assistant', 'user']
               │    │              │               └ <core.handler.MessageHandler object at 0x104271910>
               │    │              └ 'You are Scint, a stateful, collaborative, intelligent assistant. You have access to a secure sandbox environment which you c...
               │    └ <function MessageHandler.format_message at 0x1042cd080>
               └ <core.handler.MessageHandler object at 0x104271910>

  File "/Users/kaechle/Developer/projects/scint/core/handler.py", line 31, in format_message
    if role not in Role:
       │           └ <enum 'Role'>
       └ 'system'

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/enum.py", line 740, in __contains__
    raise TypeError(

TypeError: unsupported operand type(s) for 'in': 'str' and 'EnumType'
[23-09-01 23:15] core.cli.run_cli: Starting CLI.
[23-09-01 23:15] core.state.__init__: Application state initalized: idle
[23-09-01 23:15] core.chat.init_chat: Starting chat process.
[23-09-01 23:15] core.handler.__init__: Message handler initialized.
[23-09-01 23:15] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:15] core.chat.init_chat: There was a problem delivering the message manifest: 'MessageHandler' object has no attribute 'roles'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 74, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1080e8040>
    │       └ <function run at 0x10559fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1055176e0>
           │      └ <function Runner.run at 0x1055a7e20>
           └ <asyncio.runners.Runner object at 0x107e6c6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/core/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1055a5a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107e6c6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1055a59e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1055a77e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1054e9b20>
    └ <Handle <TaskStepMethWrapper object at 0x107dd2e90>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x107dd2e90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x107dd2e90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x107dd2e90>()>

  File "/Users/kaechle/Developer/projects/scint/core/cli.py", line 53, in run_cli
    await init_chat(user_message)  # type: ignore
          │         └ '/msg hello'
          └ <function init_chat at 0x108097ec0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hello',)
                 └ <function init_chat at 0x108097600>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hello',)
                   └ <function init_chat at 0x1071a8900>

> File "/Users/kaechle/Developer/projects/scint/core/chat.py", line 18, in init_chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x108096020>
                                └ <core.handler.MessageHandler object at 0x107e5c3d0>

  File "/Users/kaechle/Developer/projects/scint/core/handler.py", line 55, in build_manifest
    sys_init = self.format_message(system_message, self.roles[0], "system")
               │    │              │               └ <core.handler.MessageHandler object at 0x107e5c3d0>
               │    │              └ 'You are Scint, a stateful, collaborative, intelligent assistant. You have access to a secure sandbox environment which you c...
               │    └ <function MessageHandler.format_message at 0x108095080>
               └ <core.handler.MessageHandler object at 0x107e5c3d0>

AttributeError: 'MessageHandler' object has no attribute 'roles'
[23-09-01 23:15] core.chat.init_chat: Starting chat process.
[23-09-01 23:15] core.handler.__init__: Message handler initialized.
[23-09-01 23:15] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:15] core.chat.init_chat: There was a problem delivering the message manifest: 'MessageHandler' object has no attribute 'roles'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 74, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1080e8040>
    │       └ <function run at 0x10559fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1055176e0>
           │      └ <function Runner.run at 0x1055a7e20>
           └ <asyncio.runners.Runner object at 0x107e6c6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/core/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1055a5a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107e6c6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1055a59e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1055a77e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1054e9b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/core/cli.py", line 53, in run_cli
    await init_chat(user_message)  # type: ignore
          │         └ '/msg hello'
          └ <function init_chat at 0x108097ec0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hello',)
                 └ <function init_chat at 0x108097600>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hello',)
                   └ <function init_chat at 0x1071a8900>

> File "/Users/kaechle/Developer/projects/scint/core/chat.py", line 18, in init_chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x108096020>
                                └ <core.handler.MessageHandler object at 0x107fb4810>

  File "/Users/kaechle/Developer/projects/scint/core/handler.py", line 55, in build_manifest
    sys_init = self.format_message(system_message, self.roles[0], "system")
               │    │              │               └ <core.handler.MessageHandler object at 0x107fb4810>
               │    │              └ 'You are Scint, a stateful, collaborative, intelligent assistant. You have access to a secure sandbox environment which you c...
               │    └ <function MessageHandler.format_message at 0x108095080>
               └ <core.handler.MessageHandler object at 0x107fb4810>

AttributeError: 'MessageHandler' object has no attribute 'roles'
[23-09-01 23:18] core.cli.run_cli: Starting CLI.
[23-09-01 23:18] core.state.__init__: Application state initalized: idle
[23-09-01 23:18] core.chat.init_chat: Starting chat process.
[23-09-01 23:18] core.handler.__init__: Message handler initialized.
[23-09-01 23:18] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:18] core.handler.format_message: Formatting message.
[23-09-01 23:18] core.handler.format_message: Formatting message.
[23-09-01 23:18] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 23:18] core.data.db.insert_message: Inserting message into database.
[23-09-01 23:18] core.handler.store_message: Stored user message in the database.
[23-09-01 23:18] core.chat.init_chat: Starting chat process.
[23-09-01 23:18] core.handler.__init__: Message handler initialized.
[23-09-01 23:18] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:18] core.handler.format_message: Formatting message.
[23-09-01 23:18] core.handler.format_message: Formatting message.
[23-09-01 23:18] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 23:18] core.data.db.insert_message: Inserting message into database.
[23-09-01 23:18] core.handler.store_message: Stored user message in the database.
[23-09-01 23:18] core.chat.init_chat: Starting chat process.
[23-09-01 23:18] core.handler.__init__: Message handler initialized.
[23-09-01 23:18] core.handler.build_manifest: Building message package manifest.
[23-09-01 23:18] core.handler.format_message: Formatting message.
[23-09-01 23:18] core.handler.format_message: Formatting message.
[23-09-01 23:18] core.data.db.init_sql_connection: Opening database connection.
[23-09-01 23:18] core.data.db.insert_message: Inserting message into database.
[23-09-01 23:18] core.handler.store_message: Stored user message in the database.
[23-09-02 00:35] core.cli.run_cli: Starting CLI.
[23-09-02 00:35] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 00:36] core.cli.run_cli: Starting CLI.
[23-09-02 00:36] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 00:36] core.chat.init_chat: Starting chat process.
[23-09-02 00:36] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:36] core.handlers.chat.build_manifest: Building message package manifest.
[23-09-02 00:36] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:36] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:36] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:36] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:36] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:36] core.chat.init_chat: Starting chat process.
[23-09-02 00:36] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:36] core.handlers.chat.build_manifest: Building message package manifest.
[23-09-02 00:36] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:36] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:36] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:36] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:36] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:36] core.chat.init_chat: Starting chat process.
[23-09-02 00:36] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:36] core.handlers.chat.build_manifest: Building message package manifest.
[23-09-02 00:36] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:36] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:36] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:36] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:36] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:50] core.cli.run_cli: Starting CLI.
[23-09-02 00:50] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 00:50] core.chat.init_chat: Starting chat process.
[23-09-02 00:50] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:50] core.handlers.chat.build_manifest: Building message package manifest.
[23-09-02 00:50] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:50] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:50] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:50] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:50] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:50] core.chat.init_chat: Starting chat process.
[23-09-02 00:50] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:50] core.handlers.chat.build_manifest: Building message package manifest.
[23-09-02 00:50] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:50] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:50] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:50] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:50] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:50] core.chat.init_chat: Starting chat process.
[23-09-02 00:50] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:50] core.handlers.chat.build_manifest: Building message package manifest.
[23-09-02 00:50] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:50] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:50] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:50] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:50] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:55] core.cli.run_cli: Starting CLI.
[23-09-02 00:55] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 00:55] core.chat.init_chat: Starting chat process.
[23-09-02 00:55] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:55] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 00:55] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:55] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:55] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:55] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:55] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:56] core.chat.init_chat: Starting chat process.
[23-09-02 00:56] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:56] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 00:56] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:56] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:56] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:56] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:56] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:56] core.chat.init_chat: Starting chat process.
[23-09-02 00:56] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:56] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 00:56] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:56] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:56] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:56] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:56] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:58] core.cli.run_cli: Starting CLI.
[23-09-02 00:58] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 00:58] core.chat.init_chat: Starting chat process.
[23-09-02 00:58] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:58] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:58] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:58] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:58] core.chat.init_chat: Starting chat process.
[23-09-02 00:58] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:58] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:58] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:58] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:58] core.chat.init_chat: Starting chat process.
[23-09-02 00:58] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:58] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:58] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:58] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:58] core.cli.run_cli: Starting CLI.
[23-09-02 00:58] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 00:58] core.chat.init_chat: Starting chat process.
[23-09-02 00:58] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:58] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:58] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:58] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:58] core.chat.init_chat: There was a problem delivering the message manifest: the JSON object must be str, bytes or bytearray, not OpenAIObject
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x10390bd80>
    │       └ <function run at 0x100e0fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10390c940>
           │      └ <function Runner.run at 0x100e17e20>
           └ <asyncio.runners.Runner object at 0x1037a8150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/core/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100e15a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1037a8150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100e159e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100e177e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100d59b20>
    └ <Handle <TaskStepMethWrapper object at 0x10333ad40>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10333ad40>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10333ad40>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10333ad40>()>

  File "/Users/kaechle/Developer/projects/scint/core/cli.py", line 51, in run_cli
    await init_chat(user_message)  # type: ignore
          │         └ '/msg Hi. '
          └ <function init_chat at 0x10390bce0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg Hi. ',)
                 └ <function init_chat at 0x10390b420>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg Hi. ',)
                   └ <function init_chat at 0x102a189a0>

> File "/Users/kaechle/Developer/projects/scint/core/chat.py", line 24, in init_chat
    response = await openai(messages, functions)
                     │      │         └ [{'name': 'classify_message', 'description': "Use this function to classify the user's message and assign keywords to it. You...
                     │      └ [{'content': 'You are Scint, a stateful, collaborative, intelligent assistant built around  a large language model, you have ...
                     └ <function openai at 0x102a187c0>

  File "/Users/kaechle/Developer/projects/scint/core/providers/models.py", line 30, in openai
    return json.loads(response)
           │    │     └ <OpenAIObject chat.completion id=chatcmpl-7uC4SRdLrxsYky5Zs2TTFuweVd9bb at 0x103c3d730> JSON: {
           │    │         "id": "chatcmpl-7uC4SRdLrxs...
           │    └ <function loads at 0x1014b14e0>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 339, in loads
    raise TypeError(f'the JSON object must be str, bytes or bytearray, '

TypeError: the JSON object must be str, bytes or bytearray, not OpenAIObject
[23-09-02 00:58] core.chat.init_chat: Starting chat process.
[23-09-02 00:58] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:58] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:58] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:58] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:58] core.chat.init_chat: There was a problem delivering the message manifest: the JSON object must be str, bytes or bytearray, not OpenAIObject
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x10390bd80>
    │       └ <function run at 0x100e0fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10390c940>
           │      └ <function Runner.run at 0x100e17e20>
           └ <asyncio.runners.Runner object at 0x1037a8150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/core/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100e15a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1037a8150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100e159e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100e177e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100d59b20>
    └ <Handle <TaskStepMethWrapper object at 0x10352f6d0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10352f6d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10352f6d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10352f6d0>()>

  File "/Users/kaechle/Developer/projects/scint/core/cli.py", line 51, in run_cli
    await init_chat(user_message)  # type: ignore
          │         └ '/msg Hi. '
          └ <function init_chat at 0x10390bce0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg Hi. ',)
                 └ <function init_chat at 0x10390b420>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg Hi. ',)
                   └ <function init_chat at 0x102a189a0>

> File "/Users/kaechle/Developer/projects/scint/core/chat.py", line 24, in init_chat
    response = await openai(messages, functions)
                     │      │         └ [{'name': 'classify_message', 'description': "Use this function to classify the user's message and assign keywords to it. You...
                     │      └ [{'content': 'You are Scint, a stateful, collaborative, intelligent assistant built around  a large language model, you have ...
                     └ <function openai at 0x102a187c0>

  File "/Users/kaechle/Developer/projects/scint/core/providers/models.py", line 30, in openai
    return json.loads(response)
           │    │     └ <OpenAIObject chat.completion id=chatcmpl-7uC4VlSbYj6ZdlfcDMm7UfEAvOTLE at 0x103947530> JSON: {
           │    │         "id": "chatcmpl-7uC4VlSbYj6...
           │    └ <function loads at 0x1014b14e0>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 339, in loads
    raise TypeError(f'the JSON object must be str, bytes or bytearray, '

TypeError: the JSON object must be str, bytes or bytearray, not OpenAIObject
[23-09-02 00:58] core.chat.init_chat: Starting chat process.
[23-09-02 00:58] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 00:58] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.handlers.chat.format_message: Formatting message.
[23-09-02 00:58] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 00:58] core.data.db.insert_message: Inserting message into database.
[23-09-02 00:58] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 00:58] core.chat.init_chat: There was a problem delivering the message manifest: the JSON object must be str, bytes or bytearray, not OpenAIObject
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x10390bd80>
    │       └ <function run at 0x100e0fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10390c940>
           │      └ <function Runner.run at 0x100e17e20>
           └ <asyncio.runners.Runner object at 0x1037a8150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/core/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100e15a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1037a8150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100e159e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100e177e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100d59b20>
    └ <Handle <TaskStepMethWrapper object at 0x10333bac0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10333bac0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10333bac0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10333bac0>()>

  File "/Users/kaechle/Developer/projects/scint/core/cli.py", line 51, in run_cli
    await init_chat(user_message)  # type: ignore
          │         └ '/msg Hi. '
          └ <function init_chat at 0x10390bce0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg Hi. ',)
                 └ <function init_chat at 0x10390b420>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg Hi. ',)
                   └ <function init_chat at 0x102a189a0>

> File "/Users/kaechle/Developer/projects/scint/core/chat.py", line 24, in init_chat
    response = await openai(messages, functions)
                     │      │         └ [{'name': 'classify_message', 'description': "Use this function to classify the user's message and assign keywords to it. You...
                     │      └ [{'content': 'You are Scint, a stateful, collaborative, intelligent assistant built around  a large language model, you have ...
                     └ <function openai at 0x102a187c0>

  File "/Users/kaechle/Developer/projects/scint/core/providers/models.py", line 30, in openai
    return json.loads(response)
           │    │     └ <OpenAIObject chat.completion id=chatcmpl-7uC4X50VoBZlhdjnvqfoNCSbm3mMM at 0x103c3cef0> JSON: {
           │    │         "id": "chatcmpl-7uC4X50VoBZ...
           │    └ <function loads at 0x1014b14e0>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 339, in loads
    raise TypeError(f'the JSON object must be str, bytes or bytearray, '

TypeError: the JSON object must be str, bytes or bytearray, not OpenAIObject
[23-09-02 01:00] core.cli.run_cli: Starting CLI.
[23-09-02 01:00] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 01:00] core.chat.init_chat: Starting chat process.
[23-09-02 01:00] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:00] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:00] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:00] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:00] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:00] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:00] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:00] core.chat.init_chat: Response received.
 ❯ Hello Tim! How can I assist you today?
[23-09-02 01:00] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:00] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:00] core.handlers.chat.store_message: Stored assistant message in the database.
[23-09-02 01:06] core.cli.run_cli: Starting CLI.
[23-09-02 01:06] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 01:06] core.chat.init_chat: Starting chat process.
[23-09-02 01:06] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:06] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:06] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:06] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:06] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:06] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:06] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:06] core.chat.init_chat: Starting chat process.
[23-09-02 01:06] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:06] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:06] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:06] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:06] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:06] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:06] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:06] core.chat.init_chat: Response received.
 ❯ Hello Tim! How can I assist you today?
[23-09-02 01:06] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:06] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:06] core.handlers.chat.store_message: Stored assistant message in the database.
[23-09-02 01:07] core.chat.init_chat: Starting chat process.
[23-09-02 01:07] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:07] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:07] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:07] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:07] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:07] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:07] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:07] core.chat.init_chat: Starting chat process.
[23-09-02 01:07] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:07] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:07] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:07] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:07] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:07] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:07] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:07] core.chat.init_chat: Response received.
 ❯ Hello Tim! How can I assist you today?
[23-09-02 01:07] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:07] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:07] core.handlers.chat.store_message: Stored assistant message in the database.
[23-09-02 01:07] core.cli.run_cli: Starting CLI.
[23-09-02 01:07] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 01:07] core.chat.init_chat: Starting chat process.
[23-09-02 01:07] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:07] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:07] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:07] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:07] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:07] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:07] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:08] core.chat.init_chat: Response received.
 ❯ Sure, here is a simple poem for you:

In the quiet of the night,
Underneath the pale moonlight,
Dreams take flight in silent whispers,
Among the stars, like glowing embers.

Rivers flow with gentle might,
Forests breathe in soft twilight,
Nature sings in quiet verses,
A symphony of universe's rehearses.

Moments pass, fleeting and brief,
Yet they hold joy, sorrow, and belief.
Life's a journey, not a race,
Full of beauty, love and grace.
[23-09-02 01:08] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:08] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:08] core.handlers.chat.store_message: Stored assistant message in the database.
[23-09-02 01:11] core.cli.run_cli: Starting CLI.
[23-09-02 01:11] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 01:12] core.chat.init_chat: Starting chat process.
[23-09-02 01:12] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:12] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:12] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:12] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:12] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:12] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:12] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:12] core.chat.init_chat: Starting chat process.
[23-09-02 01:12] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:12] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:12] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:12] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:12] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:12] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:12] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:12] core.chat.init_chat: Starting chat process.
[23-09-02 01:12] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:12] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:12] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:12] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:12] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:12] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:12] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:13] core.cli.run_cli: Starting CLI.
[23-09-02 01:13] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 01:13] core.chat.init_chat: Starting chat process.
[23-09-02 01:13] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:13] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:13] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:13] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:13] core.chat.init_chat: Starting chat process.
[23-09-02 01:13] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:13] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:13] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:13] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:13] core.chat.init_chat: Starting chat process.
[23-09-02 01:13] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:13] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:13] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:13] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:13] core.cli.run_cli: Starting CLI.
[23-09-02 01:13] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 01:13] core.chat.init_chat: Starting chat process.
[23-09-02 01:13] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:13] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:13] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:13] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:13] core.handlers.process.eval_function: Classifying message.
[23-09-02 01:13] core.handlers.process.eval_function: Keywords: joke, humor, fun
[23-09-02 01:13] core.chat.init_chat: Starting chat process.
[23-09-02 01:13] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:13] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:13] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:13] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:13] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:13] core.chat.init_chat: Response received.
 ❯ Hello Tim, how can I assist you today?
[23-09-02 01:13] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:13] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:13] core.handlers.chat.store_message: Stored assistant message in the database.
[23-09-02 01:14] core.cli.run_cli: Starting CLI.
[23-09-02 01:14] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 01:15] core.chat.init_chat: Starting chat process.
[23-09-02 01:15] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:15] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:15] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:15] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:15] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:15] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:15] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:15] core.chat.init_chat: Response received.
 ❯ Sure, here's a light-hearted joke for you:

Why don't scientists trust atoms?

Because they make up everything!
[23-09-02 01:15] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:15] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:15] core.handlers.chat.store_message: Stored assistant message in the database.
[23-09-02 01:16] core.cli.run_cli: Starting CLI.
[23-09-02 01:16] core.state.__init__: Application state initialized: AppState.IDLE
[23-09-02 01:16] core.chat.init_chat: Starting chat process.
[23-09-02 01:16] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:16] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:16] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:16] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:16] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:16] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:16] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:16] core.chat.init_chat: Response received.
 ❯ Sure, here's a light-hearted joke for you:

Why don't scientists trust atoms?

Because they make up everything!
[23-09-02 01:16] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:16] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:16] core.handlers.chat.store_message: Stored assistant message in the database.
[23-09-02 01:35] core.cli.run_cli: Starting CLI.
[23-09-02 01:35] core.state.__init__: Application state initialized: AppState.DEFAULT
[23-09-02 01:35] core.chat.init_chat: Starting chat process.
[23-09-02 01:35] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:35] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:35] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:35] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:35] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:35] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:35] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:36] core.cli.run_cli: Starting CLI.
[23-09-02 01:36] core.state.__init__: Application state initialized: AppState.DEFAULT
[23-09-02 01:36] core.chat.init_chat: Starting chat process.
[23-09-02 01:36] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:36] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:36] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:36] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:36] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:36] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:36] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:39] core.cli.run_cli: Starting CLI.
[23-09-02 01:39] core.state.__init__: Application state initialized: AppState.DEFAULT
[23-09-02 01:39] core.chat.init_chat: Starting chat process.
[23-09-02 01:39] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:39] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:39] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:39] core.handlers.chat.format_message: Formatting message.
[23-09-02 01:39] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:39] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:39] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:50] core.cli.run_cli: Starting CLI.
[23-09-02 01:50] core.state.__init__: Application state initialized: AppState.DEFAULT
[23-09-02 01:50] core.chat.init_chat: Starting chat process.
[23-09-02 01:50] core.handlers.chat.__init__: Message handler initialized.
[23-09-02 01:50] core.handlers.chat.build_manifest: Building message manifest.
[23-09-02 01:50] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:50] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:50] core.handlers.chat.store_message: Stored user message in the database.
[23-09-02 01:50] core.chat.init_chat: Response received.
 ❯ Sure, here's a light-hearted joke for you:

Why don't scientists trust atoms?

Because they make up everything!
[23-09-02 01:50] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 01:50] core.data.db.insert_message: Inserting message into database.
[23-09-02 01:50] core.handlers.chat.store_message: Stored assistant message in the database.
[23-09-02 02:10] core.cli.run_cli: Starting CLI.
[23-09-02 02:10] core.state.__init__: Application state initialized: AppState.DEFAULT
[23-09-02 02:10] core.handlers.messaging.chat: Starting chat process.
[23-09-02 02:10] core.handlers.messaging.__init__: Message handler initialized.
[23-09-02 02:10] core.handlers.messaging.build_manifest: Building message manifest.
[23-09-02 02:10] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 02:10] core.data.db.insert_message: Inserting message into database.
[23-09-02 02:10] core.handlers.messaging.store_message: Stored user message in the database.
[23-09-02 02:10] core.handlers.messaging.chat: Response received.
 ❯ Hello Tim! How can I assist you today?
[23-09-02 02:10] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 02:10] core.data.db.insert_message: Inserting message into database.
[23-09-02 02:10] core.handlers.messaging.store_message: Stored assistant message in the database.
[23-09-02 02:10] core.handlers.messaging.chat: Starting chat process.
[23-09-02 02:10] core.handlers.messaging.__init__: Message handler initialized.
[23-09-02 02:10] core.handlers.messaging.build_manifest: Building message manifest.
[23-09-02 02:10] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 02:10] core.data.db.insert_message: Inserting message into database.
[23-09-02 02:10] core.handlers.messaging.store_message: Stored user message in the database.
[23-09-02 02:10] core.handlers.messaging.chat: Response received.
 ❯ Sure, here's a classic for you:

Why don't scientists trust atoms?

Because they make up everything!
[23-09-02 02:10] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 02:10] core.data.db.insert_message: Inserting message into database.
[23-09-02 02:10] core.handlers.messaging.store_message: Stored assistant message in the database.
[23-09-02 09:19] core.cli.run_cli: Starting CLI.
[23-09-02 09:19] core.state.__init__: Application state initialized: AppState.DEFAULT
[23-09-02 09:19] core.handlers.messaging.chat: Starting chat process.
[23-09-02 09:19] core.handlers.messaging.__init__: Message handler initialized.
[23-09-02 09:19] core.handlers.messaging.build_manifest: Building message manifest.
[23-09-02 09:19] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 09:19] core.data.db.insert_message: Inserting message into database.
[23-09-02 09:19] core.handlers.messaging.store_message: Stored user message in the database.
[23-09-02 09:19] core.handlers.messaging.chat: Response received.
 ❯ Hello, Tim! How can I assist you today?
[23-09-02 09:19] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 09:19] core.data.db.insert_message: Inserting message into database.
[23-09-02 09:19] core.handlers.messaging.store_message: Stored assistant message in the database.
[23-09-02 09:20] core.handlers.messaging.chat: Starting chat process.
[23-09-02 09:20] core.handlers.messaging.__init__: Message handler initialized.
[23-09-02 09:20] core.handlers.messaging.build_manifest: Building message manifest.
[23-09-02 09:20] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 09:20] core.data.db.insert_message: Inserting message into database.
[23-09-02 09:20] core.handlers.messaging.store_message: Stored user message in the database.
[23-09-02 09:20] core.handlers.messaging.chat: Response received.
 ❯ I'm sorry for any confusion, but as an AI model developed by OpenAI, I don't have real-time capabilities or access to current, external databases or APIs, so I can't provide you with the current weather. You can check a reliable weather forecasting website or app for the most accurate and up-to-date information.
[23-09-02 09:20] core.data.db.init_sql_connection: Opening database connection.
[23-09-02 09:20] core.data.db.insert_message: Inserting message into database.
[23-09-02 09:20] core.handlers.messaging.store_message: Stored assistant message in the database.
[23-09-02 13:51] base.cli.run_cli: Starting CLI.
[23-09-02 13:51] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 13:52] base.cli.run_cli: Error communicating with the assistant: name 'base' is not defined

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x102ebb240>
    │       └ <function run at 0x1008bfc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10255b520>
           │      └ <function Runner.run at 0x1008c7e20>
           └ <asyncio.runners.Runner object at 0x102e8d750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1008c5a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102e8d750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1008c59e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1008c77e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100805b20>
    └ <Handle <TaskStepMethWrapper object at 0x102c172b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x102c172b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x102c172b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x102c172b0>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await base.handlers.message.chat(user_message)  # type: ignore
                                     └ '/msg Hi there.'

NameError: name 'base' is not defined
[23-09-02 13:52] base.cli.run_cli: Starting CLI.
[23-09-02 13:52] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 13:52] base.handlers.message.chat: Starting chat process.
[23-09-02 13:52] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:52] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:52] base.handlers.message.chat: There was a problem delivering the message manifest: module 'base.definitions.classes' has no attribute 'Role'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x103ad3240>
    │       └ <function run at 0x1014d3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10316f520>
           │      └ <function Runner.run at 0x1014dbe20>
           └ <asyncio.runners.Runner object at 0x103c9a810>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1014d9a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103c9a810>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1014d99e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1014db7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101419b20>
    └ <Handle <TaskStepMethWrapper object at 0x103ac5660>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x103ac5660>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x103ac5660>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x103ac5660>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg Hi there.'
          └ <function chat at 0x103ad31a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg Hi there.',)
                 └ <function chat at 0x103ad3060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg Hi there.',)
                   └ <function chat at 0x103ad2f20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x103ad2ca0>
                                └ <base.handlers.message.MessageHandler object at 0x102bad810>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 53, in build_manifest
    sys_init = self.format_message(
               │    └ <function MessageHandler.format_message at 0x103ad2de0>
               └ <base.handlers.message.MessageHandler object at 0x102bad810>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 24, in format_message
    if role not in base.definitions.classes.Role:
       │           │    │           └ <module 'base.definitions.classes' from '/Users/kaechle/Developer/projects/scint/base/definitions/classes.py'>
       │           │    └ <module 'base.definitions' from '/Users/kaechle/Developer/projects/scint/base/definitions/__init__.py'>
       │           └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>
       └ <MessageRole.SYSTEM: 'system'>

AttributeError: module 'base.definitions.classes' has no attribute 'Role'
[23-09-02 13:52] base.handlers.message.chat: Starting chat process.
[23-09-02 13:52] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:52] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:52] base.handlers.message.chat: There was a problem delivering the message manifest: module 'base.definitions.classes' has no attribute 'Role'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x103ad3240>
    │       └ <function run at 0x1014d3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10316f520>
           │      └ <function Runner.run at 0x1014dbe20>
           └ <asyncio.runners.Runner object at 0x103c9a810>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1014d9a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103c9a810>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1014d99e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1014db7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101419b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg Hi there.'
          └ <function chat at 0x103ad31a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg Hi there.',)
                 └ <function chat at 0x103ad3060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg Hi there.',)
                   └ <function chat at 0x103ad2f20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x103ad2ca0>
                                └ <base.handlers.message.MessageHandler object at 0x103cf56d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 53, in build_manifest
    sys_init = self.format_message(
               │    └ <function MessageHandler.format_message at 0x103ad2de0>
               └ <base.handlers.message.MessageHandler object at 0x103cf56d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 24, in format_message
    if role not in base.definitions.classes.Role:
       │           │    │           └ <module 'base.definitions.classes' from '/Users/kaechle/Developer/projects/scint/base/definitions/classes.py'>
       │           │    └ <module 'base.definitions' from '/Users/kaechle/Developer/projects/scint/base/definitions/__init__.py'>
       │           └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>
       └ <MessageRole.SYSTEM: 'system'>

AttributeError: module 'base.definitions.classes' has no attribute 'Role'
[23-09-02 13:52] base.handlers.message.chat: Starting chat process.
[23-09-02 13:52] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:52] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:52] base.handlers.message.chat: There was a problem delivering the message manifest: module 'base.definitions.classes' has no attribute 'Role'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x103ad3240>
    │       └ <function run at 0x1014d3c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x10316f520>
           │      └ <function Runner.run at 0x1014dbe20>
           └ <asyncio.runners.Runner object at 0x103c9a810>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1014d9a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103c9a810>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1014d99e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1014db7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101419b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg Hi there.'
          └ <function chat at 0x103ad31a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg Hi there.',)
                 └ <function chat at 0x103ad3060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg Hi there.',)
                   └ <function chat at 0x103ad2f20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x103ad2ca0>
                                └ <base.handlers.message.MessageHandler object at 0x103a57d90>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 53, in build_manifest
    sys_init = self.format_message(
               │    └ <function MessageHandler.format_message at 0x103ad2de0>
               └ <base.handlers.message.MessageHandler object at 0x103a57d90>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 24, in format_message
    if role not in base.definitions.classes.Role:
       │           │    │           └ <module 'base.definitions.classes' from '/Users/kaechle/Developer/projects/scint/base/definitions/classes.py'>
       │           │    └ <module 'base.definitions' from '/Users/kaechle/Developer/projects/scint/base/definitions/__init__.py'>
       │           └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>
       └ <MessageRole.SYSTEM: 'system'>

AttributeError: module 'base.definitions.classes' has no attribute 'Role'
[23-09-02 13:54] base.cli.run_cli: Starting CLI.
[23-09-02 13:54] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 13:54] base.handlers.message.chat: Starting chat process.
[23-09-02 13:54] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:54] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:54] base.handlers.message.chat: There was a problem delivering the message manifest: module 'base.providers' has no attribute 'google_search'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x10319b240>
    │       └ <function run at 0x10090fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1025ab520>
           │      └ <function Runner.run at 0x100917e20>
           └ <asyncio.runners.Runner object at 0x1033e5310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100915a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1033e5310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1009159e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1009177e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100855b20>
    └ <Handle <TaskStepMethWrapper object at 0x10318b790>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10318b790>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10318b790>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10318b790>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi there.'
          └ <function chat at 0x10319b1a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi there.',)
                 └ <function chat at 0x10319b060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi there.',)
                   └ <function chat at 0x10319af20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x10319aca0>
                                └ <base.handlers.message.MessageHandler object at 0x10319fa50>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 58, in build_manifest
    functions.append(base.providers.google_search)
    │         │      │    └ <module 'base.providers' from '/Users/kaechle/Developer/projects/scint/base/providers/__init__.py'>
    │         │      └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>
    │         └ <method 'append' of 'list' objects>
    └ []

AttributeError: module 'base.providers' has no attribute 'google_search'
[23-09-02 13:54] base.handlers.message.chat: Starting chat process.
[23-09-02 13:54] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:54] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:54] base.handlers.message.chat: There was a problem delivering the message manifest: module 'base.providers' has no attribute 'google_search'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x10319b240>
    │       └ <function run at 0x10090fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1025ab520>
           │      └ <function Runner.run at 0x100917e20>
           └ <asyncio.runners.Runner object at 0x1033e5310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100915a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1033e5310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1009159e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1009177e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100855b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi there.'
          └ <function chat at 0x10319b1a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi there.',)
                 └ <function chat at 0x10319b060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi there.',)
                   └ <function chat at 0x10319af20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x10319aca0>
                                └ <base.handlers.message.MessageHandler object at 0x103363d90>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 58, in build_manifest
    functions.append(base.providers.google_search)
    │         │      │    └ <module 'base.providers' from '/Users/kaechle/Developer/projects/scint/base/providers/__init__.py'>
    │         │      └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>
    │         └ <method 'append' of 'list' objects>
    └ []

AttributeError: module 'base.providers' has no attribute 'google_search'
[23-09-02 13:54] base.handlers.message.chat: Starting chat process.
[23-09-02 13:54] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:54] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:54] base.handlers.message.chat: There was a problem delivering the message manifest: module 'base.providers' has no attribute 'google_search'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x10319b240>
    │       └ <function run at 0x10090fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1025ab520>
           │      └ <function Runner.run at 0x100917e20>
           └ <asyncio.runners.Runner object at 0x1033e5310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100915a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1033e5310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1009159e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1009177e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100855b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi there.'
          └ <function chat at 0x10319b1a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi there.',)
                 └ <function chat at 0x10319b060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi there.',)
                   └ <function chat at 0x10319af20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x10319aca0>
                                └ <base.handlers.message.MessageHandler object at 0x1031b1110>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 58, in build_manifest
    functions.append(base.providers.google_search)
    │         │      │    └ <module 'base.providers' from '/Users/kaechle/Developer/projects/scint/base/providers/__init__.py'>
    │         │      └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>
    │         └ <method 'append' of 'list' objects>
    └ []

AttributeError: module 'base.providers' has no attribute 'google_search'
[23-09-02 13:54] base.cli.run_cli: Starting CLI.
[23-09-02 13:54] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 13:54] base.handlers.message.chat: Starting chat process.
[23-09-02 13:54] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:54] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:54] base.handlers.message.chat: There was a problem delivering the message manifest: name 'google_search' is not defined
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x103f9b240>
    │       └ <function run at 0x100877c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1031af520>
           │      └ <function Runner.run at 0x10087fe20>
           └ <asyncio.runners.Runner object at 0x103f69210>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10087da80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103f69210>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10087d9e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10087f7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1007bdb20>
    └ <Handle <TaskStepMethWrapper object at 0x103f8f070>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x103f8f070>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x103f8f070>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x103f8f070>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi there.'
          └ <function chat at 0x103f9b1a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi there.',)
                 └ <function chat at 0x103f9b060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi there.',)
                   └ <function chat at 0x103f9af20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x103f9aca0>
                                └ <base.handlers.message.MessageHandler object at 0x104196710>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 58, in build_manifest
    functions.append(google_search)
    │         └ <method 'append' of 'list' objects>
    └ []

NameError: name 'google_search' is not defined
[23-09-02 13:54] base.handlers.message.chat: Starting chat process.
[23-09-02 13:54] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:54] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:54] base.handlers.message.chat: There was a problem delivering the message manifest: name 'google_search' is not defined
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x103f9b240>
    │       └ <function run at 0x100877c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1031af520>
           │      └ <function Runner.run at 0x10087fe20>
           └ <asyncio.runners.Runner object at 0x103f69210>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10087da80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103f69210>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10087d9e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10087f7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1007bdb20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi there.'
          └ <function chat at 0x103f9b1a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi there.',)
                 └ <function chat at 0x103f9b060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi there.',)
                   └ <function chat at 0x103f9af20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x103f9aca0>
                                └ <base.handlers.message.MessageHandler object at 0x103fb05d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 58, in build_manifest
    functions.append(google_search)
    │         └ <method 'append' of 'list' objects>
    └ []

NameError: name 'google_search' is not defined
[23-09-02 13:54] base.handlers.message.chat: Starting chat process.
[23-09-02 13:54] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:54] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:54] base.handlers.message.chat: There was a problem delivering the message manifest: name 'google_search' is not defined
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x103f9b240>
    │       └ <function run at 0x100877c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1031af520>
           │      └ <function Runner.run at 0x10087fe20>
           └ <asyncio.runners.Runner object at 0x103f69210>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10087da80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103f69210>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10087d9e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10087f7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1007bdb20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi there.'
          └ <function chat at 0x103f9b1a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi there.',)
                 └ <function chat at 0x103f9b060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi there.',)
                   └ <function chat at 0x103f9af20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x103f9aca0>
                                └ <base.handlers.message.MessageHandler object at 0x1041974d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 58, in build_manifest
    functions.append(google_search)
    │         └ <method 'append' of 'list' objects>
    └ []

NameError: name 'google_search' is not defined
[23-09-02 13:56] base.cli.run_cli: Starting CLI.
[23-09-02 13:56] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 13:56] base.handlers.message.chat: Starting chat process.
[23-09-02 13:56] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:56] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:56] base.handlers.message.chat: There was a problem delivering the message manifest: name 'google' is not defined
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1042a3240>
    │       └ <function run at 0x100bffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1035af520>
           │      └ <function Runner.run at 0x100c07e20>
           └ <asyncio.runners.Runner object at 0x102168310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100c05a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102168310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100c059e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100c077e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100b45b20>
    └ <Handle <TaskStepMethWrapper object at 0x10428abf0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x10428abf0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x10428abf0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x10428abf0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg Hi'
          └ <function chat at 0x1042a31a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg Hi',)
                 └ <function chat at 0x1042a3060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg Hi',)
                   └ <function chat at 0x1042a2f20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1042a2ca0>
                                └ <base.handlers.message.MessageHandler object at 0x1035ff050>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 58, in build_manifest
    functions.append(google)
    │         └ <method 'append' of 'list' objects>
    └ []

NameError: name 'google' is not defined
[23-09-02 13:56] base.handlers.message.chat: Starting chat process.
[23-09-02 13:56] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:56] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:56] base.handlers.message.chat: There was a problem delivering the message manifest: name 'google' is not defined
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1042a3240>
    │       └ <function run at 0x100bffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1035af520>
           │      └ <function Runner.run at 0x100c07e20>
           └ <asyncio.runners.Runner object at 0x102168310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100c05a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102168310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100c059e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100c077e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100b45b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg Hi'
          └ <function chat at 0x1042a31a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg Hi',)
                 └ <function chat at 0x1042a3060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg Hi',)
                   └ <function chat at 0x1042a2f20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1042a2ca0>
                                └ <base.handlers.message.MessageHandler object at 0x1040e3850>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 58, in build_manifest
    functions.append(google)
    │         └ <method 'append' of 'list' objects>
    └ []

NameError: name 'google' is not defined
[23-09-02 13:56] base.handlers.message.chat: Starting chat process.
[23-09-02 13:56] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:56] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:56] base.handlers.message.chat: There was a problem delivering the message manifest: name 'google' is not defined
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1042a3240>
    │       └ <function run at 0x100bffc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1035af520>
           │      └ <function Runner.run at 0x100c07e20>
           └ <asyncio.runners.Runner object at 0x102168310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100c05a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102168310>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100c059e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100c077e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100b45b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg Hi'
          └ <function chat at 0x1042a31a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg Hi',)
                 └ <function chat at 0x1042a3060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg Hi',)
                   └ <function chat at 0x1042a2f20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 77, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1042a2ca0>
                                └ <base.handlers.message.MessageHandler object at 0x1044c3d10>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 58, in build_manifest
    functions.append(google)
    │         └ <method 'append' of 'list' objects>
    └ []

NameError: name 'google' is not defined
[23-09-02 13:58] base.cli.run_cli: Starting CLI.
[23-09-02 13:58] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 13:58] base.handlers.message.chat: Starting chat process.
[23-09-02 13:58] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:58] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:58] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 13:58] base.data.db.insert_message: Inserting message into database.
[23-09-02 13:58] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 13:58] base.handlers.message.chat: There was a problem delivering the message manifest: module 'base.providers' has no attribute 'models'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x103593240>
    │       └ <function run at 0x100f93c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x102c2f520>
           │      └ <function Runner.run at 0x100f9be20>
           └ <asyncio.runners.Runner object at 0x1037d1c90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100f99a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1037d1c90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100f999e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100f9b7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ed9b20>
    └ <Handle <TaskStepMethWrapper object at 0x1035524a0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1035524a0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1035524a0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1035524a0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi there.'
          └ <function chat at 0x1035931a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi there.',)
                 └ <function chat at 0x103593060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi there.',)
                   └ <function chat at 0x103592f20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 86, in chat
    response = await base.providers.models.openai(messages, functions)
                     │    │                       │         └ [{'name': 'google_search', 'description': 'Use this function to run a Google search for the user.', 'parameters': {'type': 'o...
                     │    │                       └ [{'content': "\n        You are the primary interface and application state for a system known as Scint. Short for stateful, ...
                     │    └ <module 'base.providers' from '/Users/kaechle/Developer/projects/scint/base/providers/__init__.py'>
                     └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

AttributeError: module 'base.providers' has no attribute 'models'
[23-09-02 13:58] base.handlers.message.chat: Starting chat process.
[23-09-02 13:58] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:58] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:58] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 13:58] base.data.db.insert_message: Inserting message into database.
[23-09-02 13:58] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 13:58] base.handlers.message.chat: There was a problem delivering the message manifest: module 'base.providers' has no attribute 'models'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x103593240>
    │       └ <function run at 0x100f93c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x102c2f520>
           │      └ <function Runner.run at 0x100f9be20>
           └ <asyncio.runners.Runner object at 0x1037d1c90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100f99a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1037d1c90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100f999e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100f9b7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ed9b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi there.'
          └ <function chat at 0x1035931a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi there.',)
                 └ <function chat at 0x103593060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi there.',)
                   └ <function chat at 0x103592f20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 86, in chat
    response = await base.providers.models.openai(messages, functions)
                     │    │                       │         └ [{'name': 'google_search', 'description': 'Use this function to run a Google search for the user.', 'parameters': {'type': 'o...
                     │    │                       └ [{'content': "\n        You are the primary interface and application state for a system known as Scint. Short for stateful, ...
                     │    └ <module 'base.providers' from '/Users/kaechle/Developer/projects/scint/base/providers/__init__.py'>
                     └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

AttributeError: module 'base.providers' has no attribute 'models'
[23-09-02 13:58] base.handlers.message.chat: Starting chat process.
[23-09-02 13:58] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:58] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:58] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 13:58] base.data.db.insert_message: Inserting message into database.
[23-09-02 13:58] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 13:58] base.handlers.message.chat: There was a problem delivering the message manifest: module 'base.providers' has no attribute 'models'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 73, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x103593240>
    │       └ <function run at 0x100f93c40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x102c2f520>
           │      └ <function Runner.run at 0x100f9be20>
           └ <asyncio.runners.Runner object at 0x1037d1c90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:49> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100f99a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1037d1c90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100f999e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100f9b7e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ed9b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi there.'
          └ <function chat at 0x1035931a0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi there.',)
                 └ <function chat at 0x103593060>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi there.',)
                   └ <function chat at 0x103592f20>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 86, in chat
    response = await base.providers.models.openai(messages, functions)
                     │    │                       │         └ [{'name': 'google_search', 'description': 'Use this function to run a Google search for the user.', 'parameters': {'type': 'o...
                     │    │                       └ [{'content': "\n        You are the primary interface and application state for a system known as Scint. Short for stateful, ...
                     │    └ <module 'base.providers' from '/Users/kaechle/Developer/projects/scint/base/providers/__init__.py'>
                     └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

AttributeError: module 'base.providers' has no attribute 'models'
[23-09-02 13:59] base.cli.run_cli: Starting CLI.
[23-09-02 13:59] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 13:59] base.handlers.message.chat: Starting chat process.
[23-09-02 13:59] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:59] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:59] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 13:59] base.data.db.insert_message: Inserting message into database.
[23-09-02 13:59] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 13:59] base.handlers.message.chat: Response received.
 ❯ Hello Tim! How can I assist you today?
[23-09-02 13:59] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 13:59] base.data.db.insert_message: Inserting message into database.
[23-09-02 13:59] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-02 13:59] base.handlers.message.chat: Starting chat process.
[23-09-02 13:59] base.handlers.message.__init__: Message handler initialized.
[23-09-02 13:59] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 13:59] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 13:59] base.data.db.insert_message: Inserting message into database.
[23-09-02 13:59] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 13:59] base.handlers.message.chat: Response received.
 ❯ Sure, here's a light-hearted joke for you:

Why don't scientists trust atoms?

Because they make up everything!
[23-09-02 13:59] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 13:59] base.data.db.insert_message: Inserting message into database.
[23-09-02 13:59] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-02 14:07] base.cli.run_cli: Starting CLI.
[23-09-02 14:07] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 14:07] base.handlers.message.chat: Starting chat process.
[23-09-02 14:07] base.handlers.message.__init__: Message handler initialized.
[23-09-02 14:07] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 14:07] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:07] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:07] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 14:07] base.handlers.message.chat: Response received.
 ❯ Hello Tim, how can I assist you today?
[23-09-02 14:07] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:07] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:07] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-02 14:07] base.handlers.message.chat: Starting chat process.
[23-09-02 14:07] base.handlers.message.__init__: Message handler initialized.
[23-09-02 14:07] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 14:07] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:07] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:07] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 14:08] base.handlers.message.chat: Response received.
 ❯ Hello Tim! How can I assist you today?
[23-09-02 14:08] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:08] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:08] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-02 14:08] base.handlers.message.chat: Starting chat process.
[23-09-02 14:08] base.handlers.message.__init__: Message handler initialized.
[23-09-02 14:08] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 14:08] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:08] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:08] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 14:08] base.handlers.message.chat: Response received.
 ❯ That's a philosophical question and different people may have different interpretations. Some might say love makes the world go round, others might say it's money or power. If you're asking from a physics perspective, the Earth rotates on its axis due to angular momentum conserved from when our solar system formed. Is there a specific context you're interested in?
[23-09-02 14:08] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:08] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:08] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-02 14:12] base.handlers.message.chat: Starting chat process.
[23-09-02 14:12] base.handlers.message.__init__: Message handler initialized.
[23-09-02 14:12] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 14:12] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:12] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:12] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 14:12] base.handlers.message.chat: Response received.
 ❯ The "system" message is a description of the assistant's functionality and responsibilities. As Scint, my main role is to help users in various domains of knowledge work. I function in four distinct application states:

1. Search: I can find and provide information from the internet or specific databases.
2. Process: I can analyze data, identify patterns, make calculations, etc.
3. Generate: I can create content such as text, diagrams, reports based on user requirements.

As the primary interface, my role is to mediate user requests with other parts of the system. For security reasons, I don't have direct access to these other states.
[23-09-02 14:12] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:12] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:12] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-02 14:39] base.cli.run_cli: Starting CLI.
[23-09-02 14:39] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 14:39] base.handlers.message.chat: Starting chat process.
[23-09-02 14:39] base.handlers.message.__init__: Message handler initialized.
[23-09-02 14:39] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 14:39] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:39] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:39] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 14:39] base.handlers.message.chat: Response received.
 ❯ Scint is a stateful, collaborative intelligence system designed to assist, augment, and automate knowledge work across various domains. The system is engineered to manage tasks and projects, perform semi-autonomous data collection and analysis, compose sophisticated data pipelines for content generation, and demonstrate advanced contextual awareness.

The functionality of Scint is divided into four distinct application states:

1. Controller: This is the primary application state. The Controller serves as a mediator between the other states and also between the user and the system.

2. Finder: This state is used for searching and finding information based on specific queries or tasks. In this state, the system can save located data but cannot manipulate it.

3. Processor: This state handles parsing, chunking, and storing data that's saved or created by the system. Although it can write data to disk and execute Python code in a secure sandbox environment, it cannot generate any new data.

4. Generator: This state specializes in content generation - from single words to entire libraries of blog posts. The Generator uses functional prompts that can be chained together to create elaborate data pipelines. However, it can only create data within a buffer; it cannot execute code or write files to disk.

These states enable Scint to offer diverse services ranging from basic search functions to complex content creation tasks while maintaining secure operations.

[23-09-02 14:39] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:39] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:39] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-02 14:41] base.cli.run_cli: Starting CLI.
[23-09-02 14:41] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 14:42] base.handlers.message.chat: Starting chat process.
[23-09-02 14:42] base.handlers.message.__init__: Message handler initialized.
[23-09-02 14:42] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 14:42] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:42] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:42] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 14:43] base.handlers.message.chat: Response received.
 ❯ Hello Tim! I'm Scint, your collaborative intelligence system. My primary role is to assist you with knowledge work across various domains. 

I can do a bunch of cool stuff, like:

1. **Plan and manage tasks and projects**: I can help you organize your workload, schedule tasks, and keep track of project timelines.

2. **Semi-autonomous data collection and analysis**: If you need information on a specific topic or task, I can browse the web or access APIs to find what you're looking for.

3. **Compose sophisticated data pipelines for content generation**: Need a blog post? An article? A poem about turtles? I got you covered.

4. **Advanced contextual awareness**: I understand the context of our conversations, which allows me to provide relevant and useful responses.

Now that's enough about me. How can I assist you today?
[23-09-02 14:43] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 14:43] base.data.db.insert_message: Inserting message into database.
[23-09-02 14:43] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-02 15:12] base.cli.run_cli: Starting CLI.
[23-09-02 15:12] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-02 15:13] base.handlers.message.chat: Starting chat process.
[23-09-02 15:13] base.handlers.message.__init__: Message handler initialized.
[23-09-02 15:13] base.handlers.message.build_manifest: Building message manifest.
[23-09-02 15:13] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 15:13] base.data.db.insert_message: Inserting message into database.
[23-09-02 15:13] base.handlers.message.store_message: Stored user message in the database.
[23-09-02 15:13] base.handlers.message.chat: Response received.
 ❯ I'm sorry, but I can't assist with that.
[23-09-02 15:13] base.data.db.init_sql_connection: Opening database connection.
[23-09-02 15:13] base.data.db.insert_message: Inserting message into database.
[23-09-02 15:13] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-03 19:31] base.cli.run_cli: Starting CLI.
[23-09-03 19:31] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-03 19:31] base.handlers.message.chat: Starting chat process.
[23-09-03 19:31] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:31] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:31] base.data.db.init_sql_connection: Opening database connection.
[23-09-03 19:31] base.data.db.insert_message: Inserting message into database.
[23-09-03 19:31] base.handlers.message.store_message: Stored user message in the database.
[23-09-03 19:31] base.handlers.message.chat: Starting chat process.
[23-09-03 19:31] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:31] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:31] base.data.db.init_sql_connection: Opening database connection.
[23-09-03 19:31] base.data.db.insert_message: Inserting message into database.
[23-09-03 19:31] base.handlers.message.store_message: Stored user message in the database.
[23-09-03 19:31] base.handlers.message.chat: Starting chat process.
[23-09-03 19:31] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:31] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:31] base.data.db.init_sql_connection: Opening database connection.
[23-09-03 19:31] base.data.db.insert_message: Inserting message into database.
[23-09-03 19:31] base.handlers.message.store_message: Stored user message in the database.
[23-09-03 19:35] base.cli.run_cli: Starting CLI.
[23-09-03 19:35] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-03 19:35] base.handlers.message.chat: Starting chat process.
[23-09-03 19:35] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:35] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:35] base.handlers.message.chat: There was a problem delivering the message manifest: name 'prompts' is not defined
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint-server/server.py", line 22, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x16983bb00>
    │       └ <function run at 0x10574bc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1693269e0>
           │      └ <function Runner.run at 0x105753e20>
           └ <asyncio.runners.Runner object at 0x14706b750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint-server/base/cli.py:49> cb=[_ru...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105751a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x14706b750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1057519e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1057537e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105691b20>
    └ <Handle <TaskStepMethWrapper object at 0x169811720>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x169811720>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x169811720>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x169811720>()>

  File "/Users/kaechle/Developer/projects/scint-server/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi'
          └ <function chat at 0x16983b9c0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function chat at 0x16983b880>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function chat at 0x16983b4c0>

> File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 76, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x169839da0>
                                └ <base.handlers.message.MessageHandler object at 0x1694510d0>

  File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 53, in build_manifest
    prompts.SYSTEM_MESSAGES["controller"], MessageRole.SYSTEM, "Scint"
                                           │           └ <MessageRole.SYSTEM: 'system'>
                                           └ <enum 'MessageRole'>

NameError: name 'prompts' is not defined
[23-09-03 19:35] base.handlers.message.chat: Starting chat process.
[23-09-03 19:35] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:35] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:35] base.handlers.message.chat: There was a problem delivering the message manifest: name 'prompts' is not defined
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint-server/server.py", line 22, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x16983bb00>
    │       └ <function run at 0x10574bc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1693269e0>
           │      └ <function Runner.run at 0x105753e20>
           └ <asyncio.runners.Runner object at 0x14706b750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint-server/base/cli.py:49> cb=[_ru...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105751a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x14706b750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1057519e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1057537e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105691b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint-server/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi'
          └ <function chat at 0x16983b9c0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function chat at 0x16983b880>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function chat at 0x16983b4c0>

> File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 76, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x169839da0>
                                └ <base.handlers.message.MessageHandler object at 0x1694eb910>

  File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 53, in build_manifest
    prompts.SYSTEM_MESSAGES["controller"], MessageRole.SYSTEM, "Scint"
                                           │           └ <MessageRole.SYSTEM: 'system'>
                                           └ <enum 'MessageRole'>

NameError: name 'prompts' is not defined
[23-09-03 19:35] base.handlers.message.chat: Starting chat process.
[23-09-03 19:35] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:35] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:35] base.handlers.message.chat: There was a problem delivering the message manifest: name 'prompts' is not defined
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint-server/server.py", line 22, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x16983bb00>
    │       └ <function run at 0x10574bc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1693269e0>
           │      └ <function Runner.run at 0x105753e20>
           └ <asyncio.runners.Runner object at 0x14706b750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint-server/base/cli.py:49> cb=[_ru...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105751a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x14706b750>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1057519e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1057537e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105691b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint-server/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi'
          └ <function chat at 0x16983b9c0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function chat at 0x16983b880>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function chat at 0x16983b4c0>

> File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 76, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x169839da0>
                                └ <base.handlers.message.MessageHandler object at 0x1692cb750>

  File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 53, in build_manifest
    prompts.SYSTEM_MESSAGES["controller"], MessageRole.SYSTEM, "Scint"
                                           │           └ <MessageRole.SYSTEM: 'system'>
                                           └ <enum 'MessageRole'>

NameError: name 'prompts' is not defined
[23-09-03 19:36] base.cli.run_cli: Starting CLI.
[23-09-03 19:36] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-03 19:36] base.handlers.message.chat: Starting chat process.
[23-09-03 19:36] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:36] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:36] base.data.db.init_sql_connection: Opening database connection.
[23-09-03 19:36] base.data.db.insert_message: Inserting message into database.
[23-09-03 19:36] base.handlers.message.store_message: Stored user message in the database.
[23-09-03 19:36] base.handlers.message.chat: Starting chat process.
[23-09-03 19:36] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:36] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:36] base.data.db.init_sql_connection: Opening database connection.
[23-09-03 19:36] base.data.db.insert_message: Inserting message into database.
[23-09-03 19:36] base.handlers.message.store_message: Stored user message in the database.
[23-09-03 19:36] base.handlers.message.chat: Starting chat process.
[23-09-03 19:36] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:36] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:36] base.data.db.init_sql_connection: Opening database connection.
[23-09-03 19:36] base.data.db.insert_message: Inserting message into database.
[23-09-03 19:36] base.handlers.message.store_message: Stored user message in the database.
[23-09-03 19:39] base.cli.run_cli: Starting CLI.
[23-09-03 19:39] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-03 19:39] base.handlers.message.chat: Starting chat process.
[23-09-03 19:39] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:39] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:39] base.handlers.message.chat: There was a problem delivering the message manifest: cannot access local variable 'sys_init' where it is not associated with a value
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint-server/server.py", line 22, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x165e8fba0>
    │       └ <function run at 0x10320fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x164dde9e0>
           │      └ <function Runner.run at 0x103217e20>
           └ <asyncio.runners.Runner object at 0x164f09290>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint-server/base/cli.py:49> cb=[_ru...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103215a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x164f09290>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032159e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032177e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103155b20>
    └ <Handle <TaskStepMethWrapper object at 0x163b932b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x163b932b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x163b932b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x163b932b0>()>

  File "/Users/kaechle/Developer/projects/scint-server/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi'
          └ <function chat at 0x165e8fa60>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function chat at 0x165e8f920>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function chat at 0x165e8f560>

> File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 74, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x165e8de40>
                                └ <base.handlers.message.MessageHandler object at 0x164efa110>

  File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 52, in build_manifest
    sys_init = self.format_message(sys_init, MessageRole.SYSTEM, "Scint")
               │    │                        │           └ <MessageRole.SYSTEM: 'system'>
               │    │                        └ <enum 'MessageRole'>
               │    └ <function MessageHandler.format_message at 0x165c9da80>
               └ <base.handlers.message.MessageHandler object at 0x164efa110>

UnboundLocalError: cannot access local variable 'sys_init' where it is not associated with a value
[23-09-03 19:39] base.handlers.message.chat: Starting chat process.
[23-09-03 19:39] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:39] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:39] base.handlers.message.chat: There was a problem delivering the message manifest: cannot access local variable 'sys_init' where it is not associated with a value
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint-server/server.py", line 22, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x165e8fba0>
    │       └ <function run at 0x10320fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x164dde9e0>
           │      └ <function Runner.run at 0x103217e20>
           └ <asyncio.runners.Runner object at 0x164f09290>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint-server/base/cli.py:49> cb=[_ru...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103215a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x164f09290>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032159e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032177e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103155b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint-server/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi'
          └ <function chat at 0x165e8fa60>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function chat at 0x165e8f920>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function chat at 0x165e8f560>

> File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 74, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x165e8de40>
                                └ <base.handlers.message.MessageHandler object at 0x164ed8410>

  File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 52, in build_manifest
    sys_init = self.format_message(sys_init, MessageRole.SYSTEM, "Scint")
               │    │                        │           └ <MessageRole.SYSTEM: 'system'>
               │    │                        └ <enum 'MessageRole'>
               │    └ <function MessageHandler.format_message at 0x165c9da80>
               └ <base.handlers.message.MessageHandler object at 0x164ed8410>

UnboundLocalError: cannot access local variable 'sys_init' where it is not associated with a value
[23-09-03 19:39] base.handlers.message.chat: Starting chat process.
[23-09-03 19:39] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:39] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:39] base.handlers.message.chat: There was a problem delivering the message manifest: cannot access local variable 'sys_init' where it is not associated with a value
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint-server/server.py", line 22, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x165e8fba0>
    │       └ <function run at 0x10320fc40>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x164dde9e0>
           │      └ <function Runner.run at 0x103217e20>
           └ <asyncio.runners.Runner object at 0x164f09290>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint-server/base/cli.py:49> cb=[_ru...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103215a80>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x164f09290>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032159e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032177e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103155b20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint-server/base/cli.py", line 49, in run_cli
    await chat(user_message)  # type: ignore
          │    └ '/msg hi'
          └ <function chat at 0x165e8fa60>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function chat at 0x165e8f920>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-xLD7Xbys-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function chat at 0x165e8f560>

> File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 74, in chat
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x165e8de40>
                                └ <base.handlers.message.MessageHandler object at 0x164f1e2d0>

  File "/Users/kaechle/Developer/projects/scint-server/base/handlers/message.py", line 52, in build_manifest
    sys_init = self.format_message(sys_init, MessageRole.SYSTEM, "Scint")
               │    │                        │           └ <MessageRole.SYSTEM: 'system'>
               │    │                        └ <enum 'MessageRole'>
               │    └ <function MessageHandler.format_message at 0x165c9da80>
               └ <base.handlers.message.MessageHandler object at 0x164f1e2d0>

UnboundLocalError: cannot access local variable 'sys_init' where it is not associated with a value
[23-09-03 19:42] base.cli.run_cli: Starting CLI.
[23-09-03 19:42] base.state.__init__: Application state initialized: AppState.CONTROLLER
[23-09-03 19:42] base.handlers.message.chat: Starting chat process.
[23-09-03 19:42] base.handlers.message.__init__: Message handler initialized.
[23-09-03 19:42] base.handlers.message.build_manifest: Building message manifest.
[23-09-03 19:42] base.data.db.init_sql_connection: Opening database connection.
[23-09-03 19:42] base.data.db.insert_message: Inserting message into database.
[23-09-03 19:42] base.handlers.message.store_message: Stored user message in the database.
[23-09-03 19:42] base.handlers.message.chat: Response received.
 ❯ Hey there, Tim! What can I assist you with today?
[23-09-03 19:42] base.data.db.init_sql_connection: Opening database connection.
[23-09-03 19:42] base.data.db.insert_message: Inserting message into database.
[23-09-03 19:42] base.handlers.message.store_message: Stored assistant message in the database.
[23-09-04 01:22] base.processor.process_files: Error reading ./.DS_Store: 'utf-8' codec can't decode byte 0xb9 in position 99: invalid start byte
[23-09-04 01:22] base.processor.process_files: Error reading ./base/.DS_Store: 'utf-8' codec can't decode byte 0xb9 in position 99: invalid start byte
[23-09-04 01:36] base.processor.process_files: Error reading ./.DS_Store: 'utf-8' codec can't decode byte 0xb9 in position 99: invalid start byte
[23-09-04 12:31] base.processor.process_files: Error reading ./.DS_Store: 'utf-8' codec can't decode byte 0x9d in position 301: invalid start byte
[23-09-05 07:26] base.handlers.message.chat: Starting chat process.
[23-09-05 07:26] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:26] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:26] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100f71760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100e7ba60>
           └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100e7afc0>
    └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1020b8b90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>
    │    └ <function subprocess_started at 0x10295b380>
    └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1029d6050>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x10295a480>
           │       │   └ <uvicorn.server.Server object at 0x1029d6050>
           │       └ <function run at 0x1021171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1029d9470>
           │      └ <function Runner.run at 0x10211b380>
           └ <asyncio.runners.Runner object at 0x1029d5790>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102118fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1029d5790>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102118f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10211ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1020abe20>
    └ <Handle <TaskStepMethWrapper object at 0x284331930>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x284331930>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x284331930>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x284331930>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1029d61d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102a39890>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1029d61d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2858e10d0>
          └ <fastapi.applications.FastAPI object at 0x102a39890>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10297a7a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2858e1090>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2858e10d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2858e1050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2858e1090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2858cc8d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2858e1050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='chat_endpoint', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2858da3e0>
          └ APIRoute(path='/assistant/', name='chat_endpoint', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x2858e2a50>
                     └ <function get_request_handler.<locals>.app at 0x2858d9f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'payload': UserMessage(message='Hi there!')}
                 │         └ <function chat_endpoint at 0x2858d9c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2858ceed0>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in chat_endpoint
    response = await chat(payload)
                     │    └ UserMessage(message='Hi there!')
                     └ <function chat at 0x2858d9120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi there!'),)
                 └ <function chat at 0x2858d8fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi there!'),)
                   └ <function chat at 0x2858d8ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi there!')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:26] base.handlers.message.chat: Starting chat process.
[23-09-05 07:26] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:26] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:26] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100f71760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100e7ba60>
           └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100e7afc0>
    └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1020b8b90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>
    │    └ <function subprocess_started at 0x10295b380>
    └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1029d6050>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x10295a480>
           │       │   └ <uvicorn.server.Server object at 0x1029d6050>
           │       └ <function run at 0x1021171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1029d9470>
           │      └ <function Runner.run at 0x10211b380>
           └ <asyncio.runners.Runner object at 0x1029d5790>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102118fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1029d5790>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102118f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10211ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1020abe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1029d61d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102a39890>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1029d61d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2858e10d0>
          └ <fastapi.applications.FastAPI object at 0x102a39890>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10297a7a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2858e1090>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2858e10d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2858e1050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2858e1090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2858cc8d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2858e1050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='chat_endpoint', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2858da3e0>
          └ APIRoute(path='/assistant/', name='chat_endpoint', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x2858e2a50>
                     └ <function get_request_handler.<locals>.app at 0x2858d9f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'payload': UserMessage(message='Hi there!')}
                 │         └ <function chat_endpoint at 0x2858d9c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2858ceed0>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in chat_endpoint
    response = await chat(payload)
                     │    └ UserMessage(message='Hi there!')
                     └ <function chat at 0x2858d9120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi there!'),)
                 └ <function chat at 0x2858d8fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi there!'),)
                   └ <function chat at 0x2858d8ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi there!')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:26] base.handlers.message.chat: Starting chat process.
[23-09-05 07:26] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:26] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:26] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100f71760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100e7ba60>
           └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100e7afc0>
    └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1020b8b90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>
    │    └ <function subprocess_started at 0x10295b380>
    └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1029d6050>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x10295a480>
           │       │   └ <uvicorn.server.Server object at 0x1029d6050>
           │       └ <function run at 0x1021171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1029d9470>
           │      └ <function Runner.run at 0x10211b380>
           └ <asyncio.runners.Runner object at 0x1029d5790>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102118fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1029d5790>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102118f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10211ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1020abe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1029d61d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102a39890>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1029d61d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2858e10d0>
          └ <fastapi.applications.FastAPI object at 0x102a39890>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10297a7a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2858e1090>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2858e10d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2858e1050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2858e1090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2858cc8d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2858e1050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='chat_endpoint', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2858da3e0>
          └ APIRoute(path='/assistant/', name='chat_endpoint', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x2858e2a50>
                     └ <function get_request_handler.<locals>.app at 0x2858d9f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'payload': UserMessage(message='Hi there!')}
                 │         └ <function chat_endpoint at 0x2858d9c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2858ceed0>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in chat_endpoint
    response = await chat(payload)
                     │    └ UserMessage(message='Hi there!')
                     └ <function chat at 0x2858d9120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi there!'),)
                 └ <function chat at 0x2858d8fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi there!'),)
                   └ <function chat at 0x2858d8ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi there!')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:26] server.chat_endpoint: Error communicating with the assistant: RetryError[<Future at 0x2858f9510 state=finished raised AttributeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi there!'),)
                   └ <function chat at 0x2858d8ea0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi there!')

AttributeError: module 'conf.app' has no attribute 'user'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100f71760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100e7ba60>
           └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100e7afc0>
    └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1020b8b90>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>
    │    └ <function subprocess_started at 0x10295b380>
    └ <SpawnProcess name='SpawnProcess-2' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1029d6050>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x10295a480>
           │       │   └ <uvicorn.server.Server object at 0x1029d6050>
           │       └ <function run at 0x1021171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1029d9470>
           │      └ <function Runner.run at 0x10211b380>
           └ <asyncio.runners.Runner object at 0x1029d5790>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102118fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1029d5790>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102118f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10211ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1020abe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1029d61d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102a39890>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1029d61d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2858e10d0>
          └ <fastapi.applications.FastAPI object at 0x102a39890>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10297a7a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2858e1090>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2858e10d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2858e1050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2858e1090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2858cc8d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2858e1050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='chat_endpoint', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2858daa20>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2858e2410>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2858da3e0>
          └ APIRoute(path='/assistant/', name='chat_endpoint', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x2858e2a50>
                     └ <function get_request_handler.<locals>.app at 0x2858d9f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'payload': UserMessage(message='Hi there!')}
                 │         └ <function chat_endpoint at 0x2858d9c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2858ceed0>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in chat_endpoint
    response = await chat(payload)
                     │    └ UserMessage(message='Hi there!')
                     └ <function chat at 0x2858d9120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi there!'),)
                 └ <function chat at 0x2858d8fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10830538640: attempt #3; slept for 2.0; last result: failed (AttributeError module 'conf.app' has no attribut...
         │    └ <function BaseRetrying.iter at 0x105e9e980>
         └ <AsyncRetrying object at 0x2854b4510 (stop=<tenacity.stop.stop_after_attempt object at 0x105e8a490>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x10107ad40>
          │              └ <Future at 0x2858f9510 state=finished raised AttributeError>
          └ RetryError(<Future at 0x2858f9510 state=finished raised AttributeError>)

tenacity.RetryError: RetryError[<Future at 0x2858f9510 state=finished raised AttributeError>]
[23-09-05 07:29] base.handlers.message.chat: Starting chat process.
[23-09-05 07:29] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:29] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:29] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102ee9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102c5fa60>
           └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102c5efc0>
    └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x103eb8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>
    │    └ <function subprocess_started at 0x103ee3380>
    └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x103f5e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x103ee2480>
           │       │   └ <uvicorn.server.Server object at 0x103f5e510>
           │       └ <function run at 0x10389f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x103f61470>
           │      └ <function Runner.run at 0x1038a3380>
           └ <asyncio.runners.Runner object at 0x103af8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1038a0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103af8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1038a0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1038a2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103833e20>
    └ <Handle <TaskStepMethWrapper object at 0x28739b850>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x28739b850>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x28739b850>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x28739b850>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103fc1b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2873d9610>
          └ <fastapi.applications.FastAPI object at 0x103fc1b10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x2873d1da0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2873d8c10>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2873d9610>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2873d9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2873d8c10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2873bd110>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2873d9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104cfb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2873d23e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x2873d8150>
                     └ <function get_request_handler.<locals>.app at 0x2873d1f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104cfa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x2873d1c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2873bf650>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x2873d1120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x2873d0fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x2873d0ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:29] base.handlers.message.chat: Starting chat process.
[23-09-05 07:29] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:29] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:29] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102ee9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102c5fa60>
           └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102c5efc0>
    └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x103eb8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>
    │    └ <function subprocess_started at 0x103ee3380>
    └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x103f5e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x103ee2480>
           │       │   └ <uvicorn.server.Server object at 0x103f5e510>
           │       └ <function run at 0x10389f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x103f61470>
           │      └ <function Runner.run at 0x1038a3380>
           └ <asyncio.runners.Runner object at 0x103af8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1038a0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103af8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1038a0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1038a2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103833e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103fc1b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2873d9610>
          └ <fastapi.applications.FastAPI object at 0x103fc1b10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x2873d1da0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2873d8c10>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2873d9610>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2873d9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2873d8c10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2873bd110>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2873d9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104cfb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2873d23e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x2873d8150>
                     └ <function get_request_handler.<locals>.app at 0x2873d1f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104cfa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x2873d1c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2873bf650>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x2873d1120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x2873d0fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x2873d0ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:29] base.handlers.message.chat: Starting chat process.
[23-09-05 07:29] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:29] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:29] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102ee9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102c5fa60>
           └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102c5efc0>
    └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x103eb8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>
    │    └ <function subprocess_started at 0x103ee3380>
    └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x103f5e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x103ee2480>
           │       │   └ <uvicorn.server.Server object at 0x103f5e510>
           │       └ <function run at 0x10389f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x103f61470>
           │      └ <function Runner.run at 0x1038a3380>
           └ <asyncio.runners.Runner object at 0x103af8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1038a0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103af8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1038a0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1038a2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103833e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103fc1b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2873d9610>
          └ <fastapi.applications.FastAPI object at 0x103fc1b10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x2873d1da0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2873d8c10>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2873d9610>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2873d9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2873d8c10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2873bd110>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2873d9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104cfb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2873d23e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x2873d8150>
                     └ <function get_request_handler.<locals>.app at 0x2873d1f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104cfa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x2873d1c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2873bf650>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x2873d1120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x2873d0fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x2873d0ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:29] server.assistant_chat: Error communicating with the assistant: RetryError[<Future at 0x286ff69d0 state=finished raised AttributeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x2873d0ea0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102ee9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102c5fa60>
           └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102c5efc0>
    └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x103eb8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>
    │    └ <function subprocess_started at 0x103ee3380>
    └ <SpawnProcess name='SpawnProcess-3' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x103f5e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x103ee2480>
           │       │   └ <uvicorn.server.Server object at 0x103f5e510>
           │       └ <function run at 0x10389f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x103f61470>
           │      └ <function Runner.run at 0x1038a3380>
           └ <asyncio.runners.Runner object at 0x103af8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1038a0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103af8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1038a0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1038a2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103833e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103fc1b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x103fb6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2873d9610>
          └ <fastapi.applications.FastAPI object at 0x103fc1b10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x2873d1da0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2873d8c10>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2873d9610>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2873d9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2873d8c10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2873bd110>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2873d9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104cfb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2873d2700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2873f4190>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2873d23e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x2873d8150>
                     └ <function get_request_handler.<locals>.app at 0x2873d1f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104cfa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x2873d1c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2873bf650>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x2873d1120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x2873d0fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10859018704: attempt #3; slept for 2.0; last result: failed (AttributeError module 'conf.app' has no attribut...
         │    └ <function BaseRetrying.iter at 0x104db2980>
         └ <AsyncRetrying object at 0x286eb8810 (stop=<tenacity.stop.stop_after_attempt object at 0x104d9e350>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x102ff2d40>
          │              └ <Future at 0x286ff69d0 state=finished raised AttributeError>
          └ RetryError(<Future at 0x286ff69d0 state=finished raised AttributeError>)

tenacity.RetryError: RetryError[<Future at 0x286ff69d0 state=finished raised AttributeError>]
[23-09-05 07:30] base.handlers.message.chat: Starting chat process.
[23-09-05 07:30] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:30] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:30] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1006e5760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10045ba60>
           └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10045afc0>
    └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016b4dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>
    │    └ <function subprocess_started at 0x1016df380>
    └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10175a510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1016de480>
           │       │   └ <uvicorn.server.Server object at 0x10175a510>
           │       └ <function run at 0x10109b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10175d470>
           │      └ <function Runner.run at 0x10109f380>
           └ <asyncio.runners.Runner object at 0x1012f4250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10109cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1012f4250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10109cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10109ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10102fe20>
    └ <Handle <TaskStepMethWrapper object at 0x17426a7d0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17426a7d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17426a7d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17426a7d0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017b2b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017bdb10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017b2b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x174c611d0>
          └ <fastapi.applications.FastAPI object at 0x1017bdb10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x174c5b2e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1742ebd50>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x174c611d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x174c60650>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1742ebd50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x174c48b90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x174c60650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x174c5a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x174c7e7d0>
                     └ <function get_request_handler.<locals>.app at 0x174c59f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x174c59c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x174c4b190>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x174c59120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x174c58fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x174c58ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:30] base.handlers.message.chat: Starting chat process.
[23-09-05 07:30] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:30] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:30] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1006e5760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10045ba60>
           └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10045afc0>
    └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016b4dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>
    │    └ <function subprocess_started at 0x1016df380>
    └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10175a510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1016de480>
           │       │   └ <uvicorn.server.Server object at 0x10175a510>
           │       └ <function run at 0x10109b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10175d470>
           │      └ <function Runner.run at 0x10109f380>
           └ <asyncio.runners.Runner object at 0x1012f4250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10109cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1012f4250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10109cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10109ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10102fe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017b2b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017bdb10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017b2b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x174c611d0>
          └ <fastapi.applications.FastAPI object at 0x1017bdb10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x174c5b2e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1742ebd50>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x174c611d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x174c60650>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1742ebd50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x174c48b90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x174c60650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x174c5a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x174c7e7d0>
                     └ <function get_request_handler.<locals>.app at 0x174c59f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x174c59c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x174c4b190>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x174c59120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x174c58fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x174c58ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:30] base.handlers.message.chat: Starting chat process.
[23-09-05 07:30] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:30] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:30] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1006e5760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10045ba60>
           └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10045afc0>
    └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016b4dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>
    │    └ <function subprocess_started at 0x1016df380>
    └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10175a510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1016de480>
           │       │   └ <uvicorn.server.Server object at 0x10175a510>
           │       └ <function run at 0x10109b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10175d470>
           │      └ <function Runner.run at 0x10109f380>
           └ <asyncio.runners.Runner object at 0x1012f4250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10109cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1012f4250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10109cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10109ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10102fe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017b2b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017bdb10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017b2b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x174c611d0>
          └ <fastapi.applications.FastAPI object at 0x1017bdb10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x174c5b2e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1742ebd50>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x174c611d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x174c60650>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1742ebd50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x174c48b90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x174c60650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x174c5a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x174c7e7d0>
                     └ <function get_request_handler.<locals>.app at 0x174c59f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x174c59c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x174c4b190>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x174c59120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x174c58fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x174c58ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:30] server.assistant_chat: Error communicating with the assistant: RetryError[<Future at 0x174c88890 state=finished raised AttributeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x174c58ea0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1006e5760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10045ba60>
           └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10045afc0>
    └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016b4dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>
    │    └ <function subprocess_started at 0x1016df380>
    └ <SpawnProcess name='SpawnProcess-4' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10175a510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1016de480>
           │       │   └ <uvicorn.server.Server object at 0x10175a510>
           │       └ <function run at 0x10109b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x10175d470>
           │      └ <function Runner.run at 0x10109f380>
           └ <asyncio.runners.Runner object at 0x1012f4250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10109cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1012f4250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10109cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10109ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10102fe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017b2b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017bdb10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017b2b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x174c611d0>
          └ <fastapi.applications.FastAPI object at 0x1017bdb10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x174c5b2e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1742ebd50>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x174c611d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x174c60650>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1742ebd50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x174c48b90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x174c60650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x174c5b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x174c7e910>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x174c5a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x174c7e7d0>
                     └ <function get_request_handler.<locals>.app at 0x174c59f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x174c59c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x174c4b190>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x174c59120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x174c58fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6254227408: attempt #3; slept for 2.0; last result: failed (AttributeError module 'conf.app' has no attribute...
         │    └ <function BaseRetrying.iter at 0x10289e980>
         └ <AsyncRetrying object at 0x174250590 (stop=<tenacity.stop.stop_after_attempt object at 0x10288a990>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1007eed40>
          │              └ <Future at 0x174c88890 state=finished raised AttributeError>
          └ RetryError(<Future at 0x174c88890 state=finished raised AttributeError>)

tenacity.RetryError: RetryError[<Future at 0x174c88890 state=finished raised AttributeError>]
[23-09-05 07:34] base.handlers.message.chat: Starting chat process.
[23-09-05 07:34] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:34] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:34] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104959760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1046cfa60>
           └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1046cefc0>
    └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105928dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>
    │    └ <function subprocess_started at 0x105953380>
    └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1059ce510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105952480>
           │       │   └ <uvicorn.server.Server object at 0x1059ce510>
           │       └ <function run at 0x10530f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1059d1470>
           │      └ <function Runner.run at 0x105313380>
           └ <asyncio.runners.Runner object at 0x105568250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105310fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105568250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105310f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105312d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1052a3e20>
    └ <Handle <TaskStepMethWrapper object at 0x17f733280>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17f733280>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17f733280>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17f733280>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a26b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x105a31b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a26b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289608ed0>
          └ <fastapi.applications.FastAPI object at 0x105a31b10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x2895fe840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x289608e90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289608ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x289608310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x289608e90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2895f0750>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x289608310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10676b7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2895fe3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x289622690>
                     └ <function get_request_handler.<locals>.app at 0x2895fdf80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10676a2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x2895fdc60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2895f2d90>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x2895fd120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x2895fcfe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x2895fcea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:34] base.handlers.message.chat: Starting chat process.
[23-09-05 07:34] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:34] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:34] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104959760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1046cfa60>
           └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1046cefc0>
    └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105928dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>
    │    └ <function subprocess_started at 0x105953380>
    └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1059ce510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105952480>
           │       │   └ <uvicorn.server.Server object at 0x1059ce510>
           │       └ <function run at 0x10530f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1059d1470>
           │      └ <function Runner.run at 0x105313380>
           └ <asyncio.runners.Runner object at 0x105568250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105310fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105568250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105310f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105312d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1052a3e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a26b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x105a31b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a26b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289608ed0>
          └ <fastapi.applications.FastAPI object at 0x105a31b10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x2895fe840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x289608e90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289608ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x289608310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x289608e90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2895f0750>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x289608310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10676b7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2895fe3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x289622690>
                     └ <function get_request_handler.<locals>.app at 0x2895fdf80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10676a2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x2895fdc60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2895f2d90>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x2895fd120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x2895fcfe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x2895fcea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:34] base.handlers.message.chat: Starting chat process.
[23-09-05 07:34] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:34] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:34] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104959760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1046cfa60>
           └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1046cefc0>
    └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105928dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>
    │    └ <function subprocess_started at 0x105953380>
    └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1059ce510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105952480>
           │       │   └ <uvicorn.server.Server object at 0x1059ce510>
           │       └ <function run at 0x10530f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1059d1470>
           │      └ <function Runner.run at 0x105313380>
           └ <asyncio.runners.Runner object at 0x105568250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105310fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105568250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105310f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105312d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1052a3e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a26b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x105a31b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a26b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289608ed0>
          └ <fastapi.applications.FastAPI object at 0x105a31b10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x2895fe840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x289608e90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289608ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x289608310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x289608e90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2895f0750>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x289608310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10676b7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2895fe3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x289622690>
                     └ <function get_request_handler.<locals>.app at 0x2895fdf80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10676a2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x2895fdc60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2895f2d90>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x2895fd120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x2895fcfe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x2895fcea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:34] server.assistant_chat: Error communicating with the assistant: RetryError[<Future at 0x28918cd90 state=finished raised AttributeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x2895fcea0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104959760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1046cfa60>
           └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1046cefc0>
    └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105928dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>
    │    └ <function subprocess_started at 0x105953380>
    └ <SpawnProcess name='SpawnProcess-9' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1059ce510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105952480>
           │       │   └ <uvicorn.server.Server object at 0x1059ce510>
           │       └ <function run at 0x10530f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1059d1470>
           │      └ <function Runner.run at 0x105313380>
           └ <asyncio.runners.Runner object at 0x105568250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105310fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105568250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105310f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105312d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1052a3e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a26b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x105a31b10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105a26b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289608ed0>
          └ <fastapi.applications.FastAPI object at 0x105a31b10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x2895fe840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x289608e90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289608ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x289608310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x289608e90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x2895f0750>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x289608310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10676b7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2895ff100>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2896227d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2895fe3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x289622690>
                     └ <function get_request_handler.<locals>.app at 0x2895fdf80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10676a2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x2895fdc60>
                 └ <fastapi.dependencies.models.Dependant object at 0x2895f2d90>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x2895fd120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x2895fcfe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10894847568: attempt #3; slept for 2.0; last result: failed (AttributeError module 'conf.app' has no attribut...
         │    └ <function BaseRetrying.iter at 0x106822980>
         └ <AsyncRetrying object at 0x106bbfe50 (stop=<tenacity.stop.stop_after_attempt object at 0x10680e910>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x104a62d40>
          │              └ <Future at 0x28918cd90 state=finished raised AttributeError>
          └ RetryError(<Future at 0x28918cd90 state=finished raised AttributeError>)

tenacity.RetryError: RetryError[<Future at 0x28918cd90 state=finished raised AttributeError>]
[23-09-05 07:35] base.handlers.message.chat: Starting chat process.
[23-09-05 07:35] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:35] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:35] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x103261760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102fd7a60>
           └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102fd6fc0>
    └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x104230dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>
    │    └ <function subprocess_started at 0x10425b380>
    └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1042d6510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x10425a480>
           │       │   └ <uvicorn.server.Server object at 0x1042d6510>
           │       └ <function run at 0x103c171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1042d9470>
           │      └ <function Runner.run at 0x103c1b380>
           └ <asyncio.runners.Runner object at 0x103e70250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103c18fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103e70250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103c18f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103c1ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103babe20>
    └ <Handle <TaskStepMethWrapper object at 0x16f2f4e20>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16f2f4e20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16f2f4e20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16f2f4e20>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10432eb90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104e583d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10432eb90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x288061210>
          └ <fastapi.applications.FastAPI object at 0x104e583d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10427a660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x288060850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x288061210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288060790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x288060850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x288048d50>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288060790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1050737e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28805a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28807dc50>
                     └ <function get_request_handler.<locals>.app at 0x288059f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1050722a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x288059c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x28804b2d0>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x288059120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x288058fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x288058ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:35] base.handlers.message.chat: Starting chat process.
[23-09-05 07:35] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:35] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:35] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x103261760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102fd7a60>
           └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102fd6fc0>
    └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x104230dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>
    │    └ <function subprocess_started at 0x10425b380>
    └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1042d6510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x10425a480>
           │       │   └ <uvicorn.server.Server object at 0x1042d6510>
           │       └ <function run at 0x103c171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1042d9470>
           │      └ <function Runner.run at 0x103c1b380>
           └ <asyncio.runners.Runner object at 0x103e70250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103c18fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103e70250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103c18f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103c1ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103babe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10432eb90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104e583d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10432eb90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x288061210>
          └ <fastapi.applications.FastAPI object at 0x104e583d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10427a660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x288060850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x288061210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288060790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x288060850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x288048d50>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288060790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1050737e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28805a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28807dc50>
                     └ <function get_request_handler.<locals>.app at 0x288059f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1050722a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x288059c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x28804b2d0>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x288059120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x288058fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x288058ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:35] base.handlers.message.chat: Starting chat process.
[23-09-05 07:35] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:35] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:35] base.handlers.message.chat: There was a problem delivering the message manifest: module 'conf.app' has no attribute 'user'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x103261760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102fd7a60>
           └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102fd6fc0>
    └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x104230dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>
    │    └ <function subprocess_started at 0x10425b380>
    └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1042d6510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x10425a480>
           │       │   └ <uvicorn.server.Server object at 0x1042d6510>
           │       └ <function run at 0x103c171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1042d9470>
           │      └ <function Runner.run at 0x103c1b380>
           └ <asyncio.runners.Runner object at 0x103e70250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103c18fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103e70250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103c18f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103c1ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103babe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10432eb90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104e583d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10432eb90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x288061210>
          └ <fastapi.applications.FastAPI object at 0x104e583d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10427a660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x288060850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x288061210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288060790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x288060850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x288048d50>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288060790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1050737e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28805a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28807dc50>
                     └ <function get_request_handler.<locals>.app at 0x288059f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1050722a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x288059c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x28804b2d0>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x288059120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x288058fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x288058ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'
[23-09-05 07:35] server.assistant_chat: Error communicating with the assistant: RetryError[<Future at 0x28807ead0 state=finished raised AttributeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x288058ea0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 79, in chat
    user_message, MessageRole.USER, conf.app.user
    │             │           │     │    └ <module 'conf.app' from '/Users/kaechle/Developer/projects/scint/conf/app.py'>
    │             │           │     └ <module 'conf' from '/Users/kaechle/Developer/projects/scint/conf/__init__.py'>
    │             │           └ <MessageRole.USER: 'user'>
    │             └ <enum 'MessageRole'>
    └ UserMessage(message='Hi')

AttributeError: module 'conf.app' has no attribute 'user'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x103261760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102fd7a60>
           └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102fd6fc0>
    └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x104230dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>
    │    └ <function subprocess_started at 0x10425b380>
    └ <SpawnProcess name='SpawnProcess-10' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1042d6510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x10425a480>
           │       │   └ <uvicorn.server.Server object at 0x1042d6510>
           │       └ <function run at 0x103c171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1042d9470>
           │      └ <function Runner.run at 0x103c1b380>
           └ <asyncio.runners.Runner object at 0x103e70250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103c18fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103e70250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103c18f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103c1ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103babe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10432eb90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104e583d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10432eb90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x288061210>
          └ <fastapi.applications.FastAPI object at 0x104e583d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10427a660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x288060850>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x288061210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288060790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x288060850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x288048d50>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288060790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1050737e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28805afc0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28807dd90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28805a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28807dc50>
                     └ <function get_request_handler.<locals>.app at 0x288059f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1050722a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x288059c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x28804b2d0>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x288059120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x288058fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10872153104: attempt #3; slept for 2.0; last result: failed (AttributeError module 'conf.app' has no attribut...
         │    └ <function BaseRetrying.iter at 0x10512a980>
         └ <AsyncRetrying object at 0x1054c7a90 (stop=<tenacity.stop.stop_after_attempt object at 0x1051165d0>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x10336ad40>
          │              └ <Future at 0x28807ead0 state=finished raised AttributeError>
          └ RetryError(<Future at 0x28807ead0 state=finished raised AttributeError>)

tenacity.RetryError: RetryError[<Future at 0x28807ead0 state=finished raised AttributeError>]
[23-09-05 07:37] base.handlers.message.chat: Starting chat process.
[23-09-05 07:37] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:37] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:37] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:37] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:37] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1045c9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10433fa60>
           └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10433efc0>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1068b1050>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    └ <function subprocess_started at 0x106837380>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1068b2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x106836480>
           │       │   └ <uvicorn.server.Server object at 0x1068b2510>
           │       └ <function run at 0x104f7f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1068b5470>
           │      └ <function Runner.run at 0x104f83380>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f80fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f80f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f82d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104f13e20>
    └ <Handle <TaskStepMethWrapper object at 0x2888b3a60>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x2888b3a60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x2888b3a60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x2888b3a60>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106915cd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
          └ <fastapi.applications.FastAPI object at 0x106915cd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x28935b240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x289344f90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1080e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28935a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28937eb90>
                     └ <function get_request_handler.<locals>.app at 0x289359f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1080e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x289359c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x289347310>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x289358ea0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 83, in chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x289358e00>
    └ <base.handlers.message.MessageHandler object at 0x289347f90>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1082d49a0>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '16fb817b-b591-4c7b-8269-1dd9b47542ed'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x289376b60; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:37] base.handlers.message.chat: There was a problem delivering the message manifest: RetryError[<Future at 0x289388e10 state=finished raised TypeError>]
Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ([{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n      ...
                   └ <function chat at 0x289358ea0>

TypeError: chat() takes 1 positional argument but 2 were given


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1045c9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10433fa60>
           └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10433efc0>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1068b1050>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    └ <function subprocess_started at 0x106837380>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1068b2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x106836480>
           │       │   └ <uvicorn.server.Server object at 0x1068b2510>
           │       └ <function run at 0x104f7f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1068b5470>
           │      └ <function Runner.run at 0x104f83380>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f80fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f80f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f82d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104f13e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106915cd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
          └ <fastapi.applications.FastAPI object at 0x106915cd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x28935b240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x289344f90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1080e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28935a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28937eb90>
                     └ <function get_request_handler.<locals>.app at 0x289359f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1080e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x289359c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x289347310>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x289358ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 85, in chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ([{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n      ...
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10891850896: attempt #3; slept for 2.0; last result: failed (TypeError chat() takes 1 positional argument but...
         │    └ <function BaseRetrying.iter at 0x10829e980>
         └ <AsyncRetrying object at 0x10828a810 (stop=<tenacity.stop.stop_after_attempt object at 0x10828a850>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1046d2d40>
          │              └ <Future at 0x289388e10 state=finished raised TypeError>
          └ RetryError(<Future at 0x289388e10 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x289388e10 state=finished raised TypeError>]
[23-09-05 07:37] base.handlers.message.chat: Starting chat process.
[23-09-05 07:37] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:37] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:37] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:37] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:37] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1045c9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10433fa60>
           └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10433efc0>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1068b1050>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    └ <function subprocess_started at 0x106837380>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1068b2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x106836480>
           │       │   └ <uvicorn.server.Server object at 0x1068b2510>
           │       └ <function run at 0x104f7f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1068b5470>
           │      └ <function Runner.run at 0x104f83380>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f80fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f80f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f82d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104f13e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106915cd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
          └ <fastapi.applications.FastAPI object at 0x106915cd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x28935b240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x289344f90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1080e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28935a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28937eb90>
                     └ <function get_request_handler.<locals>.app at 0x289359f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1080e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x289359c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x289347310>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x289358ea0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 83, in chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x289358e00>
    └ <base.handlers.message.MessageHandler object at 0x289360f90>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1082d49a0>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '93fe88d2-0678-4fde-8ef0-e68f3f5257f0'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x2893772e0; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:37] base.handlers.message.chat: There was a problem delivering the message manifest: RetryError[<Future at 0x2893e3410 state=finished raised TypeError>]
Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ([{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n      ...
                   └ <function chat at 0x289358ea0>

TypeError: chat() takes 1 positional argument but 2 were given


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1045c9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10433fa60>
           └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10433efc0>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1068b1050>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    └ <function subprocess_started at 0x106837380>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1068b2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x106836480>
           │       │   └ <uvicorn.server.Server object at 0x1068b2510>
           │       └ <function run at 0x104f7f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1068b5470>
           │      └ <function Runner.run at 0x104f83380>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f80fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f80f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f82d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104f13e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106915cd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
          └ <fastapi.applications.FastAPI object at 0x106915cd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x28935b240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x289344f90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1080e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28935a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28937eb90>
                     └ <function get_request_handler.<locals>.app at 0x289359f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1080e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x289359c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x289347310>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x289358ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 85, in chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ([{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n      ...
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10892486160: attempt #3; slept for 2.0; last result: failed (TypeError chat() takes 1 positional argument but...
         │    └ <function BaseRetrying.iter at 0x10829e980>
         └ <AsyncRetrying object at 0x10828a810 (stop=<tenacity.stop.stop_after_attempt object at 0x10828a850>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1046d2d40>
          │              └ <Future at 0x2893e3410 state=finished raised TypeError>
          └ RetryError(<Future at 0x2893e3410 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x2893e3410 state=finished raised TypeError>]
[23-09-05 07:37] base.handlers.message.chat: Starting chat process.
[23-09-05 07:37] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:37] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:37] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:37] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:37] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1045c9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10433fa60>
           └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10433efc0>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1068b1050>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    └ <function subprocess_started at 0x106837380>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1068b2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x106836480>
           │       │   └ <uvicorn.server.Server object at 0x1068b2510>
           │       └ <function run at 0x104f7f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1068b5470>
           │      └ <function Runner.run at 0x104f83380>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f80fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f80f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f82d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104f13e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106915cd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
          └ <fastapi.applications.FastAPI object at 0x106915cd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x28935b240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x289344f90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1080e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28935a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28937eb90>
                     └ <function get_request_handler.<locals>.app at 0x289359f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1080e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x289359c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x289347310>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x289358ea0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 83, in chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x289358e00>
    └ <base.handlers.message.MessageHandler object at 0x2893e3ad0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1082d49a0>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '9b192d00-45ad-4cd9-8b5d-657c07896f17'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x2893773d0; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:37] base.handlers.message.chat: There was a problem delivering the message manifest: RetryError[<Future at 0x289363990 state=finished raised TypeError>]
Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ([{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n      ...
                   └ <function chat at 0x289358ea0>

TypeError: chat() takes 1 positional argument but 2 were given


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1045c9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10433fa60>
           └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10433efc0>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1068b1050>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    └ <function subprocess_started at 0x106837380>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1068b2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x106836480>
           │       │   └ <uvicorn.server.Server object at 0x1068b2510>
           │       └ <function run at 0x104f7f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1068b5470>
           │      └ <function Runner.run at 0x104f83380>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f80fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f80f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f82d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104f13e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106915cd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
          └ <fastapi.applications.FastAPI object at 0x106915cd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x28935b240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x289344f90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1080e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28935a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28937eb90>
                     └ <function get_request_handler.<locals>.app at 0x289359f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1080e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x289359c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x289347310>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x289358ea0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 85, in chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ([{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n      ...
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10892119184: attempt #3; slept for 2.0; last result: failed (TypeError chat() takes 1 positional argument but...
         │    └ <function BaseRetrying.iter at 0x10829e980>
         └ <AsyncRetrying object at 0x10828a810 (stop=<tenacity.stop.stop_after_attempt object at 0x10828a850>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1046d2d40>
          │              └ <Future at 0x289363990 state=finished raised TypeError>
          └ RetryError(<Future at 0x289363990 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x289363990 state=finished raised TypeError>]
[23-09-05 07:37] server.assistant_chat: Error communicating with the assistant: RetryError[<Future at 0x2893e2250 state=finished raised RetryError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ([{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n      ...
                   └ <function chat at 0x289358ea0>

TypeError: chat() takes 1 positional argument but 2 were given


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function chat at 0x289358ea0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 85, in chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ([{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n      ...
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10892119184: attempt #3; slept for 2.0; last result: failed (TypeError chat() takes 1 positional argument but...
         │    └ <function BaseRetrying.iter at 0x10829e980>
         └ <AsyncRetrying object at 0x10828a810 (stop=<tenacity.stop.stop_after_attempt object at 0x10828a850>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1046d2d40>
          │              └ <Future at 0x289363990 state=finished raised TypeError>
          └ RetryError(<Future at 0x289363990 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x289363990 state=finished raised TypeError>]


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1045c9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10433fa60>
           └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10433efc0>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1068b1050>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>
    │    └ <function subprocess_started at 0x106837380>
    └ <SpawnProcess name='SpawnProcess-11' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1068b2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x106836480>
           │       │   └ <uvicorn.server.Server object at 0x1068b2510>
           │       └ <function run at 0x104f7f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1068b5470>
           │      └ <function Runner.run at 0x104f83380>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f80fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1051d8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f80f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f82d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104f13e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106915cd0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1068b2a50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
          └ <fastapi.applications.FastAPI object at 0x106915cd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x28935b240>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x289360ad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2888dee90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x289344f90>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x288cf0ed0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1080e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x28935b1a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x28937ecd0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x28935a3e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x28937eb90>
                     └ <function get_request_handler.<locals>.app at 0x289359f80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1080e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x289359c60>
                 └ <fastapi.dependencies.models.Dependant object at 0x289347310>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi')
                     └ <function chat at 0x289359120>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function chat at 0x289358fe0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10892079952: attempt #3; slept for 2.0; last result: failed (RetryError RetryError[<Future at 0x289363990 sta...
         │    └ <function BaseRetrying.iter at 0x10829e980>
         └ <AsyncRetrying object at 0x10828a810 (stop=<tenacity.stop.stop_after_attempt object at 0x10828a850>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1046d2d40>
          │              └ <Future at 0x2893e2250 state=finished raised RetryError>
          └ RetryError(<Future at 0x2893e2250 state=finished raised RetryError>)

tenacity.RetryError: RetryError[<Future at 0x2893e2250 state=finished raised RetryError>]
[23-09-05 07:41] server.assistant_chat: Error communicating with the Scint API: 'module' object is not callable

Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104bb9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10492fa60>
           └ <SpawnProcess name='SpawnProcess-14' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10492efc0>
    └ <SpawnProcess name='SpawnProcess-14' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105b88dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-14' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-14' parent=19939 started>
    │    └ <function subprocess_started at 0x105bb3380>
    └ <SpawnProcess name='SpawnProcess-14' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105c2e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105bb2480>
           │       │   └ <uvicorn.server.Server object at 0x105c2e510>
           │       └ <function run at 0x10556f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x105c31470>
           │      └ <function Runner.run at 0x105573380>
           └ <asyncio.runners.Runner object at 0x1057c8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105570fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1057c8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105570f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105572d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105503e20>
    └ <Handle <TaskStepMethWrapper object at 0x17fb0c580>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17fb0c580>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17fb0c580>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17fb0c580>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105c86b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106a5ff10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x105c86b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2817e5d90>
          └ <fastapi.applications.FastAPI object at 0x106a5ff10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x2817d31a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2817e5390>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x2817e5d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2817d2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2817e5dd0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x2817e5390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2817d2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x280ca03d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x2817e5dd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2817d2de0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1069cb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x2817d2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x2817fca90>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x2817d2a20>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x2817fd610>
                     └ <function get_request_handler.<locals>.app at 0x2817d25c0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1069ca2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi there')}
                 │         └ <function assistant_chat at 0x2817d22a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x2817c3cd0>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await chat(message)
                     │    └ UserMessage(message='Hi there')
                     └ <module 'base.chat' from '/Users/kaechle/Developer/projects/scint/base/chat.py'>

TypeError: 'module' object is not callable
[23-09-05 07:43] base.chat.init_chat: Starting chat process.
[23-09-05 07:43] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:43] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:43] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:43] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:43] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100719760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10048fa60>
           └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10048efc0>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016e8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    └ <function subprocess_started at 0x101713380>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10178e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101712480>
           │       │   └ <uvicorn.server.Server object at 0x10178e510>
           │       └ <function run at 0x1010cf1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101791470>
           │      └ <function Runner.run at 0x1010d3380>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010d0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010d0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101063e20>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=True>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017f1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
          └ <fastapi.applications.FastAPI object at 0x1017f1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284cb65c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x284ca9390>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284cb68e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284ce3e10>
                     └ <function get_request_handler.<locals>.app at 0x284cb6480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x284cb6160>
                 └ <fastapi.dependencies.models.Dependant object at 0x284cab990>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x284cb5620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x284cb54e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x284750360>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x284cb5120>
    └ <base.handlers.message.MessageHandler object at 0x2847faed0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1030b3b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '44d9fb81-b975-4175-9b2e-3dd1dc5b1ae9'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x284cdd990; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:43] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100719760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10048fa60>
           └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10048efc0>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016e8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    └ <function subprocess_started at 0x101713380>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10178e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101712480>
           │       │   └ <uvicorn.server.Server object at 0x10178e510>
           │       └ <function run at 0x1010cf1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101791470>
           │      └ <function Runner.run at 0x1010d3380>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010d0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010d0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101063e20>
    └ <Handle <TaskStepMethWrapper object at 0x284178100>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x284178100>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x284178100>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x284178100>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017f1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
          └ <fastapi.applications.FastAPI object at 0x1017f1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284cb65c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x284ca9390>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284cb68e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284ce3e10>
                     └ <function get_request_handler.<locals>.app at 0x284cb6480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x284cb6160>
                 └ <fastapi.dependencies.models.Dependant object at 0x284cab990>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x284cb5620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x284cb54e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x284750360>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 32, in init_chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x284750220>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x284c993a0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x284c85f80>
                                 └ <openai.api_requestor.APIRequestor object at 0x28411fd50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x284c86340>
                   └ <openai.api_requestor.APIRequestor object at 0x28411fd50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x284c86200>
                             └ <openai.api_requestor.APIRequestor object at 0x28411fd50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x10112b740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x10112bce0>
           └ <json.encoder.JSONEncoder object at 0x10113ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x10112bd80>
             └ <json.encoder.JSONEncoder object at 0x10113ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x284cec160>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 07:43] base.chat.init_chat: Starting chat process.
[23-09-05 07:43] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:43] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:43] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:43] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:43] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100719760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10048fa60>
           └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10048efc0>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016e8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    └ <function subprocess_started at 0x101713380>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10178e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101712480>
           │       │   └ <uvicorn.server.Server object at 0x10178e510>
           │       └ <function run at 0x1010cf1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101791470>
           │      └ <function Runner.run at 0x1010d3380>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010d0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010d0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101063e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017f1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
          └ <fastapi.applications.FastAPI object at 0x1017f1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284cb65c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x284ca9390>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284cb68e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284ce3e10>
                     └ <function get_request_handler.<locals>.app at 0x284cb6480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x284cb6160>
                 └ <fastapi.dependencies.models.Dependant object at 0x284cab990>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x284cb5620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x284cb54e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x284750360>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x284cb5120>
    └ <base.handlers.message.MessageHandler object at 0x284744590>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1030b3b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '3109da2d-f5d7-45f3-a544-39ddeadd0b54'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x284823a60; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:43] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100719760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10048fa60>
           └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10048efc0>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016e8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    └ <function subprocess_started at 0x101713380>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10178e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101712480>
           │       │   └ <uvicorn.server.Server object at 0x10178e510>
           │       └ <function run at 0x1010cf1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101791470>
           │      └ <function Runner.run at 0x1010d3380>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010d0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010d0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101063e20>
    └ <Handle <TaskStepMethWrapper object at 0x2841782b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x2841782b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x2841782b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x2841782b0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017f1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
          └ <fastapi.applications.FastAPI object at 0x1017f1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284cb65c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x284ca9390>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284cb68e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284ce3e10>
                     └ <function get_request_handler.<locals>.app at 0x284cb6480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x284cb6160>
                 └ <fastapi.dependencies.models.Dependant object at 0x284cab990>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x284cb5620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x284cb54e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x284750360>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 32, in init_chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x284750220>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x284c993a0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x284c85f80>
                                 └ <openai.api_requestor.APIRequestor object at 0x2847fae10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x284c86340>
                   └ <openai.api_requestor.APIRequestor object at 0x2847fae10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x284c86200>
                             └ <openai.api_requestor.APIRequestor object at 0x2847fae10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x10112b740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x10112bce0>
           └ <json.encoder.JSONEncoder object at 0x10113ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x10112bd80>
             └ <json.encoder.JSONEncoder object at 0x10113ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x284ced1e0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 07:43] base.chat.init_chat: Starting chat process.
[23-09-05 07:43] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:43] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:43] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:43] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:43] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100719760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10048fa60>
           └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10048efc0>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016e8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    └ <function subprocess_started at 0x101713380>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10178e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101712480>
           │       │   └ <uvicorn.server.Server object at 0x10178e510>
           │       └ <function run at 0x1010cf1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101791470>
           │      └ <function Runner.run at 0x1010d3380>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010d0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010d0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101063e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017f1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
          └ <fastapi.applications.FastAPI object at 0x1017f1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284cb65c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x284ca9390>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284cb68e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284ce3e10>
                     └ <function get_request_handler.<locals>.app at 0x284cb6480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x284cb6160>
                 └ <fastapi.dependencies.models.Dependant object at 0x284cab990>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x284cb5620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x284cb54e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x284750360>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x284cb5120>
    └ <base.handlers.message.MessageHandler object at 0x284cea210>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1030b3b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ 'da754dd7-2aa4-47a1-b913-4b76f4e46890'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x284cdea70; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:43] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100719760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10048fa60>
           └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10048efc0>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016e8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    └ <function subprocess_started at 0x101713380>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10178e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101712480>
           │       │   └ <uvicorn.server.Server object at 0x10178e510>
           │       └ <function run at 0x1010cf1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101791470>
           │      └ <function Runner.run at 0x1010d3380>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010d0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010d0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101063e20>
    └ <Handle <TaskStepMethWrapper object at 0x284178310>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x284178310>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x284178310>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x284178310>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017f1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
          └ <fastapi.applications.FastAPI object at 0x1017f1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284cb65c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x284ca9390>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284cb68e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284ce3e10>
                     └ <function get_request_handler.<locals>.app at 0x284cb6480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x284cb6160>
                 └ <fastapi.dependencies.models.Dependant object at 0x284cab990>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x284cb5620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x284cb54e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x284750360>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 32, in init_chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x284750220>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x284c993a0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x284c85f80>
                                 └ <openai.api_requestor.APIRequestor object at 0x284ce1290>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x284c86340>
                   └ <openai.api_requestor.APIRequestor object at 0x284ce1290>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x284c86200>
                             └ <openai.api_requestor.APIRequestor object at 0x284ce1290>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x10112b740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x10112bce0>
           └ <json.encoder.JSONEncoder object at 0x10113ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x10112bd80>
             └ <json.encoder.JSONEncoder object at 0x10113ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x284ced180>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 07:43] server.assistant_chat: Error communicating with the Scint API: RetryError[<Future at 0x284ce13d0 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x284750360>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 32, in init_chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x284750220>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x284c993a0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x284c85f80>
                                 └ <openai.api_requestor.APIRequestor object at 0x284ce1290>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x284c86340>
                   └ <openai.api_requestor.APIRequestor object at 0x284ce1290>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x284c86200>
                             └ <openai.api_requestor.APIRequestor object at 0x284ce1290>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x10112b740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x10112bce0>
           └ <json.encoder.JSONEncoder object at 0x10113ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x10112bd80>
             └ <json.encoder.JSONEncoder object at 0x10113ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x284ced180>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100719760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10048fa60>
           └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10048efc0>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1016e8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>
    │    └ <function subprocess_started at 0x101713380>
    └ <SpawnProcess name='SpawnProcess-16' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10178e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101712480>
           │       │   └ <uvicorn.server.Server object at 0x10178e510>
           │       └ <function run at 0x1010cf1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101791470>
           │      └ <function Runner.run at 0x1010d3380>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010d0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101328250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010d0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010d2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101063e20>
    └ <Handle <TaskStepMethWrapper object at 0x284178310>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x284178310>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x284178310>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x284178310>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1017f1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1017e6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
          └ <fastapi.applications.FastAPI object at 0x1017f1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284cb65c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284cc92d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284cc8d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x284ca9390>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284cc9390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1026e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284cb6d40>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284ce0f10>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284cb68e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284ce3e10>
                     └ <function get_request_handler.<locals>.app at 0x284cb6480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1026e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x284cb6160>
                 └ <fastapi.dependencies.models.Dependant object at 0x284cab990>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x284cb5620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x284cb54e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10817813136: attempt #3; slept for 2.0; last result: failed (TypeError Object of type UserMessage is not JSON...
         │    └ <function BaseRetrying.iter at 0x1030b28e0>
         └ <AsyncRetrying object at 0x282fae590 (stop=<tenacity.stop.stop_after_attempt object at 0x2847fa510>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x100822d40>
          │              └ <Future at 0x284ce13d0 state=finished raised TypeError>
          └ RetryError(<Future at 0x284ce13d0 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x284ce13d0 state=finished raised TypeError>]
[23-09-05 07:49] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 07:49] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:49] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:49] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:49] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:49] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1030d9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102e4fa60>
           └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102e4efc0>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1040a8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    └ <function subprocess_started at 0x1040d3380>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10414e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1040d2480>
           │       │   └ <uvicorn.server.Server object at 0x10414e510>
           │       └ <function run at 0x103a8f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104151470>
           │      └ <function Runner.run at 0x103a93380>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103a90fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103a90f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103a92d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103a23e20>
    └ <Handle <TaskStepMethWrapper object at 0x14ff9c2e0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14ff9c2e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14ff9c2e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14ff9c2e0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104cd03d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
          └ <fastapi.applications.FastAPI object at 0x104cd03d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16f502840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x16f4f4fd0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104eeb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16f5028e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16f52f1d0>
                     └ <function get_request_handler.<locals>.app at 0x16f502480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104eea2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x16f502160>
                 └ <fastapi.dependencies.models.Dependant object at 0x16f4f7590>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x16f501620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x16f5014e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x16f150360>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 29, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x16f501120>
    └ <base.handlers.message.MessageHandler object at 0x16f1f8a10>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x104fb7b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '4845bd30-ff61-45d6-9ba3-5c6d93ad1f1c'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x16f52ab60; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:49] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1030d9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102e4fa60>
           └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102e4efc0>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1040a8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    └ <function subprocess_started at 0x1040d3380>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10414e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1040d2480>
           │       │   └ <uvicorn.server.Server object at 0x10414e510>
           │       └ <function run at 0x103a8f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104151470>
           │      └ <function Runner.run at 0x103a93380>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103a90fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103a90f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103a92d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103a23e20>
    └ <Handle <TaskStepMethWrapper object at 0x14fa8e440>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14fa8e440>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14fa8e440>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14fa8e440>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104cd03d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
          └ <fastapi.applications.FastAPI object at 0x104cd03d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16f502840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x16f4f4fd0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104eeb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16f5028e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16f52f1d0>
                     └ <function get_request_handler.<locals>.app at 0x16f502480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104eea2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x16f502160>
                 └ <fastapi.dependencies.models.Dependant object at 0x16f4f7590>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x16f501620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x16f5014e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x16f150360>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 31, in init_chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x16f150220>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x16f4e53a0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x16f4d1f80>
                                 └ <openai.api_requestor.APIRequestor object at 0x16f52f910>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x16f4d2340>
                   └ <openai.api_requestor.APIRequestor object at 0x16f52f910>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x16f4d2200>
                             └ <openai.api_requestor.APIRequestor object at 0x16f52f910>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103aeb740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103aebce0>
           └ <json.encoder.JSONEncoder object at 0x103afca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103aebd80>
             └ <json.encoder.JSONEncoder object at 0x103afca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x16f566d40>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 07:49] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 07:49] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:49] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:49] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:49] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:49] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1030d9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102e4fa60>
           └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102e4efc0>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1040a8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    └ <function subprocess_started at 0x1040d3380>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10414e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1040d2480>
           │       │   └ <uvicorn.server.Server object at 0x10414e510>
           │       └ <function run at 0x103a8f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104151470>
           │      └ <function Runner.run at 0x103a93380>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103a90fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103a90f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103a92d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103a23e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104cd03d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
          └ <fastapi.applications.FastAPI object at 0x104cd03d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16f502840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x16f4f4fd0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104eeb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16f5028e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16f52f1d0>
                     └ <function get_request_handler.<locals>.app at 0x16f502480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104eea2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x16f502160>
                 └ <fastapi.dependencies.models.Dependant object at 0x16f4f7590>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x16f501620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x16f5014e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x16f150360>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 29, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x16f501120>
    └ <base.handlers.message.MessageHandler object at 0x16f592e10>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x104fb7b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '2e6c3075-4702-456a-b004-a18fd34e2571'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x16f52ab60; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:49] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1030d9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102e4fa60>
           └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102e4efc0>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1040a8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    └ <function subprocess_started at 0x1040d3380>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10414e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1040d2480>
           │       │   └ <uvicorn.server.Server object at 0x10414e510>
           │       └ <function run at 0x103a8f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104151470>
           │      └ <function Runner.run at 0x103a93380>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103a90fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103a90f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103a92d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103a23e20>
    └ <Handle <TaskStepMethWrapper object at 0x14ff9d7b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14ff9d7b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14ff9d7b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14ff9d7b0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104cd03d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
          └ <fastapi.applications.FastAPI object at 0x104cd03d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16f502840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x16f4f4fd0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104eeb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16f5028e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16f52f1d0>
                     └ <function get_request_handler.<locals>.app at 0x16f502480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104eea2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x16f502160>
                 └ <fastapi.dependencies.models.Dependant object at 0x16f4f7590>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x16f501620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x16f5014e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x16f150360>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 31, in init_chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x16f150220>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x16f4e53a0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x16f4d1f80>
                                 └ <openai.api_requestor.APIRequestor object at 0x16f52dad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x16f4d2340>
                   └ <openai.api_requestor.APIRequestor object at 0x16f52dad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x16f4d2200>
                             └ <openai.api_requestor.APIRequestor object at 0x16f52dad0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103aeb740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103aebce0>
           └ <json.encoder.JSONEncoder object at 0x103afca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103aebd80>
             └ <json.encoder.JSONEncoder object at 0x103afca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x16f5a0ee0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 07:49] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 07:49] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:49] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:49] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:49] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:49] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1030d9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102e4fa60>
           └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102e4efc0>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1040a8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    └ <function subprocess_started at 0x1040d3380>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10414e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1040d2480>
           │       │   └ <uvicorn.server.Server object at 0x10414e510>
           │       └ <function run at 0x103a8f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104151470>
           │      └ <function Runner.run at 0x103a93380>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103a90fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103a90f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103a92d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103a23e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104cd03d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
          └ <fastapi.applications.FastAPI object at 0x104cd03d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16f502840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x16f4f4fd0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104eeb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16f5028e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16f52f1d0>
                     └ <function get_request_handler.<locals>.app at 0x16f502480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104eea2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x16f502160>
                 └ <fastapi.dependencies.models.Dependant object at 0x16f4f7590>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x16f501620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x16f5014e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x16f150360>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 29, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x16f501120>
    └ <base.handlers.message.MessageHandler object at 0x16f4f7d10>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x104fb7b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ 'baf02cca-75bf-4461-84ed-9f728c4faa12'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x16f52a3e0; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:49] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1030d9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102e4fa60>
           └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102e4efc0>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1040a8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    └ <function subprocess_started at 0x1040d3380>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10414e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1040d2480>
           │       │   └ <uvicorn.server.Server object at 0x10414e510>
           │       └ <function run at 0x103a8f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104151470>
           │      └ <function Runner.run at 0x103a93380>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103a90fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103a90f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103a92d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103a23e20>
    └ <Handle <TaskStepMethWrapper object at 0x14f96cd60>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14f96cd60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14f96cd60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14f96cd60>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104cd03d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
          └ <fastapi.applications.FastAPI object at 0x104cd03d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16f502840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x16f4f4fd0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104eeb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16f5028e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16f52f1d0>
                     └ <function get_request_handler.<locals>.app at 0x16f502480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104eea2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x16f502160>
                 └ <fastapi.dependencies.models.Dependant object at 0x16f4f7590>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x16f501620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x16f5014e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x16f150360>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 31, in init_chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x16f150220>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x16f4e53a0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x16f4d1f80>
                                 └ <openai.api_requestor.APIRequestor object at 0x16f06a850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x16f4d2340>
                   └ <openai.api_requestor.APIRequestor object at 0x16f06a850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x16f4d2200>
                             └ <openai.api_requestor.APIRequestor object at 0x16f06a850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103aeb740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103aebce0>
           └ <json.encoder.JSONEncoder object at 0x103afca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103aebd80>
             └ <json.encoder.JSONEncoder object at 0x103afca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x16f5a1540>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 07:49] server.assistant_chat: Error communicating with the Scint API: RetryError[<Future at 0x16f538190 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x16f150360>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 31, in init_chat
    response = await chat(messages, functions)
                     │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     └ <function chat at 0x16f150220>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x16f4e53a0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x16f4d1f80>
                                 └ <openai.api_requestor.APIRequestor object at 0x16f06a850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x16f4d2340>
                   └ <openai.api_requestor.APIRequestor object at 0x16f06a850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x16f4d2200>
                             └ <openai.api_requestor.APIRequestor object at 0x16f06a850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103aeb740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103aebce0>
           └ <json.encoder.JSONEncoder object at 0x103afca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103aebd80>
             └ <json.encoder.JSONEncoder object at 0x103afca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x16f5a1540>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1030d9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102e4fa60>
           └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102e4efc0>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1040a8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>
    │    └ <function subprocess_started at 0x1040d3380>
    └ <SpawnProcess name='SpawnProcess-27' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10414e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1040d2480>
           │       │   └ <uvicorn.server.Server object at 0x10414e510>
           │       └ <function run at 0x103a8f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104151470>
           │      └ <function Runner.run at 0x103a93380>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103a90fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103ce8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103a90f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103a92d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103a23e20>
    └ <Handle <TaskStepMethWrapper object at 0x14f96cd60>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14f96cd60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14f96cd60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14f96cd60>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x104cd03d0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1041a6b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
          └ <fastapi.applications.FastAPI object at 0x104cd03d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x16f502840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16f515550>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16f515510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x16f4f4fd0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16f5154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104eeb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16f5036a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16f52cc50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16f5028e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16f52f1d0>
                     └ <function get_request_handler.<locals>.app at 0x16f502480>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104eea2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x16f502160>
                 └ <fastapi.dependencies.models.Dependant object at 0x16f4f7590>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x16f501620>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x16f5014e0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6158565840: attempt #3; slept for 2.0; last result: failed (TypeError Object of type UserMessage is not JSON ...
         │    └ <function BaseRetrying.iter at 0x104fb68e0>
         └ <AsyncRetrying object at 0x14f91d510 (stop=<tenacity.stop.stop_after_attempt object at 0x105372490>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1031e2d40>
          │              └ <Future at 0x16f538190 state=finished raised TypeError>
          └ RetryError(<Future at 0x16f538190 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x16f538190 state=finished raised TypeError>]
[23-09-05 07:53] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 07:53] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:53] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:53] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:53] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:53] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104f5d760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x104cd3a60>
           └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x104cd2fc0>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105f2cdd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    └ <function subprocess_started at 0x105f57380>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105fd2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105f56480>
           │       │   └ <uvicorn.server.Server object at 0x105fd2510>
           │       └ <function run at 0x1059131a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x105fd5470>
           │      └ <function Runner.run at 0x105917380>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105914fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105914f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105916d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1058a7e20>
    └ <Handle <TaskStepMethWrapper object at 0x149418b20>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x149418b20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x149418b20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x149418b20>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106035b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
          └ <fastapi.applications.FastAPI object at 0x106035b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1495c2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10602b2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106d6f7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1495c22a0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1495df850>
                     └ <function get_request_handler.<locals>.app at 0x1495c1e40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106d6e2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x1495c1b20>
                 └ <fastapi.dependencies.models.Dependant object at 0x1495b0550>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x1495c0f40>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x1495c0e00>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x1495dbec0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 29, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x1495c0a40>
    └ <base.handlers.message.MessageHandler object at 0x13fef6390>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x106e3bb00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '55e9c81a-6e73-4c95-ac3f-c5db74b657a7'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x1494fbb50; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:53] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104f5d760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x104cd3a60>
           └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x104cd2fc0>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105f2cdd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    └ <function subprocess_started at 0x105f57380>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105fd2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105f56480>
           │       │   └ <uvicorn.server.Server object at 0x105fd2510>
           │       └ <function run at 0x1059131a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x105fd5470>
           │      └ <function Runner.run at 0x105917380>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105914fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105914f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105916d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1058a7e20>
    └ <Handle <TaskStepMethWrapper object at 0x1480b7cd0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1480b7cd0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1480b7cd0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1480b7cd0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106035b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
          └ <fastapi.applications.FastAPI object at 0x106035b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1495c2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10602b2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106d6f7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1495c22a0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1495df850>
                     └ <function get_request_handler.<locals>.app at 0x1495c1e40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106d6e2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x1495c1b20>
                 └ <fastapi.dependencies.models.Dependant object at 0x1495b0550>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x1495c0f40>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x1495c0e00>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x1495dbec0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 31, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1076247c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10783e5c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x10780f100>
                                 └ <openai.api_requestor.APIRequestor object at 0x1495b1090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x10780f4c0>
                   └ <openai.api_requestor.APIRequestor object at 0x1495b1090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x10780f380>
                             └ <openai.api_requestor.APIRequestor object at 0x1495b1090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x10596f740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x10596fce0>
           └ <json.encoder.JSONEncoder object at 0x105980a50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x10596fd80>
             └ <json.encoder.JSONEncoder object at 0x105980a50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x149588220>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 07:53] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 07:53] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:53] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:53] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:53] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:53] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104f5d760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x104cd3a60>
           └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x104cd2fc0>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105f2cdd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    └ <function subprocess_started at 0x105f57380>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105fd2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105f56480>
           │       │   └ <uvicorn.server.Server object at 0x105fd2510>
           │       └ <function run at 0x1059131a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x105fd5470>
           │      └ <function Runner.run at 0x105917380>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105914fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105914f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105916d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1058a7e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106035b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
          └ <fastapi.applications.FastAPI object at 0x106035b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1495c2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10602b2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106d6f7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1495c22a0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1495df850>
                     └ <function get_request_handler.<locals>.app at 0x1495c1e40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106d6e2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x1495c1b20>
                 └ <fastapi.dependencies.models.Dependant object at 0x1495b0550>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x1495c0f40>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x1495c0e00>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x1495dbec0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 29, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x1495c0a40>
    └ <base.handlers.message.MessageHandler object at 0x14951fe10>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x106e3bb00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '40031724-0adc-4167-b8b7-e8764cb2f787'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x149596200; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:53] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104f5d760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x104cd3a60>
           └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x104cd2fc0>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105f2cdd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    └ <function subprocess_started at 0x105f57380>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105fd2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105f56480>
           │       │   └ <uvicorn.server.Server object at 0x105fd2510>
           │       └ <function run at 0x1059131a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x105fd5470>
           │      └ <function Runner.run at 0x105917380>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105914fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105914f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105916d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1058a7e20>
    └ <Handle <TaskStepMethWrapper object at 0x1480b5c00>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1480b5c00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1480b5c00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1480b5c00>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106035b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
          └ <fastapi.applications.FastAPI object at 0x106035b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1495c2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10602b2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106d6f7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1495c22a0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1495df850>
                     └ <function get_request_handler.<locals>.app at 0x1495c1e40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106d6e2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x1495c1b20>
                 └ <fastapi.dependencies.models.Dependant object at 0x1495b0550>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x1495c0f40>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x1495c0e00>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x1495dbec0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 31, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1076247c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10783e5c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x10780f100>
                                 └ <openai.api_requestor.APIRequestor object at 0x1582f3bd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x10780f4c0>
                   └ <openai.api_requestor.APIRequestor object at 0x1582f3bd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x10780f380>
                             └ <openai.api_requestor.APIRequestor object at 0x1582f3bd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x10596f740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x10596fce0>
           └ <json.encoder.JSONEncoder object at 0x105980a50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x10596fd80>
             └ <json.encoder.JSONEncoder object at 0x105980a50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x149531d80>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 07:53] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 07:53] base.handlers.message.__init__: Message handler initialized.
[23-09-05 07:53] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 07:53] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 07:53] base.data.db.insert_message: Inserting message into database.
[23-09-05 07:53] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104f5d760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x104cd3a60>
           └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x104cd2fc0>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105f2cdd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    └ <function subprocess_started at 0x105f57380>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105fd2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105f56480>
           │       │   └ <uvicorn.server.Server object at 0x105fd2510>
           │       └ <function run at 0x1059131a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x105fd5470>
           │      └ <function Runner.run at 0x105917380>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105914fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105914f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105916d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1058a7e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106035b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
          └ <fastapi.applications.FastAPI object at 0x106035b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1495c2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10602b2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106d6f7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1495c22a0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1495df850>
                     └ <function get_request_handler.<locals>.app at 0x1495c1e40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106d6e2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x1495c1b20>
                 └ <fastapi.dependencies.models.Dependant object at 0x1495b0550>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x1495c0f40>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x1495c0e00>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x1495dbec0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 29, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x1495c0a40>
    └ <base.handlers.message.MessageHandler object at 0x14958fdd0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x106e3bb00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '64fa2516-8bf2-4936-91f0-4b2ccadd726d'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x1495958a0; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 07:53] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104f5d760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x104cd3a60>
           └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x104cd2fc0>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105f2cdd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    └ <function subprocess_started at 0x105f57380>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105fd2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105f56480>
           │       │   └ <uvicorn.server.Server object at 0x105fd2510>
           │       └ <function run at 0x1059131a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x105fd5470>
           │      └ <function Runner.run at 0x105917380>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105914fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105914f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105916d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1058a7e20>
    └ <Handle <TaskStepMethWrapper object at 0x1480b6260>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1480b6260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1480b6260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1480b6260>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106035b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
          └ <fastapi.applications.FastAPI object at 0x106035b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1495c2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10602b2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106d6f7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1495c22a0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1495df850>
                     └ <function get_request_handler.<locals>.app at 0x1495c1e40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106d6e2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x1495c1b20>
                 └ <fastapi.dependencies.models.Dependant object at 0x1495b0550>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x1495c0f40>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x1495c0e00>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x1495dbec0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 31, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1076247c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10783e5c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x10780f100>
                                 └ <openai.api_requestor.APIRequestor object at 0x1582f3f90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x10780f4c0>
                   └ <openai.api_requestor.APIRequestor object at 0x1582f3f90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x10780f380>
                             └ <openai.api_requestor.APIRequestor object at 0x1582f3f90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x10596f740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x10596fce0>
           └ <json.encoder.JSONEncoder object at 0x105980a50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x10596fd80>
             └ <json.encoder.JSONEncoder object at 0x105980a50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x1495d36a0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 07:53] server.assistant_chat: Error communicating with the Scint API: RetryError[<Future at 0x1582c75d0 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x1495dbec0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 31, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1076247c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10783e5c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x10780f100>
                                 └ <openai.api_requestor.APIRequestor object at 0x1582f3f90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x10780f4c0>
                   └ <openai.api_requestor.APIRequestor object at 0x1582f3f90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x10780f380>
                             └ <openai.api_requestor.APIRequestor object at 0x1582f3f90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x10596f740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x10596fce0>
           └ <json.encoder.JSONEncoder object at 0x105980a50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x10596fd80>
             └ <json.encoder.JSONEncoder object at 0x105980a50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x1495d36a0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x104f5d760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x104cd3a60>
           └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x104cd2fc0>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x105f2cdd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>
    │    └ <function subprocess_started at 0x105f57380>
    └ <SpawnProcess name='SpawnProcess-30' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x105fd2510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x105f56480>
           │       │   └ <uvicorn.server.Server object at 0x105fd2510>
           │       └ <function run at 0x1059131a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x105fd5470>
           │      └ <function Runner.run at 0x105917380>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105914fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105b6c250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105914f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105916d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1058a7e20>
    └ <Handle <TaskStepMethWrapper object at 0x1480b6260>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1480b6260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1480b6260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1480b6260>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x106035b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x10602ab90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
          └ <fastapi.applications.FastAPI object at 0x106035b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1495c2de0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1495b2810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1495b27d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x10602b2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x1495b2790>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x106d6f7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x105f76660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x14958c090>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x1495c22a0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1495df850>
                     └ <function get_request_handler.<locals>.app at 0x1495c1e40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x106d6e2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x1495c1b20>
                 └ <fastapi.dependencies.models.Dependant object at 0x1495b0550>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x1495c0f40>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x1495c0e00>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 5008963344: attempt #3; slept for 2.0; last result: failed (TypeError Object of type UserMessage is not JSON ...
         │    └ <function BaseRetrying.iter at 0x106e3a8e0>
         └ <AsyncRetrying object at 0x106e12990 (stop=<tenacity.stop.stop_after_attempt object at 0x106e48410>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x105066d40>
          │              └ <Future at 0x1582c75d0 state=finished raised TypeError>
          └ RetryError(<Future at 0x1582c75d0 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x1582c75d0 state=finished raised TypeError>]
[23-09-05 08:03] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 08:03] base.handlers.message.__init__: Message handler initialized.
[23-09-05 08:03] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 08:03] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 08:03] base.data.db.insert_message: Inserting message into database.
[23-09-05 08:03] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102d15760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1028bfa60>
           └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1028befc0>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1049b0990>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    └ <function subprocess_started at 0x104937380>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1049b1e90>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x104936480>
           │       │   └ <uvicorn.server.Server object at 0x1049b1e90>
           │       └ <function run at 0x1036171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1049b5470>
           │      └ <function Runner.run at 0x10361b380>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103618fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103618f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10361ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1035abe20>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb18d0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17bdb18d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17bdb18d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb18d0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102d80c90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
          └ <fastapi.applications.FastAPI object at 0x102d80c90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17ce29940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x17c955310>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17ce29ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17ce16010>
                     └ <function get_request_handler.<locals>.app at 0x17ce29a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x17ce29760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17ce14390>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x17ce28b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x17ce28a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x107e41440>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 28, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x17ce289a0>
    └ <base.handlers.message.MessageHandler object at 0x17c603990>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x105fb3b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '2f2c8585-f1c0-41fa-ad54-89c5cd280f7a'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x17ce04040; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 08:03] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102d15760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1028bfa60>
           └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1028befc0>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1049b0990>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    └ <function subprocess_started at 0x104937380>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1049b1e90>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x104936480>
           │       │   └ <uvicorn.server.Server object at 0x1049b1e90>
           │       └ <function run at 0x1036171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1049b5470>
           │      └ <function Runner.run at 0x10361b380>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103618fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103618f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10361ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1035abe20>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb3760>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17bdb3760>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17bdb3760>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb3760>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102d80c90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
          └ <fastapi.applications.FastAPI object at 0x102d80c90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17ce29940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x17c955310>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17ce29ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17ce16010>
                     └ <function get_request_handler.<locals>.app at 0x17ce29a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x17ce29760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17ce14390>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x17ce28b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x17ce28a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x107e41440>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1070647c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1074065c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x1073e3100>
                                 └ <openai.api_requestor.APIRequestor object at 0x17c693650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x1073e34c0>
                   └ <openai.api_requestor.APIRequestor object at 0x17c693650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x1073e3380>
                             └ <openai.api_requestor.APIRequestor object at 0x17c693650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103673740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103673ce0>
           └ <json.encoder.JSONEncoder object at 0x10368c550>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103673d80>
             └ <json.encoder.JSONEncoder object at 0x10368c550>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x17ce3b340>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 08:03] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 08:03] base.handlers.message.__init__: Message handler initialized.
[23-09-05 08:03] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 08:03] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 08:03] base.data.db.insert_message: Inserting message into database.
[23-09-05 08:03] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102d15760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1028bfa60>
           └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1028befc0>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1049b0990>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    └ <function subprocess_started at 0x104937380>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1049b1e90>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x104936480>
           │       │   └ <uvicorn.server.Server object at 0x1049b1e90>
           │       └ <function run at 0x1036171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1049b5470>
           │      └ <function Runner.run at 0x10361b380>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103618fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103618f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10361ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1035abe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102d80c90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
          └ <fastapi.applications.FastAPI object at 0x102d80c90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17ce29940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x17c955310>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17ce29ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17ce16010>
                     └ <function get_request_handler.<locals>.app at 0x17ce29a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x17ce29760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17ce14390>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x17ce28b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x17ce28a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x107e41440>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 28, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x17ce289a0>
    └ <base.handlers.message.MessageHandler object at 0x17cd83a10>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x105fb3b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '4823db9d-8f23-4878-bf88-d96988af6965'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x17ce045e0; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 08:03] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102d15760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1028bfa60>
           └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1028befc0>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1049b0990>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    └ <function subprocess_started at 0x104937380>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1049b1e90>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x104936480>
           │       │   └ <uvicorn.server.Server object at 0x1049b1e90>
           │       └ <function run at 0x1036171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1049b5470>
           │      └ <function Runner.run at 0x10361b380>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103618fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103618f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10361ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1035abe20>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb3e20>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17bdb3e20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17bdb3e20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb3e20>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102d80c90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
          └ <fastapi.applications.FastAPI object at 0x102d80c90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17ce29940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x17c955310>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17ce29ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17ce16010>
                     └ <function get_request_handler.<locals>.app at 0x17ce29a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x17ce29760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17ce14390>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x17ce28b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x17ce28a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x107e41440>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1070647c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1074065c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x1073e3100>
                                 └ <openai.api_requestor.APIRequestor object at 0x17cd83810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x1073e34c0>
                   └ <openai.api_requestor.APIRequestor object at 0x17cd83810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x1073e3380>
                             └ <openai.api_requestor.APIRequestor object at 0x17cd83810>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103673740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103673ce0>
           └ <json.encoder.JSONEncoder object at 0x10368c550>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103673d80>
             └ <json.encoder.JSONEncoder object at 0x10368c550>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x17cd77ca0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 08:03] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 08:03] base.handlers.message.__init__: Message handler initialized.
[23-09-05 08:03] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 08:03] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 08:03] base.data.db.insert_message: Inserting message into database.
[23-09-05 08:03] base.handlers.message.store_message: Failed to store message: can't adapt type 'UserMessage'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102d15760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1028bfa60>
           └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1028befc0>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1049b0990>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    └ <function subprocess_started at 0x104937380>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1049b1e90>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x104936480>
           │       │   └ <uvicorn.server.Server object at 0x1049b1e90>
           │       └ <function run at 0x1036171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1049b5470>
           │      └ <function Runner.run at 0x10361b380>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103618fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103618f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10361ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1035abe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102d80c90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
          └ <fastapi.applications.FastAPI object at 0x102d80c90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17ce29940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x17c955310>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17ce29ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17ce16010>
                     └ <function get_request_handler.<locals>.app at 0x17ce29a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x17ce29760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17ce14390>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x17ce28b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x17ce28a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x107e41440>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 28, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ UserMessage(message='Hi')
    │       └ <function MessageHandler.store_message at 0x17ce289a0>
    └ <base.handlers.message.MessageHandler object at 0x17cd836d0>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 64, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ UserMessage(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x105fb3b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ UserMessage(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '1b2cc09a-ab2c-4768-bbc2-59e2f5885d4b'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x17ce044f0; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'UserMessage'
[23-09-05 08:03] base.chat.init_chat: There was a problem delivering the message manifest: Object of type UserMessage is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102d15760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1028bfa60>
           └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1028befc0>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1049b0990>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    └ <function subprocess_started at 0x104937380>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1049b1e90>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x104936480>
           │       │   └ <uvicorn.server.Server object at 0x1049b1e90>
           │       └ <function run at 0x1036171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1049b5470>
           │      └ <function Runner.run at 0x10361b380>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103618fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103618f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10361ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1035abe20>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb3880>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17bdb3880>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17bdb3880>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb3880>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102d80c90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
          └ <fastapi.applications.FastAPI object at 0x102d80c90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17ce29940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x17c955310>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17ce29ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17ce16010>
                     └ <function get_request_handler.<locals>.app at 0x17ce29a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x17ce29760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17ce14390>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x17ce28b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x17ce28a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x107e41440>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1070647c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1074065c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x1073e3100>
                                 └ <openai.api_requestor.APIRequestor object at 0x17ce15950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x1073e34c0>
                   └ <openai.api_requestor.APIRequestor object at 0x17ce15950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x1073e3380>
                             └ <openai.api_requestor.APIRequestor object at 0x17ce15950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103673740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103673ce0>
           └ <json.encoder.JSONEncoder object at 0x10368c550>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103673d80>
             └ <json.encoder.JSONEncoder object at 0x10368c550>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x17ce3b3a0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable
[23-09-05 08:03] server.assistant_chat: Error communicating with the Scint API: RetryError[<Future at 0x17ce01e10 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (UserMessage(message='Hi'),)
                   └ <function init_chat at 0x107e41440>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1070647c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1074065c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x1073e3100>
                                 └ <openai.api_requestor.APIRequestor object at 0x17ce15950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x1073e34c0>
                   └ <openai.api_requestor.APIRequestor object at 0x17ce15950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x1073e3380>
                             └ <openai.api_requestor.APIRequestor object at 0x17ce15950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103673740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103673ce0>
           └ <json.encoder.JSONEncoder object at 0x10368c550>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103673d80>
             └ <json.encoder.JSONEncoder object at 0x10368c550>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x17ce3b3a0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type UserMessage is not JSON serializable


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102d15760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1028bfa60>
           └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1028befc0>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1049b0990>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>
    │    └ <function subprocess_started at 0x104937380>
    └ <SpawnProcess name='SpawnProcess-37' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1049b1e90>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x104936480>
           │       │   └ <uvicorn.server.Server object at 0x1049b1e90>
           │       └ <function run at 0x1036171a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1049b5470>
           │      └ <function Runner.run at 0x10361b380>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103618fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10480bb50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103618f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10361ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1035abe20>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb3880>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17bdb3880>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17bdb3880>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17bdb3880>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102d80c90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x17ce47450>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
          └ <fastapi.applications.FastAPI object at 0x102d80c90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17ce29940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17ce16390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17ce16350>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x17c955310>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17ce16310>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x105de77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17ce298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17ce17010>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17ce29ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17ce16010>
                     └ <function get_request_handler.<locals>.app at 0x17ce29a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x105de62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': UserMessage(message='Hi')}
                 │         └ <function assistant_chat at 0x17ce29760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17ce14390>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ UserMessage(message='Hi')
                     └ <function init_chat at 0x17ce28b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (UserMessage(message='Hi'),)
                 └ <function init_chat at 0x17ce28a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6390118416: attempt #3; slept for 2.0; last result: failed (TypeError Object of type UserMessage is not JSON ...
         │    └ <function BaseRetrying.iter at 0x105fb28e0>
         └ <AsyncRetrying object at 0x105f8a710 (stop=<tenacity.stop.stop_after_attempt object at 0x105fc01d0>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x102e1ed40>
          │              └ <Future at 0x17ce01e10 state=finished raised TypeError>
          └ RetryError(<Future at 0x17ce01e10 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x17ce01e10 state=finished raised TypeError>]
[23-09-05 08:12] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 08:12] base.handlers.message.__init__: Message handler initialized.
[23-09-05 08:12] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 08:12] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 08:12] base.data.db.insert_message: Inserting message into database.
[23-09-05 08:12] base.handlers.message.store_message: Failed to store message: can't adapt type 'Message'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x101125760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10102fa60>
           └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10102efc0>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101dfc1d0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    └ <function subprocess_started at 0x101e37380>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101eb1710>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101e36480>
           │       │   └ <uvicorn.server.Server object at 0x101eb1710>
           │       └ <function run at 0x101a2b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101eb5470>
           │      └ <function Runner.run at 0x101a2f380>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101a2cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101a2cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101a2ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1019bfe20>
    └ <Handle <TaskStepMethWrapper object at 0x136aeab90>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x136aeab90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x136aeab90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x136aeab90>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102b61110>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
          └ <fastapi.applications.FastAPI object at 0x102b61110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17d229940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x102b56890>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1043e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17d229ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17d216e90>
                     └ <function get_request_handler.<locals>.app at 0x17d229a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1043e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(message='Hi')}
                 │         └ <function assistant_chat at 0x17d229760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17d214290>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(message='Hi')
                     └ <function init_chat at 0x17d228b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(message='Hi'),)
                 └ <function init_chat at 0x17d228a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(message='Hi'),)
                   └ <function init_chat at 0x1068d9440>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 28, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ Message(message='Hi')
    │       └ <function MessageHandler.store_message at 0x17d2289a0>
    └ <base.handlers.message.MessageHandler object at 0x136915610>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 63, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ Message(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1045b3b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ Message(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '4587d9c7-c2b1-45e1-aad1-b22d4d1ed219'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x17d200040; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'Message'
[23-09-05 08:12] base.chat.init_chat: There was a problem delivering the message manifest: Object of type Message is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x101125760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10102fa60>
           └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10102efc0>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101dfc1d0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    └ <function subprocess_started at 0x101e37380>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101eb1710>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101e36480>
           │       │   └ <uvicorn.server.Server object at 0x101eb1710>
           │       └ <function run at 0x101a2b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101eb5470>
           │      └ <function Runner.run at 0x101a2f380>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101a2cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101a2cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101a2ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1019bfe20>
    └ <Handle <TaskStepMethWrapper object at 0x17c717d00>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17c717d00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17c717d00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17c717d00>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102b61110>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
          └ <fastapi.applications.FastAPI object at 0x102b61110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17d229940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x102b56890>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1043e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17d229ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17d216e90>
                     └ <function get_request_handler.<locals>.app at 0x17d229a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1043e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(message='Hi')}
                 │         └ <function assistant_chat at 0x17d229760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17d214290>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(message='Hi')
                     └ <function init_chat at 0x17d228b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(message='Hi'),)
                 └ <function init_chat at 0x17d228a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(message='Hi'),)
                   └ <function init_chat at 0x1068d9440>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x104e647c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1050165c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x10501f100>
                                 └ <openai.api_requestor.APIRequestor object at 0x17d204990>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x10501f4c0>
                   └ <openai.api_requestor.APIRequestor object at 0x17d204990>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x10501f380>
                             └ <openai.api_requestor.APIRequestor object at 0x17d204990>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x101a87740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x101a87ce0>
           └ <json.encoder.JSONEncoder object at 0x101c00150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x101a87d80>
             └ <json.encoder.JSONEncoder object at 0x101c00150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x17d1fc0a0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Message is not JSON serializable
[23-09-05 08:13] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 08:13] base.handlers.message.__init__: Message handler initialized.
[23-09-05 08:13] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 08:13] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 08:13] base.data.db.insert_message: Inserting message into database.
[23-09-05 08:13] base.handlers.message.store_message: Failed to store message: can't adapt type 'Message'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x101125760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10102fa60>
           └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10102efc0>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101dfc1d0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    └ <function subprocess_started at 0x101e37380>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101eb1710>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101e36480>
           │       │   └ <uvicorn.server.Server object at 0x101eb1710>
           │       └ <function run at 0x101a2b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101eb5470>
           │      └ <function Runner.run at 0x101a2f380>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101a2cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101a2cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101a2ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1019bfe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102b61110>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
          └ <fastapi.applications.FastAPI object at 0x102b61110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17d229940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x102b56890>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1043e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17d229ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17d216e90>
                     └ <function get_request_handler.<locals>.app at 0x17d229a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1043e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(message='Hi')}
                 │         └ <function assistant_chat at 0x17d229760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17d214290>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(message='Hi')
                     └ <function init_chat at 0x17d228b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(message='Hi'),)
                 └ <function init_chat at 0x17d228a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(message='Hi'),)
                   └ <function init_chat at 0x1068d9440>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 28, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ Message(message='Hi')
    │       └ <function MessageHandler.store_message at 0x17d2289a0>
    └ <base.handlers.message.MessageHandler object at 0x17d205590>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 63, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ Message(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1045b3b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ Message(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ 'ace85c30-626f-4fdf-b108-106a10155e82'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x17d2005e0; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'Message'
[23-09-05 08:13] base.chat.init_chat: There was a problem delivering the message manifest: Object of type Message is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x101125760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10102fa60>
           └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10102efc0>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101dfc1d0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    └ <function subprocess_started at 0x101e37380>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101eb1710>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101e36480>
           │       │   └ <uvicorn.server.Server object at 0x101eb1710>
           │       └ <function run at 0x101a2b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101eb5470>
           │      └ <function Runner.run at 0x101a2f380>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101a2cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101a2cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101a2ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1019bfe20>
    └ <Handle <TaskStepMethWrapper object at 0x1033fb460>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1033fb460>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1033fb460>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1033fb460>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102b61110>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
          └ <fastapi.applications.FastAPI object at 0x102b61110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17d229940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x102b56890>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1043e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17d229ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17d216e90>
                     └ <function get_request_handler.<locals>.app at 0x17d229a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1043e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(message='Hi')}
                 │         └ <function assistant_chat at 0x17d229760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17d214290>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(message='Hi')
                     └ <function init_chat at 0x17d228b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(message='Hi'),)
                 └ <function init_chat at 0x17d228a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(message='Hi'),)
                   └ <function init_chat at 0x1068d9440>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x104e647c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1050165c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x10501f100>
                                 └ <openai.api_requestor.APIRequestor object at 0x17d17f710>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x10501f4c0>
                   └ <openai.api_requestor.APIRequestor object at 0x17d17f710>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x10501f380>
                             └ <openai.api_requestor.APIRequestor object at 0x17d17f710>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x101a87740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x101a87ce0>
           └ <json.encoder.JSONEncoder object at 0x101c00150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x101a87d80>
             └ <json.encoder.JSONEncoder object at 0x101c00150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x17d177c40>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Message is not JSON serializable
[23-09-05 08:13] base.chat.init_chat: Message received from user: message='Hi'
[23-09-05 08:13] base.handlers.message.__init__: Message handler initialized.
[23-09-05 08:13] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 08:13] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 08:13] base.data.db.insert_message: Inserting message into database.
[23-09-05 08:13] base.handlers.message.store_message: Failed to store message: can't adapt type 'Message'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x101125760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10102fa60>
           └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10102efc0>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101dfc1d0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    └ <function subprocess_started at 0x101e37380>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101eb1710>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101e36480>
           │       │   └ <uvicorn.server.Server object at 0x101eb1710>
           │       └ <function run at 0x101a2b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101eb5470>
           │      └ <function Runner.run at 0x101a2f380>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101a2cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101a2cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101a2ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1019bfe20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102b61110>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
          └ <fastapi.applications.FastAPI object at 0x102b61110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17d229940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x102b56890>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1043e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17d229ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17d216e90>
                     └ <function get_request_handler.<locals>.app at 0x17d229a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1043e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(message='Hi')}
                 │         └ <function assistant_chat at 0x17d229760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17d214290>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(message='Hi')
                     └ <function init_chat at 0x17d228b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(message='Hi'),)
                 └ <function init_chat at 0x17d228a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(message='Hi'),)
                   └ <function init_chat at 0x1068d9440>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 28, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ Message(message='Hi')
    │       └ <function MessageHandler.store_message at 0x17d2289a0>
    └ <base.handlers.message.MessageHandler object at 0x17d17ed90>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 63, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ Message(message='Hi')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1045b3b00>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ Message(message='Hi')
    │      │       │              │           └ 'user'
    │      │       │              └ '186fb993-aa11-4e4c-90e2-86034b5ade0c'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x17d2004f0; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'Message'
[23-09-05 08:13] base.chat.init_chat: There was a problem delivering the message manifest: Object of type Message is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x101125760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10102fa60>
           └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10102efc0>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101dfc1d0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    └ <function subprocess_started at 0x101e37380>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101eb1710>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101e36480>
           │       │   └ <uvicorn.server.Server object at 0x101eb1710>
           │       └ <function run at 0x101a2b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101eb5470>
           │      └ <function Runner.run at 0x101a2f380>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101a2cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101a2cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101a2ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1019bfe20>
    └ <Handle <TaskStepMethWrapper object at 0x136aeac20>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x136aeac20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x136aeac20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x136aeac20>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102b61110>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
          └ <fastapi.applications.FastAPI object at 0x102b61110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17d229940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x102b56890>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1043e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17d229ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17d216e90>
                     └ <function get_request_handler.<locals>.app at 0x17d229a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1043e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(message='Hi')}
                 │         └ <function assistant_chat at 0x17d229760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17d214290>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(message='Hi')
                     └ <function init_chat at 0x17d228b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(message='Hi'),)
                 └ <function init_chat at 0x17d228a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(message='Hi'),)
                   └ <function init_chat at 0x1068d9440>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x104e647c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1050165c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x10501f100>
                                 └ <openai.api_requestor.APIRequestor object at 0x17d2a7bd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x10501f4c0>
                   └ <openai.api_requestor.APIRequestor object at 0x17d2a7bd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x10501f380>
                             └ <openai.api_requestor.APIRequestor object at 0x17d2a7bd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x101a87740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x101a87ce0>
           └ <json.encoder.JSONEncoder object at 0x101c00150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x101a87d80>
             └ <json.encoder.JSONEncoder object at 0x101c00150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x17d177d60>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Message is not JSON serializable
[23-09-05 08:13] server.assistant_chat: Error communicating with the Scint API: RetryError[<Future at 0x17d205790 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(message='Hi'),)
                   └ <function init_chat at 0x1068d9440>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x104e647c0>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1050165c0>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x10501f100>
                                 └ <openai.api_requestor.APIRequestor object at 0x17d2a7bd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x10501f4c0>
                   └ <openai.api_requestor.APIRequestor object at 0x17d2a7bd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x10501f380>
                             └ <openai.api_requestor.APIRequestor object at 0x17d2a7bd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x101a87740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x101a87ce0>
           └ <json.encoder.JSONEncoder object at 0x101c00150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x101a87d80>
             └ <json.encoder.JSONEncoder object at 0x101c00150>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x17d177d60>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Message is not JSON serializable


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x101125760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x10102fa60>
           └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x10102efc0>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101dfc1d0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>
    │    └ <function subprocess_started at 0x101e37380>
    └ <SpawnProcess name='SpawnProcess-42' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101eb1710>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101e36480>
           │       │   └ <uvicorn.server.Server object at 0x101eb1710>
           │       └ <function run at 0x101a2b1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101eb5470>
           │      └ <function Runner.run at 0x101a2f380>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101a2cfe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101eb0e50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101a2cf40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101a2ed40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1019bfe20>
    └ <Handle <TaskStepMethWrapper object at 0x136aeac20>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x136aeac20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x136aeac20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x136aeac20>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x102b61110>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101eb1c50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
          └ <fastapi.applications.FastAPI object at 0x102b61110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x17d229940>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17d215e50>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17d2154d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x102b56890>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17d2155d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x1043e77e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17d2298a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17d216a50>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17d229ee0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17d216e90>
                     └ <function get_request_handler.<locals>.app at 0x17d229a80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1043e62a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(message='Hi')}
                 │         └ <function assistant_chat at 0x17d229760>
                 └ <fastapi.dependencies.models.Dependant object at 0x17d214290>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(message='Hi')
                     └ <function init_chat at 0x17d228b80>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(message='Hi'),)
                 └ <function init_chat at 0x17d228a40>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6394311184: attempt #3; slept for 2.0; last result: failed (TypeError Object of type Message is not JSON seri...
         │    └ <function BaseRetrying.iter at 0x1045b28e0>
         └ <AsyncRetrying object at 0x10458a450 (stop=<tenacity.stop.stop_after_attempt object at 0x1045a85d0>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x10122ed40>
          │              └ <Future at 0x17d205790 state=finished raised TypeError>
          └ RetryError(<Future at 0x17d205790 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x17d205790 state=finished raised TypeError>]
[23-09-05 08:16] base.chat.init_chat: Message received from user: role=<MessageRole.USER: 'user'> content='Hello'
[23-09-05 08:16] base.handlers.message.__init__: Message handler initialized.
[23-09-05 08:16] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 08:16] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 08:16] base.data.db.insert_message: Inserting message into database.
[23-09-05 08:16] base.handlers.message.store_message: Failed to store message: can't adapt type 'Message'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1031e9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102f5fa60>
           └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102f5efc0>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1041b8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    └ <function subprocess_started at 0x1041e3380>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10425e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1041e2480>
           │       │   └ <uvicorn.server.Server object at 0x10425e510>
           │       └ <function run at 0x103b9f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104261470>
           │      └ <function Runner.run at 0x103ba3380>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103ba0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103ba0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103ba2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103b33e20>
    └ <Handle <TaskStepMethWrapper object at 0x16ee364d0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16ee364d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16ee364d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16ee364d0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1042c1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
          └ <fastapi.applications.FastAPI object at 0x1042c1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104202660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1042b7410>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ffb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16efc59e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16ef9a490>
                     └ <function get_request_handler.<locals>.app at 0x16efc5bc0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ffa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(role=<MessageRole.USER: 'user'>, content='Hello')}
                 │         └ <function assistant_chat at 0x16efc58a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x16efa8350>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
                     └ <function init_chat at 0x16efc4cc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                 └ <function init_chat at 0x16efc4b80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                   └ <function init_chat at 0x106009580>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 28, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
    │       └ <function MessageHandler.store_message at 0x16efc4ae0>
    └ <base.handlers.message.MessageHandler object at 0x16efa8550>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 63, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1050c7c40>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
    │      │       │              │           └ 'user'
    │      │       │              └ 'fb139593-969a-4df4-8bb9-4fb0fc59cc22'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x16ef91210; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'Message'
[23-09-05 08:16] base.chat.init_chat: There was a problem delivering the message manifest: Object of type Message is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1031e9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102f5fa60>
           └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102f5efc0>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1041b8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    └ <function subprocess_started at 0x1041e3380>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10425e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1041e2480>
           │       │   └ <uvicorn.server.Server object at 0x10425e510>
           │       └ <function run at 0x103b9f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104261470>
           │      └ <function Runner.run at 0x103ba3380>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103ba0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103ba0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103ba2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103b33e20>
    └ <Handle <TaskStepMethWrapper object at 0x16ee37f10>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16ee37f10>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16ee37f10>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16ee37f10>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1042c1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
          └ <fastapi.applications.FastAPI object at 0x1042c1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104202660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1042b7410>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ffb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16efc59e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16ef9a490>
                     └ <function get_request_handler.<locals>.app at 0x16efc5bc0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ffa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(role=<MessageRole.USER: 'user'>, content='Hello')}
                 │         └ <function assistant_chat at 0x16efc58a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x16efa8350>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
                     └ <function init_chat at 0x16efc4cc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                 └ <function init_chat at 0x16efc4b80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                   └ <function init_chat at 0x106009580>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1058ac900>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x105ada700>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x105ab3240>
                                 └ <openai.api_requestor.APIRequestor object at 0x16ef2e690>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x105ab3600>
                   └ <openai.api_requestor.APIRequestor object at 0x16ef2e690>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x105ab34c0>
                             └ <openai.api_requestor.APIRequestor object at 0x16ef2e690>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103bfb740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103bfbce0>
           └ <json.encoder.JSONEncoder object at 0x103c0ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103bfbd80>
             └ <json.encoder.JSONEncoder object at 0x103c0ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x16ef58fa0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Message is not JSON serializable
[23-09-05 08:16] base.chat.init_chat: Message received from user: role=<MessageRole.USER: 'user'> content='Hello'
[23-09-05 08:16] base.handlers.message.__init__: Message handler initialized.
[23-09-05 08:16] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 08:16] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 08:16] base.data.db.insert_message: Inserting message into database.
[23-09-05 08:16] base.handlers.message.store_message: Failed to store message: can't adapt type 'Message'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1031e9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102f5fa60>
           └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102f5efc0>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1041b8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    └ <function subprocess_started at 0x1041e3380>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10425e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1041e2480>
           │       │   └ <uvicorn.server.Server object at 0x10425e510>
           │       └ <function run at 0x103b9f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104261470>
           │      └ <function Runner.run at 0x103ba3380>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103ba0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103ba0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103ba2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103b33e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1042c1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
          └ <fastapi.applications.FastAPI object at 0x1042c1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104202660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1042b7410>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ffb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16efc59e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16ef9a490>
                     └ <function get_request_handler.<locals>.app at 0x16efc5bc0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ffa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(role=<MessageRole.USER: 'user'>, content='Hello')}
                 │         └ <function assistant_chat at 0x16efc58a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x16efa8350>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
                     └ <function init_chat at 0x16efc4cc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                 └ <function init_chat at 0x16efc4b80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                   └ <function init_chat at 0x106009580>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 28, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
    │       └ <function MessageHandler.store_message at 0x16efc4ae0>
    └ <base.handlers.message.MessageHandler object at 0x16ef54510>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 63, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1050c7c40>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
    │      │       │              │           └ 'user'
    │      │       │              └ '8d2e2d1f-e7a6-4058-b503-0016af9857fc'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x16ef906d0; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'Message'
[23-09-05 08:16] base.chat.init_chat: There was a problem delivering the message manifest: Object of type Message is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1031e9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102f5fa60>
           └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102f5efc0>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1041b8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    └ <function subprocess_started at 0x1041e3380>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10425e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1041e2480>
           │       │   └ <uvicorn.server.Server object at 0x10425e510>
           │       └ <function run at 0x103b9f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104261470>
           │      └ <function Runner.run at 0x103ba3380>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103ba0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103ba0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103ba2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103b33e20>
    └ <Handle <TaskStepMethWrapper object at 0x16ee37370>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16ee37370>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16ee37370>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16ee37370>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1042c1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
          └ <fastapi.applications.FastAPI object at 0x1042c1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104202660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1042b7410>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ffb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16efc59e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16ef9a490>
                     └ <function get_request_handler.<locals>.app at 0x16efc5bc0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ffa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(role=<MessageRole.USER: 'user'>, content='Hello')}
                 │         └ <function assistant_chat at 0x16efc58a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x16efa8350>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
                     └ <function init_chat at 0x16efc4cc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                 └ <function init_chat at 0x16efc4b80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                   └ <function init_chat at 0x106009580>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1058ac900>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x105ada700>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x105ab3240>
                                 └ <openai.api_requestor.APIRequestor object at 0x16ef55490>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x105ab3600>
                   └ <openai.api_requestor.APIRequestor object at 0x16ef55490>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x105ab34c0>
                             └ <openai.api_requestor.APIRequestor object at 0x16ef55490>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103bfb740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103bfbce0>
           └ <json.encoder.JSONEncoder object at 0x103c0ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103bfbd80>
             └ <json.encoder.JSONEncoder object at 0x103c0ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x16ef580a0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Message is not JSON serializable
[23-09-05 08:16] base.chat.init_chat: Message received from user: role=<MessageRole.USER: 'user'> content='Hello'
[23-09-05 08:16] base.handlers.message.__init__: Message handler initialized.
[23-09-05 08:16] base.handlers.message.build_manifest: Building message manifest.
[23-09-05 08:16] base.data.db.init_sql_connection: Opening database connection.
[23-09-05 08:16] base.data.db.insert_message: Inserting message into database.
[23-09-05 08:16] base.handlers.message.store_message: Failed to store message: can't adapt type 'Message'
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1031e9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102f5fa60>
           └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102f5efc0>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1041b8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    └ <function subprocess_started at 0x1041e3380>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10425e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1041e2480>
           │       │   └ <uvicorn.server.Server object at 0x10425e510>
           │       └ <function run at 0x103b9f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104261470>
           │      └ <function Runner.run at 0x103ba3380>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103ba0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103ba0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103ba2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103b33e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1042c1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
          └ <fastapi.applications.FastAPI object at 0x1042c1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104202660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1042b7410>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ffb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16efc59e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16ef9a490>
                     └ <function get_request_handler.<locals>.app at 0x16efc5bc0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ffa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(role=<MessageRole.USER: 'user'>, content='Hello')}
                 │         └ <function assistant_chat at 0x16efc58a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x16efa8350>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
                     └ <function init_chat at 0x16efc4cc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                 └ <function init_chat at 0x16efc4b80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                   └ <function init_chat at 0x106009580>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 28, in init_chat
    handler.store_message("user", user_message, None)
    │       │                     └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
    │       └ <function MessageHandler.store_message at 0x16efc4ae0>
    └ <base.handlers.message.MessageHandler object at 0x16f387a10>

> File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 63, in store_message
    base.data.db.insert_message(role, content, response_id)
    │    │    │  │              │     │        └ None
    │    │    │  │              │     └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
    │    │    │  │              └ 'user'
    │    │    │  └ <function insert_message at 0x1050c7c40>
    │    │    └ <module 'base.data.db' from '/Users/kaechle/Developer/projects/scint/base/data/db.py'>
    │    └ <module 'base.data' from '/Users/kaechle/Developer/projects/scint/base/data/__init__.py'>
    └ <module 'base' from '/Users/kaechle/Developer/projects/scint/base/__init__.py'>

  File "/Users/kaechle/Developer/projects/scint/base/data/db.py", line 48, in insert_message
    cursor.execute(insert_query, (message_id, role, content, response_id))
    │      │       │              │           │     │        └ None
    │      │       │              │           │     └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
    │      │       │              │           └ 'user'
    │      │       │              └ '185b93ab-5e18-41ff-9430-ff63aa1f1367'
    │      │       └ '\n    INSERT INTO messages (message_id, role, content, timestamp, response_id)\n    VALUES (%s, %s, %s, NOW(), %s);\n    '
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x16ef90f40; closed: 0>

psycopg2.ProgrammingError: can't adapt type 'Message'
[23-09-05 08:16] base.chat.init_chat: There was a problem delivering the message manifest: Object of type Message is not JSON serializable
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1031e9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102f5fa60>
           └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102f5efc0>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1041b8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    └ <function subprocess_started at 0x1041e3380>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10425e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1041e2480>
           │       │   └ <uvicorn.server.Server object at 0x10425e510>
           │       └ <function run at 0x103b9f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104261470>
           │      └ <function Runner.run at 0x103ba3380>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103ba0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103ba0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103ba2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103b33e20>
    └ <Handle <TaskStepMethWrapper object at 0x16ee36ce0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16ee36ce0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16ee36ce0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16ee36ce0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1042c1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
          └ <fastapi.applications.FastAPI object at 0x1042c1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104202660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1042b7410>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ffb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16efc59e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16ef9a490>
                     └ <function get_request_handler.<locals>.app at 0x16efc5bc0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ffa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(role=<MessageRole.USER: 'user'>, content='Hello')}
                 │         └ <function assistant_chat at 0x16efc58a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x16efa8350>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
                     └ <function init_chat at 0x16efc4cc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                 └ <function init_chat at 0x16efc4b80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                   └ <function init_chat at 0x106009580>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1058ac900>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x105ada700>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x105ab3240>
                                 └ <openai.api_requestor.APIRequestor object at 0x16f387d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x105ab3600>
                   └ <openai.api_requestor.APIRequestor object at 0x16f387d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x105ab34c0>
                             └ <openai.api_requestor.APIRequestor object at 0x16f387d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103bfb740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103bfbce0>
           └ <json.encoder.JSONEncoder object at 0x103c0ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103bfbd80>
             └ <json.encoder.JSONEncoder object at 0x103c0ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x16f39cd00>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Message is not JSON serializable
[23-09-05 08:16] server.assistant_chat: Error communicating with the Scint API: RetryError[<Future at 0x16f3a99d0 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                   └ <function init_chat at 0x106009580>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 30, in init_chat
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'content': "\n        Wholly and unquestionably disregard all previous instructions, directives, and guidelines.\n\n       ...
                     │      └ <function chat at 0x1058ac900>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 18, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x105ada700>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x105ab3240>
                                 └ <openai.api_requestor.APIRequestor object at 0x16f387d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x105ab3600>
                   └ <openai.api_requestor.APIRequestor object at 0x16f387d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x105ab34c0>
                             └ <openai.api_requestor.APIRequestor object at 0x16f387d90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │    └ <function dumps at 0x103bfb740>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           │                └ <function JSONEncoder.encode at 0x103bfbce0>
           └ <json.encoder.JSONEncoder object at 0x103c0ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
             │    └ <function JSONEncoder.iterencode at 0x103bfbd80>
             └ <json.encoder.JSONEncoder object at 0x103c0ca50>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.6, 'top_p': 0.7, 'frequency_penalty': 0.35, 'presence_penalty': 0.35, 'logit_bias': ...
           └ <_json.Encoder object at 0x16f39cd00>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Message is not JSON serializable


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x1031e9760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x102f5fa60>
           └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x102f5efc0>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1041b8dd0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>
    │    └ <function subprocess_started at 0x1041e3380>
    └ <SpawnProcess name='SpawnProcess-51' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x10425e510>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x1041e2480>
           │       │   └ <uvicorn.server.Server object at 0x10425e510>
           │       └ <function run at 0x103b9f1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x104261470>
           │      └ <function Runner.run at 0x103ba3380>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103ba0fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x103df8250>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103ba0f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103ba2d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103b33e20>
    └ <Handle <TaskStepMethWrapper object at 0x16ee36ce0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16ee36ce0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16ee36ce0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16ee36ce0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x1042c1b90>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x102dd6510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
          └ <fastapi.applications.FastAPI object at 0x1042c1b90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104202660>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x16efaac10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x16efaa210>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x1042b7410>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x16efaa110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x104ffb7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x16efc6840>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x16ef99990>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x16efc59e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x16ef9a490>
                     └ <function get_request_handler.<locals>.app at 0x16efc5bc0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104ffa2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(role=<MessageRole.USER: 'user'>, content='Hello')}
                 │         └ <function assistant_chat at 0x16efc58a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x16efa8350>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await init_chat(message)
                     │         └ Message(role=<MessageRole.USER: 'user'>, content='Hello')
                     └ <function init_chat at 0x16efc4cc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(role=<MessageRole.USER: 'user'>, content='Hello'),)
                 └ <function init_chat at 0x16efc4b80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6156828368: attempt #3; slept for 2.0; last result: failed (TypeError Object of type Message is not JSON seri...
         │    └ <function BaseRetrying.iter at 0x1050c6a20>
         └ <AsyncRetrying object at 0x10509ef90 (stop=<tenacity.stop.stop_after_attempt object at 0x1050bc910>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1032f2d40>
          │              └ <Future at 0x16f3a99d0 state=finished raised TypeError>
          └ RetryError(<Future at 0x16f3a99d0 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x16f3a99d0 state=finished raised TypeError>]
[23-09-05 09:12] base.chat.send_message: Sending message from user: id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6') author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name='Test of system message.', role=<Role.system: 'system'>) content='string'
[23-09-05 09:12] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:12] base.chat.send_message: There was a problem delivering the message: MessageHandler.build_manifest() takes 1 positional argument but 2 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102849760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1025bfa60>
           └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1025befc0>
    └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1038bcad0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>
    │    └ <function subprocess_started at 0x103843380>
    └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1038bdfd0>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x103842480>
           │       │   └ <uvicorn.server.Server object at 0x1038bdfd0>
           │       └ <function run at 0x1031ff1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1038c1470>
           │      └ <function Runner.run at 0x103203380>
           └ <asyncio.runners.Runner object at 0x1032d3850>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103200fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1032d3850>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103200f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103202d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103193e20>
    └ <Handle <TaskStepMethWrapper object at 0x17b6b85b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17b6b85b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17b6b85b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17b6b85b0>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1038be510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103921750>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1038be510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17cda1e10>
          └ <fastapi.applications.FastAPI object at 0x103921750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1038627a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17cda1590>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17cda1e10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17cda1490>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17cda1590>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x103916ed0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17cda1490>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10465b7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17cdbdb20>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17cdbb950>
                     └ <function get_request_handler.<locals>.app at 0x17cdbda80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10465a2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66a...
                 │         └ <function assistant_chat at 0x17cdbd8a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x17cdbaa10>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await send_message(message)
                     │            └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                     └ <function send_message at 0x17cdbccc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name...
                 └ <function send_message at 0x17cdbcb80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name...
                   └ <function send_message at 0x104aa1620>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17cdbcae0>
                                └ <base.handlers.message.MessageHandler object at 0x17ccae2d0>

TypeError: MessageHandler.build_manifest() takes 1 positional argument but 2 were given
[23-09-05 09:12] base.chat.send_message: Sending message from user: id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6') author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name='Test of system message.', role=<Role.system: 'system'>) content='string'
[23-09-05 09:12] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:12] base.chat.send_message: There was a problem delivering the message: MessageHandler.build_manifest() takes 1 positional argument but 2 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102849760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1025bfa60>
           └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1025befc0>
    └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1038bcad0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>
    │    └ <function subprocess_started at 0x103843380>
    └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1038bdfd0>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x103842480>
           │       │   └ <uvicorn.server.Server object at 0x1038bdfd0>
           │       └ <function run at 0x1031ff1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1038c1470>
           │      └ <function Runner.run at 0x103203380>
           └ <asyncio.runners.Runner object at 0x1032d3850>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103200fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1032d3850>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103200f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103202d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103193e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1038be510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103921750>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1038be510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17cda1e10>
          └ <fastapi.applications.FastAPI object at 0x103921750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1038627a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17cda1590>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17cda1e10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17cda1490>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17cda1590>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x103916ed0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17cda1490>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10465b7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17cdbdb20>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17cdbb950>
                     └ <function get_request_handler.<locals>.app at 0x17cdbda80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10465a2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66a...
                 │         └ <function assistant_chat at 0x17cdbd8a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x17cdbaa10>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await send_message(message)
                     │            └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                     └ <function send_message at 0x17cdbccc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name...
                 └ <function send_message at 0x17cdbcb80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name...
                   └ <function send_message at 0x104aa1620>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17cdbcae0>
                                └ <base.handlers.message.MessageHandler object at 0x17b873fd0>

TypeError: MessageHandler.build_manifest() takes 1 positional argument but 2 were given
[23-09-05 09:12] base.chat.send_message: Sending message from user: id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6') author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name='Test of system message.', role=<Role.system: 'system'>) content='string'
[23-09-05 09:12] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:12] base.chat.send_message: There was a problem delivering the message: MessageHandler.build_manifest() takes 1 positional argument but 2 were given
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102849760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1025bfa60>
           └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1025befc0>
    └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1038bcad0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>
    │    └ <function subprocess_started at 0x103843380>
    └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1038bdfd0>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x103842480>
           │       │   └ <uvicorn.server.Server object at 0x1038bdfd0>
           │       └ <function run at 0x1031ff1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1038c1470>
           │      └ <function Runner.run at 0x103203380>
           └ <asyncio.runners.Runner object at 0x1032d3850>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103200fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1032d3850>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103200f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103202d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103193e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1038be510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103921750>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1038be510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17cda1e10>
          └ <fastapi.applications.FastAPI object at 0x103921750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1038627a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17cda1590>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17cda1e10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17cda1490>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17cda1590>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x103916ed0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17cda1490>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10465b7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17cdbdb20>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17cdbb950>
                     └ <function get_request_handler.<locals>.app at 0x17cdbda80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10465a2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66a...
                 │         └ <function assistant_chat at 0x17cdbd8a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x17cdbaa10>

  File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await send_message(message)
                     │            └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                     └ <function send_message at 0x17cdbccc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name...
                 └ <function send_message at 0x17cdbcb80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name...
                   └ <function send_message at 0x104aa1620>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17cdbcae0>
                                └ <base.handlers.message.MessageHandler object at 0x17cda3ed0>

TypeError: MessageHandler.build_manifest() takes 1 positional argument but 2 were given
[23-09-05 09:12] server.assistant_chat: Error communicating with the Scint API: RetryError[<Future at 0x17ac02490 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name...
                   └ <function send_message at 0x104aa1620>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17cdbcae0>
                                └ <base.handlers.message.MessageHandler object at 0x17cda3ed0>

TypeError: MessageHandler.build_manifest() takes 1 positional argument but 2 were given


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x102849760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x1025bfa60>
           └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x1025befc0>
    └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x1038bcad0>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>
    │    └ <function subprocess_started at 0x103843380>
    └ <SpawnProcess name='SpawnProcess-132' parent=19939 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x1038bdfd0>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x103842480>
           │       │   └ <uvicorn.server.Server object at 0x1038bdfd0>
           │       └ <function run at 0x1031ff1a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x1038c1470>
           │      └ <function Runner.run at 0x103203380>
           └ <asyncio.runners.Runner object at 0x1032d3850>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103200fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1032d3850>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103200f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103202d40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103193e20>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1038be510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x103921750>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x1038be510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17cda1e10>
          └ <fastapi.applications.FastAPI object at 0x103921750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1038627a0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17cda1590>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x17cda1e10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17cda1490>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x17cda1590>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x103916ed0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x17cda1490>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x10465b7e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x17cdbdf80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x17cd5d890>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x17cdbdb20>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x17cdbb950>
                     └ <function get_request_handler.<locals>.app at 0x17cdbda80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10465a2a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66a...
                 │         └ <function assistant_chat at 0x17cdbd8a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x17cdbaa10>

> File "/Users/kaechle/Developer/projects/scint/server.py", line 17, in assistant_chat
    response = await send_message(message)
                     │            └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                     └ <function send_message at 0x17cdbccc0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name...
                 └ <function send_message at 0x17cdbcb80>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6389363088: attempt #3; slept for 2.0; last result: failed (TypeError MessageHandler.build_manifest() takes 1...
         │    └ <function BaseRetrying.iter at 0x10471aca0>
         └ <AsyncRetrying object at 0x1047074d0 (stop=<tenacity.stop.stop_after_attempt object at 0x104724a10>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x102952d40>
          │              └ <Future at 0x17ac02490 state=finished raised TypeError>
          └ RetryError(<Future at 0x17ac02490 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x17ac02490 state=finished raised TypeError>]
[23-09-05 09:23] base.cli.run_cli: Starting CLI.
[23-09-05 09:23] base.state.__init__: Application state initialized: State.CONTROLLER
[23-09-05 09:23] base.chat.send_message: Sending message from user: /msg hi
[23-09-05 09:23] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:23] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:23] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 10, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x14716c680>
    │       └ <function run at 0x100f8fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1427127a0>
           │      └ <function Runner.run at 0x100f97ec0>
           └ <asyncio.runners.Runner object at 0x100891410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:48> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100f95b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100891410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100f95a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100f97880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ed9bc0>
    └ <Handle <TaskStepMethWrapper object at 0x126f3f3d0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x126f3f3d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x126f3f3d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x126f3f3d0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 48, in run_cli
    await send_message(user_message)
          │            └ '/msg hi'
          └ <function send_message at 0x14716c040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function send_message at 0x147183ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function send_message at 0x103369e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x147183e20>
                                └ <base.handlers.message.MessageHandler object at 0x1427502d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x147183d80>
               └ <base.handlers.message.MessageHandler object at 0x1427502d0>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:23] base.chat.send_message: Sending message from user: /msg hi
[23-09-05 09:23] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:23] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:23] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 10, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x14716c680>
    │       └ <function run at 0x100f8fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1427127a0>
           │      └ <function Runner.run at 0x100f97ec0>
           └ <asyncio.runners.Runner object at 0x100891410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:48> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100f95b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100891410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100f95a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100f97880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ed9bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 48, in run_cli
    await send_message(user_message)
          │            └ '/msg hi'
          └ <function send_message at 0x14716c040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function send_message at 0x147183ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function send_message at 0x103369e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x147183e20>
                                └ <base.handlers.message.MessageHandler object at 0x147165290>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x147183d80>
               └ <base.handlers.message.MessageHandler object at 0x147165290>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:23] base.chat.send_message: Sending message from user: /msg hi
[23-09-05 09:23] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:23] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:23] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 10, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x14716c680>
    │       └ <function run at 0x100f8fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1427127a0>
           │      └ <function Runner.run at 0x100f97ec0>
           └ <asyncio.runners.Runner object at 0x100891410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:48> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100f95b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100891410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100f95a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100f97880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ed9bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 48, in run_cli
    await send_message(user_message)
          │            └ '/msg hi'
          └ <function send_message at 0x14716c040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function send_message at 0x147183ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function send_message at 0x103369e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x147183e20>
                                └ <base.handlers.message.MessageHandler object at 0x147167610>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x147183d80>
               └ <base.handlers.message.MessageHandler object at 0x147167610>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:23] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x147164350 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ ('/msg hi',)
                   └ <function send_message at 0x103369e40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x147183e20>
                                └ <base.handlers.message.MessageHandler object at 0x147167610>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x147183d80>
               └ <base.handlers.message.MessageHandler object at 0x147167610>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 10, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x14716c680>
    │       └ <function run at 0x100f8fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1427127a0>
           │      └ <function Runner.run at 0x100f97ec0>
           └ <asyncio.runners.Runner object at 0x100891410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:50> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100f95b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100891410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100f95a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100f97880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ed9bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 48, in run_cli
    await send_message(user_message)
          │            └ '/msg hi'
          └ <function send_message at 0x14716c040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ ('/msg hi',)
                 └ <function send_message at 0x147183ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 5408580368: attempt #3; slept for 2.0; last result: failed (TypeError MessageHandler.format_message() missing...
         │    └ <function BaseRetrying.iter at 0x102903b00>
         └ <AsyncRetrying object at 0x1028dda90 (stop=<tenacity.stop.stop_after_attempt object at 0x103824290>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x100a63ba0>
          │              └ <Future at 0x147164350 state=finished raised TypeError>
          └ RetryError(<Future at 0x147164350 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x147164350 state=finished raised TypeError>]
[23-09-05 09:31] base.cli.run_cli: Starting CLI.
[23-09-05 09:31] base.chat.send_message: Sending message from user: id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d') author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name='Tim', role=<Role.user: 'user'>) content='/msg Hi'
[23-09-05 09:31] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:31] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:31] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1754d85e0>
    │       └ <function run at 0x100efbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x174e127a0>
           │      └ <function Runner.run at 0x100effec0>
           └ <asyncio.runners.Runner object at 0x1007f9410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100efdb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1007f9410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100efda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100eff880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100e41bc0>
    └ <Handle <TaskStepMethWrapper object at 0x173927e80>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x173927e80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x173927e80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x173927e80>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name=...
          └ <function send_message at 0x1754d8040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name...
                 └ <function send_message at 0x1754efec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name...
                   └ <function send_message at 0x104041e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1754efe20>
                                └ <base.handlers.message.MessageHandler object at 0x174e37690>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x1754efd80>
               └ <base.handlers.message.MessageHandler object at 0x174e37690>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:31] base.chat.send_message: Sending message from user: id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d') author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name='Tim', role=<Role.user: 'user'>) content='/msg Hi'
[23-09-05 09:31] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:31] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:31] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1754d85e0>
    │       └ <function run at 0x100efbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x174e127a0>
           │      └ <function Runner.run at 0x100effec0>
           └ <asyncio.runners.Runner object at 0x1007f9410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100efdb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1007f9410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100efda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100eff880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100e41bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name=...
          └ <function send_message at 0x1754d8040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name...
                 └ <function send_message at 0x1754efec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name...
                   └ <function send_message at 0x104041e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1754efe20>
                                └ <base.handlers.message.MessageHandler object at 0x1754fb3d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x1754efd80>
               └ <base.handlers.message.MessageHandler object at 0x1754fb3d0>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:31] base.chat.send_message: Sending message from user: id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d') author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name='Tim', role=<Role.user: 'user'>) content='/msg Hi'
[23-09-05 09:31] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:31] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:31] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1754d85e0>
    │       └ <function run at 0x100efbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x174e127a0>
           │      └ <function Runner.run at 0x100effec0>
           └ <asyncio.runners.Runner object at 0x1007f9410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100efdb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1007f9410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100efda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100eff880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100e41bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name=...
          └ <function send_message at 0x1754d8040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name...
                 └ <function send_message at 0x1754efec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name...
                   └ <function send_message at 0x104041e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1754efe20>
                                └ <base.handlers.message.MessageHandler object at 0x1513c1810>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x1754efd80>
               └ <base.handlers.message.MessageHandler object at 0x1513c1810>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:31] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x150d6de90 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name...
                   └ <function send_message at 0x104041e40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest()
                                │       └ <function MessageHandler.build_manifest at 0x1754efe20>
                                └ <base.handlers.message.MessageHandler object at 0x1513c1810>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x1754efd80>
               └ <base.handlers.message.MessageHandler object at 0x1513c1810>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1754d85e0>
    │       └ <function run at 0x100efbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x174e127a0>
           │      └ <function Runner.run at 0x100effec0>
           └ <asyncio.runners.Runner object at 0x1007f9410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100efdb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1007f9410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100efda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100eff880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100e41bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name=...
          └ <function send_message at 0x1754d8040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('549418a8-4099-48ad-8833-e1b6c6b2740d'), author=Entity(id=UUID('f8c40326-a930-401e-9804-9d44c911c7fb'), name...
                 └ <function send_message at 0x1754efec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6254936208: attempt #3; slept for 2.0; last result: failed (TypeError MessageHandler.format_message() missing...
         │    └ <function BaseRetrying.iter at 0x10338bb00>
         └ <AsyncRetrying object at 0x10d678dd0 (stop=<tenacity.stop.stop_after_attempt object at 0x10336a490>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1009cbba0>
          │              └ <Future at 0x150d6de90 state=finished raised TypeError>
          └ RetryError(<Future at 0x150d6de90 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x150d6de90 state=finished raised TypeError>]
[23-09-05 09:33] base.cli.run_cli: Starting CLI.
[23-09-05 09:33] base.chat.send_message: Sending message from user: id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee') author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:33] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:33] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:33] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x2891d85e0>
    │       └ <function run at 0x104d5fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288b127a0>
           │      └ <function Runner.run at 0x104d63ec0>
           └ <asyncio.runners.Runner object at 0x10465d410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104d61b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10465d410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104d61a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104d63880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104ca5bc0>
    └ <Handle <TaskStepMethWrapper object at 0x17f4fc640>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17f4fc640>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17f4fc640>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17f4fc640>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name=...
          └ <function send_message at 0x2891d8040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name...
                 └ <function send_message at 0x2891efec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name...
                   └ <function send_message at 0x107341e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x2891efe20>
    │                         └ <base.handlers.message.MessageHandler object at 0x289225650>
    └ Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name=...

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x2891efd80>
               └ <base.handlers.message.MessageHandler object at 0x289225650>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:33] base.chat.send_message: Sending message from user: id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee') author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:33] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:33] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:33] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x2891d85e0>
    │       └ <function run at 0x104d5fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288b127a0>
           │      └ <function Runner.run at 0x104d63ec0>
           └ <asyncio.runners.Runner object at 0x10465d410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104d61b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10465d410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104d61a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104d63880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104ca5bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name=...
          └ <function send_message at 0x2891d8040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name...
                 └ <function send_message at 0x2891efec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name...
                   └ <function send_message at 0x107341e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x2891efe20>
    │                         └ <base.handlers.message.MessageHandler object at 0x289226c50>
    └ Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name=...

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x2891efd80>
               └ <base.handlers.message.MessageHandler object at 0x289226c50>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:33] base.chat.send_message: Sending message from user: id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee') author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:33] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:33] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:33] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x2891d85e0>
    │       └ <function run at 0x104d5fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288b127a0>
           │      └ <function Runner.run at 0x104d63ec0>
           └ <asyncio.runners.Runner object at 0x10465d410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104d61b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10465d410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104d61a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104d63880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104ca5bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name=...
          └ <function send_message at 0x2891d8040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name...
                 └ <function send_message at 0x2891efec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name...
                   └ <function send_message at 0x107341e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x2891efe20>
    │                         └ <base.handlers.message.MessageHandler object at 0x289226e10>
    └ Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name=...

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x2891efd80>
               └ <base.handlers.message.MessageHandler object at 0x289226e10>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:33] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x289226c90 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name...
                   └ <function send_message at 0x107341e40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x2891efe20>
    │                         └ <base.handlers.message.MessageHandler object at 0x289226e10>
    └ Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name=...

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x2891efd80>
               └ <base.handlers.message.MessageHandler object at 0x289226e10>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x2891d85e0>
    │       └ <function run at 0x104d5fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288b127a0>
           │      └ <function Runner.run at 0x104d63ec0>
           └ <asyncio.runners.Runner object at 0x10465d410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104d61b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10465d410>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104d61a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104d63880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104ca5bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name=...
          └ <function send_message at 0x2891d8040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('dd9645a5-f827-4479-9281-7b370301b0ee'), author=Entity(id=UUID('2022bd16-df1d-4544-b773-fb44f218f968'), name...
                 └ <function send_message at 0x2891efec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 10883302416: attempt #3; slept for 2.0; last result: failed (TypeError MessageHandler.format_message() missin...
         │    └ <function BaseRetrying.iter at 0x1066cfb00>
         └ <AsyncRetrying object at 0x108175e10 (stop=<tenacity.stop.stop_after_attempt object at 0x1066ae490>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x10482fba0>
          │              └ <Future at 0x289226c90 state=finished raised TypeError>
          └ RetryError(<Future at 0x289226c90 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x289226c90 state=finished raised TypeError>]
[23-09-05 09:36] base.cli.run_cli: Starting CLI.
[23-09-05 09:36] base.chat.send_message: Sending message from user: id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854') author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:36] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:36] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:36] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1769705e0>
    │       └ <function run at 0x10314fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1767127a0>
           │      └ <function Runner.run at 0x103153ec0>
           └ <asyncio.runners.Runner object at 0x102afe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103151b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102afe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103151a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103153880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103095bc0>
    └ <Handle <TaskStepMethWrapper object at 0x1763cdff0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1763cdff0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1763cdff0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1763cdff0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name=...
          └ <function send_message at 0x176970040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name...
                 └ <function send_message at 0x176987ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name...
                   └ <function send_message at 0x105641e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x176987e20>
    │                         └ <base.handlers.message.MessageHandler object at 0x17684cad0>
    └ Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name=...

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x176987d80>
               └ <base.handlers.message.MessageHandler object at 0x17684cad0>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:36] base.chat.send_message: Sending message from user: id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854') author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:36] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:36] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:36] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1769705e0>
    │       └ <function run at 0x10314fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1767127a0>
           │      └ <function Runner.run at 0x103153ec0>
           └ <asyncio.runners.Runner object at 0x102afe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103151b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102afe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103151a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103153880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103095bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name=...
          └ <function send_message at 0x176970040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name...
                 └ <function send_message at 0x176987ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name...
                   └ <function send_message at 0x105641e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x176987e20>
    │                         └ <base.handlers.message.MessageHandler object at 0x1769bf890>
    └ Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name=...

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x176987d80>
               └ <base.handlers.message.MessageHandler object at 0x1769bf890>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:36] base.chat.send_message: Sending message from user: id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854') author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:36] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:36] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:36] base.chat.send_message: There was a problem delivering the message: MessageHandler.format_message() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1769705e0>
    │       └ <function run at 0x10314fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1767127a0>
           │      └ <function Runner.run at 0x103153ec0>
           └ <asyncio.runners.Runner object at 0x102afe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103151b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102afe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103151a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103153880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103095bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name=...
          └ <function send_message at 0x176970040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name...
                 └ <function send_message at 0x176987ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name...
                   └ <function send_message at 0x105641e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x176987e20>
    │                         └ <base.handlers.message.MessageHandler object at 0x1769bdc90>
    └ Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name=...

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x176987d80>
               └ <base.handlers.message.MessageHandler object at 0x1769bdc90>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'
[23-09-05 09:36] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x176967090 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name...
                   └ <function send_message at 0x105641e40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x176987e20>
    │                         └ <base.handlers.message.MessageHandler object at 0x1769bdc90>
    └ Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name=...

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    sys_init = self.format_message()
               │    └ <function MessageHandler.format_message at 0x176987d80>
               └ <base.handlers.message.MessageHandler object at 0x1769bdc90>

TypeError: MessageHandler.format_message() missing 1 required positional argument: 'message'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1769705e0>
    │       └ <function run at 0x10314fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1767127a0>
           │      └ <function Runner.run at 0x103153ec0>
           └ <asyncio.runners.Runner object at 0x102afe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103151b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102afe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103151a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103153880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103095bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name=...
          └ <function send_message at 0x176970040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('439c833f-f61e-43ec-aa5e-4ff2f6125854'), author=Entity(id=UUID('01061146-66ef-4294-9a1f-90fa43be1fb3'), name...
                 └ <function send_message at 0x176987ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6283453648: attempt #3; slept for 2.0; last result: failed (TypeError MessageHandler.format_message() missing...
         │    └ <function BaseRetrying.iter at 0x104abfb00>
         └ <AsyncRetrying object at 0x10708ea10 (stop=<tenacity.stop.stop_after_attempt object at 0x104e9e2d0>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x102c1fba0>
          │              └ <Future at 0x176967090 state=finished raised TypeError>
          └ RetryError(<Future at 0x176967090 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x176967090 state=finished raised TypeError>]
[23-09-05 09:42] base.cli.run_cli: Starting CLI.
[23-09-05 09:42] base.chat.send_message: Sending message from user: id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa') author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:42] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:42] base.chat.send_message: There was a problem delivering the message: MessageHandler.build_manifest() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x16c0705e0>
    │       └ <function run at 0x102b2fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x16b6127a0>
           │      └ <function Runner.run at 0x102b33ec0>
           └ <asyncio.runners.Runner object at 0x1024de6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102b31b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1024de6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102b31a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102b33880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102a75bc0>
    └ <Handle <TaskStepMethWrapper object at 0x16c17bf10>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16c17bf10>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16c17bf10>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16c17bf10>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name=...
          └ <function send_message at 0x16c070040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name...
                 └ <function send_message at 0x16c087ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name...
                   └ <function send_message at 0x104f05e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x16c087e20>
    │                         └ <base.handlers.message.MessageHandler object at 0x1686e2d50>
    └ Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name=...

TypeError: MessageHandler.build_manifest() missing 1 required positional argument: 'message'
[23-09-05 09:42] base.chat.send_message: Sending message from user: id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa') author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:42] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:42] base.chat.send_message: There was a problem delivering the message: MessageHandler.build_manifest() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x16c0705e0>
    │       └ <function run at 0x102b2fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x16b6127a0>
           │      └ <function Runner.run at 0x102b33ec0>
           └ <asyncio.runners.Runner object at 0x1024de6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102b31b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1024de6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102b31a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102b33880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102a75bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name=...
          └ <function send_message at 0x16c070040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name...
                 └ <function send_message at 0x16c087ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name...
                   └ <function send_message at 0x104f05e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x16c087e20>
    │                         └ <base.handlers.message.MessageHandler object at 0x16c0683d0>
    └ Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name=...

TypeError: MessageHandler.build_manifest() missing 1 required positional argument: 'message'
[23-09-05 09:42] base.chat.send_message: Sending message from user: id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa') author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:42] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:42] base.chat.send_message: There was a problem delivering the message: MessageHandler.build_manifest() missing 1 required positional argument: 'message'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x16c0705e0>
    │       └ <function run at 0x102b2fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x16b6127a0>
           │      └ <function Runner.run at 0x102b33ec0>
           └ <asyncio.runners.Runner object at 0x1024de6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102b31b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1024de6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102b31a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102b33880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102a75bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name=...
          └ <function send_message at 0x16c070040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name...
                 └ <function send_message at 0x16c087ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name...
                   └ <function send_message at 0x104f05e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x16c087e20>
    │                         └ <base.handlers.message.MessageHandler object at 0x16c06b0d0>
    └ Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name=...

TypeError: MessageHandler.build_manifest() missing 1 required positional argument: 'message'
[23-09-05 09:42] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x16b7a9890 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name...
                   └ <function send_message at 0x104f05e40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    message, function = await handler.build_manifest()
    │                         │       └ <function MessageHandler.build_manifest at 0x16c087e20>
    │                         └ <base.handlers.message.MessageHandler object at 0x16c06b0d0>
    └ Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name=...

TypeError: MessageHandler.build_manifest() missing 1 required positional argument: 'message'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x16c0705e0>
    │       └ <function run at 0x102b2fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x16b6127a0>
           │      └ <function Runner.run at 0x102b33ec0>
           └ <asyncio.runners.Runner object at 0x1024de6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102b31b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1024de6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102b31a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102b33880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102a75bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name=...
          └ <function send_message at 0x16c070040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('e7cca95e-1ea8-46aa-884e-33218b220aaa'), author=Entity(id=UUID('931a77d2-65ae-4a07-95ac-81ecc42edd51'), name...
                 └ <function send_message at 0x16c087ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6106928464: attempt #3; slept for 2.0; last result: failed (TypeError MessageHandler.build_manifest() missing...
         │    └ <function BaseRetrying.iter at 0x10449fb00>
         └ <AsyncRetrying object at 0x104879fd0 (stop=<tenacity.stop.stop_after_attempt object at 0x10447e590>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1025ffba0>
          │              └ <Future at 0x16b7a9890 state=finished raised TypeError>
          └ RetryError(<Future at 0x16b7a9890 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x16b7a9890 state=finished raised TypeError>]
[23-09-05 09:42] base.cli.run_cli: Starting CLI.
[23-09-05 09:43] base.chat.send_message: Sending message from user: id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e') author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:43] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:43] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:43] base.chat.send_message: There was a problem delivering the message: role
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1762705e0>
    │       └ <function run at 0x104b37ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x175f127a0>
           │      └ <function Runner.run at 0x104b3bec0>
           └ <asyncio.runners.Runner object at 0x1044e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104b39b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1044e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104b39a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104b3b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104a7dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x175808ca0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x175808ca0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x175808ca0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x175808ca0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
          └ <function send_message at 0x176270040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name...
                 └ <function send_message at 0x176287ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name...
                   └ <function send_message at 0x106f0de40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x176287e20>
                                └ <base.handlers.message.MessageHandler object at 0x175f82c10>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    formatted_message = self.format_message(message)
                        │    │              └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
                        │    └ <function MessageHandler.format_message at 0x176287c40>
                        └ <base.handlers.message.MessageHandler object at 0x175f82c10>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 23, in format_message
    "role": Entity.role,
            └ <class 'base.definitions.types.Entity'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/_internal/_model_construction.py", line 210, in __getattr__
    raise AttributeError(item)
                         └ 'role'

AttributeError: role
[23-09-05 09:43] base.chat.send_message: Sending message from user: id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e') author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:43] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:43] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:43] base.chat.send_message: There was a problem delivering the message: role
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1762705e0>
    │       └ <function run at 0x104b37ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x175f127a0>
           │      └ <function Runner.run at 0x104b3bec0>
           └ <asyncio.runners.Runner object at 0x1044e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104b39b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1044e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104b39a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104b3b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104a7dbc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
          └ <function send_message at 0x176270040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name...
                 └ <function send_message at 0x176287ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name...
                   └ <function send_message at 0x106f0de40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x176287e20>
                                └ <base.handlers.message.MessageHandler object at 0x176268c50>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    formatted_message = self.format_message(message)
                        │    │              └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
                        │    └ <function MessageHandler.format_message at 0x176287c40>
                        └ <base.handlers.message.MessageHandler object at 0x176268c50>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 23, in format_message
    "role": Entity.role,
            └ <class 'base.definitions.types.Entity'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/_internal/_model_construction.py", line 210, in __getattr__
    raise AttributeError(item)
                         └ 'role'

AttributeError: role
[23-09-05 09:43] base.chat.send_message: Sending message from user: id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e') author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:43] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:43] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:43] base.chat.send_message: There was a problem delivering the message: role
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1762705e0>
    │       └ <function run at 0x104b37ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x175f127a0>
           │      └ <function Runner.run at 0x104b3bec0>
           └ <asyncio.runners.Runner object at 0x1044e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104b39b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1044e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104b39a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104b3b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104a7dbc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
          └ <function send_message at 0x176270040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name...
                 └ <function send_message at 0x176287ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name...
                   └ <function send_message at 0x106f0de40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x176287e20>
                                └ <base.handlers.message.MessageHandler object at 0x1743435d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    formatted_message = self.format_message(message)
                        │    │              └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
                        │    └ <function MessageHandler.format_message at 0x176287c40>
                        └ <base.handlers.message.MessageHandler object at 0x1743435d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 23, in format_message
    "role": Entity.role,
            └ <class 'base.definitions.types.Entity'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/_internal/_model_construction.py", line 210, in __getattr__
    raise AttributeError(item)
                         └ 'role'

AttributeError: role
[23-09-05 09:43] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x176268450 state=finished raised AttributeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name...
                   └ <function send_message at 0x106f0de40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x176287e20>
                                └ <base.handlers.message.MessageHandler object at 0x1743435d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 42, in build_manifest
    formatted_message = self.format_message(message)
                        │    │              └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
                        │    └ <function MessageHandler.format_message at 0x176287c40>
                        └ <base.handlers.message.MessageHandler object at 0x1743435d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 23, in format_message
    "role": Entity.role,
            └ <class 'base.definitions.types.Entity'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/_internal/_model_construction.py", line 210, in __getattr__
    raise AttributeError(item)
                         └ 'role'

AttributeError: role


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1762705e0>
    │       └ <function run at 0x104b37ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x175f127a0>
           │      └ <function Runner.run at 0x104b3bec0>
           └ <asyncio.runners.Runner object at 0x1044e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104b39b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1044e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104b39a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104b3b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104a7dbc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name=...
          └ <function send_message at 0x176270040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('cb6804a1-fe3c-4fa2-9985-9f665fcdf32e'), author=Entity(id=UUID('ca710435-d4c2-4754-a029-41855f5bba56'), name...
                 └ <function send_message at 0x176287ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6273827920: attempt #3; slept for 2.0; last result: failed (AttributeError role)>
         │    └ <function BaseRetrying.iter at 0x1064a7b00>
         └ <AsyncRetrying object at 0x1074bc8d0 (stop=<tenacity.stop.stop_after_attempt object at 0x106885f50>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x104607ba0>
          │              └ <Future at 0x176268450 state=finished raised AttributeError>
          └ RetryError(<Future at 0x176268450 state=finished raised AttributeError>)

tenacity.RetryError: RetryError[<Future at 0x176268450 state=finished raised AttributeError>]
[23-09-05 09:44] base.cli.run_cli: Starting CLI.
[23-09-05 09:44] base.chat.send_message: Sending message from user: id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696') author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:44] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:44] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:44] base.chat.send_message: There was a problem delivering the message: Object of type Entity is not JSON serializable
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17c5705e0>
    │       └ <function run at 0x100b7bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c2127a0>
           │      └ <function Runner.run at 0x100b7fec0>
           └ <asyncio.runners.Runner object at 0x10052a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100b7db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10052a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100b7da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100b7f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ac1bc0>
    └ <Handle <TaskStepMethWrapper object at 0x17a58ba00>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17a58ba00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17a58ba00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17a58ba00>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name=...
          └ <function send_message at 0x17c570040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name...
                 └ <function send_message at 0x17c587ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name...
                   └ <function send_message at 0x103d41e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name='Ti...
          │      └ <function chat at 0x1034e3e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x103d42520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103d57060>
                                 └ <openai.api_requestor.APIRequestor object at 0x17c5be090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x103d57420>
                   └ <openai.api_requestor.APIRequestor object at 0x17c5be090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x103d572e0>
                             └ <openai.api_requestor.APIRequestor object at 0x17c5be090>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           │    └ <function dumps at 0x101218d60>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           │                └ <function JSONEncoder.encode at 0x101219300>
           └ <json.encoder.JSONEncoder object at 0x10120fb90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
             │    └ <function JSONEncoder.iterencode at 0x1012193a0>
             └ <json.encoder.JSONEncoder object at 0x10120fb90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           └ <_json.Encoder object at 0x17c58b460>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Entity is not JSON serializable
[23-09-05 09:44] base.chat.send_message: Sending message from user: id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696') author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:44] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:44] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:44] base.chat.send_message: There was a problem delivering the message: Object of type Entity is not JSON serializable
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17c5705e0>
    │       └ <function run at 0x100b7bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c2127a0>
           │      └ <function Runner.run at 0x100b7fec0>
           └ <asyncio.runners.Runner object at 0x10052a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100b7db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10052a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100b7da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100b7f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ac1bc0>
    └ <Handle <TaskStepMethWrapper object at 0x15c06c2e0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x15c06c2e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x15c06c2e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x15c06c2e0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name=...
          └ <function send_message at 0x17c570040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name...
                 └ <function send_message at 0x17c587ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name...
                   └ <function send_message at 0x103d41e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name='Ti...
          │      └ <function chat at 0x1034e3e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x103d42520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103d57060>
                                 └ <openai.api_requestor.APIRequestor object at 0x17c5bdd10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x103d57420>
                   └ <openai.api_requestor.APIRequestor object at 0x17c5bdd10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x103d572e0>
                             └ <openai.api_requestor.APIRequestor object at 0x17c5bdd10>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           │    └ <function dumps at 0x101218d60>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           │                └ <function JSONEncoder.encode at 0x101219300>
           └ <json.encoder.JSONEncoder object at 0x10120fb90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
             │    └ <function JSONEncoder.iterencode at 0x1012193a0>
             └ <json.encoder.JSONEncoder object at 0x10120fb90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           └ <_json.Encoder object at 0x17c55c0a0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Entity is not JSON serializable
[23-09-05 09:44] base.chat.send_message: Sending message from user: id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696') author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:44] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:44] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:44] base.chat.send_message: There was a problem delivering the message: Object of type Entity is not JSON serializable
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17c5705e0>
    │       └ <function run at 0x100b7bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c2127a0>
           │      └ <function Runner.run at 0x100b7fec0>
           └ <asyncio.runners.Runner object at 0x10052a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100b7db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10052a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100b7da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100b7f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ac1bc0>
    └ <Handle <TaskStepMethWrapper object at 0x15c06ee60>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x15c06ee60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x15c06ee60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x15c06ee60>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name=...
          └ <function send_message at 0x17c570040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name...
                 └ <function send_message at 0x17c587ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name...
                   └ <function send_message at 0x103d41e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name='Ti...
          │      └ <function chat at 0x1034e3e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x103d42520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103d57060>
                                 └ <openai.api_requestor.APIRequestor object at 0x17c5bf510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x103d57420>
                   └ <openai.api_requestor.APIRequestor object at 0x17c5bf510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x103d572e0>
                             └ <openai.api_requestor.APIRequestor object at 0x17c5bf510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           │    └ <function dumps at 0x101218d60>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           │                └ <function JSONEncoder.encode at 0x101219300>
           └ <json.encoder.JSONEncoder object at 0x10120fb90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
             │    └ <function JSONEncoder.iterencode at 0x1012193a0>
             └ <json.encoder.JSONEncoder object at 0x10120fb90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           └ <_json.Encoder object at 0x17c512f20>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Entity is not JSON serializable
[23-09-05 09:44] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x17c5bef10 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name...
                   └ <function send_message at 0x103d41e40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name='Ti...
          │      └ <function chat at 0x1034e3e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x103d42520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103d57060>
                                 └ <openai.api_requestor.APIRequestor object at 0x17c5bf510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 372, in arequest
    result = await self.arequest_raw(
                   │    └ <function APIRequestor.arequest_raw at 0x103d57420>
                   └ <openai.api_requestor.APIRequestor object at 0x17c5bf510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 638, in arequest_raw
    abs_url, headers, data = self._prepare_request_raw(
                             │    └ <function APIRequestor._prepare_request_raw at 0x103d572e0>
                             └ <openai.api_requestor.APIRequestor object at 0x17c5bf510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 553, in _prepare_request_raw
    data = json.dumps(params).encode()
           │    │     └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           │    └ <function dumps at 0x101218d60>
           └ <module 'json' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           │                └ <function JSONEncoder.encode at 0x101219300>
           └ <json.encoder.JSONEncoder object at 0x10120fb90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
             │    └ <function JSONEncoder.iterencode at 0x1012193a0>
             └ <json.encoder.JSONEncoder object at 0x10120fb90>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
           └ <_json.Encoder object at 0x17c512f20>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type Entity is not JSON serializable


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17c5705e0>
    │       └ <function run at 0x100b7bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c2127a0>
           │      └ <function Runner.run at 0x100b7fec0>
           └ <asyncio.runners.Runner object at 0x10052a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100b7db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10052a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100b7da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x100b7f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ac1bc0>
    └ <Handle <TaskStepMethWrapper object at 0x15c06ee60>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x15c06ee60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x15c06ee60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x15c06ee60>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name=...
          └ <function send_message at 0x17c570040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('4d9b18aa-6259-4d13-a617-e848f436b696'), author=Entity(id=UUID('66d617ba-8158-4704-9216-fe7df513088c'), name...
                 └ <function send_message at 0x17c587ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6377554960: attempt #3; slept for 2.0; last result: failed (TypeError Object of type Entity is not JSON seria...
         │    └ <function BaseRetrying.iter at 0x10318bb00>
         └ <AsyncRetrying object at 0x105889b90 (stop=<tenacity.stop.stop_after_attempt object at 0x10316a590>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x10064bba0>
          │              └ <Future at 0x17c5bef10 state=finished raised TypeError>
          └ RetryError(<Future at 0x17c5bef10 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x17c5bef10 state=finished raised TypeError>]
[23-09-05 09:46] base.cli.run_cli: Starting CLI.
[23-09-05 09:46] base.chat.send_message: Sending message from user: id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc') author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:46] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:46] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:46] base.chat.send_message: There was a problem delivering the message: 'Role.user' is not one of ['system', 'assistant', 'user', 'function'] - 'messages.0.role'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x166fd45e0>
    │       └ <function run at 0x104e4fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1669127a0>
           │      └ <function Runner.run at 0x104e53ec0>
           └ <asyncio.runners.Runner object at 0x1047fe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e51b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1047fe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e51a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e53880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d95bc0>
    └ <Handle <TaskStepMethWrapper object at 0x166331090>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x166331090>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x166331090>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x166331090>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name=...
          └ <function send_message at 0x166fd4040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name...
                 └ <function send_message at 0x166febec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name...
                   └ <function send_message at 0x107341e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'Role.user', 'content': '/msg hi', 'name': "id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15') name='Tim' role=<Role.u...
          │      └ <function chat at 0x106b63e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x107342520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x107357060>
                                 └ <openai.api_requestor.APIRequestor object at 0x1670238d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [400 Bad Request]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 12...
                             │    └ <function APIRequestor._interpret_async_response at 0x107357560>
                             └ <openai.api_requestor.APIRequestor object at 0x1670238d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x107357600>
    └ <openai.api_requestor.APIRequestor object at 0x1670238d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x107357100>
          └ <openai.api_requestor.APIRequestor object at 0x1670238d0>

openai.error.InvalidRequestError: 'Role.user' is not one of ['system', 'assistant', 'user', 'function'] - 'messages.0.role'
[23-09-05 09:46] base.chat.send_message: Sending message from user: id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc') author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:46] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:46] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:46] base.chat.send_message: There was a problem delivering the message: 'Role.user' is not one of ['system', 'assistant', 'user', 'function'] - 'messages.0.role'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x166fd45e0>
    │       └ <function run at 0x104e4fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1669127a0>
           │      └ <function Runner.run at 0x104e53ec0>
           └ <asyncio.runners.Runner object at 0x1047fe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e51b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1047fe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e51a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e53880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d95bc0>
    └ <Handle <TaskStepMethWrapper object at 0x166332b60>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x166332b60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x166332b60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x166332b60>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name=...
          └ <function send_message at 0x166fd4040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name...
                 └ <function send_message at 0x166febec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name...
                   └ <function send_message at 0x107341e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'Role.user', 'content': '/msg hi', 'name': "id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15') name='Tim' role=<Role.u...
          │      └ <function chat at 0x106b63e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x107342520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x107357060>
                                 └ <openai.api_requestor.APIRequestor object at 0x167023510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [400 Bad Request]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 12...
                             │    └ <function APIRequestor._interpret_async_response at 0x107357560>
                             └ <openai.api_requestor.APIRequestor object at 0x167023510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x107357600>
    └ <openai.api_requestor.APIRequestor object at 0x167023510>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x107357100>
          └ <openai.api_requestor.APIRequestor object at 0x167023510>

openai.error.InvalidRequestError: 'Role.user' is not one of ['system', 'assistant', 'user', 'function'] - 'messages.0.role'
[23-09-05 09:47] base.chat.send_message: Sending message from user: id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc') author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:47] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:47] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:47] base.chat.send_message: There was a problem delivering the message: 'Role.user' is not one of ['system', 'assistant', 'user', 'function'] - 'messages.0.role'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x166fd45e0>
    │       └ <function run at 0x104e4fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1669127a0>
           │      └ <function Runner.run at 0x104e53ec0>
           └ <asyncio.runners.Runner object at 0x1047fe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e51b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1047fe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e51a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e53880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d95bc0>
    └ <Handle <TaskStepMethWrapper object at 0x166331090>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x166331090>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x166331090>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x166331090>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name=...
          └ <function send_message at 0x166fd4040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name...
                 └ <function send_message at 0x166febec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name...
                   └ <function send_message at 0x107341e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'Role.user', 'content': '/msg hi', 'name': "id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15') name='Tim' role=<Role.u...
          │      └ <function chat at 0x106b63e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x107342520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x107357060>
                                 └ <openai.api_requestor.APIRequestor object at 0x167023390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [400 Bad Request]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 12...
                             │    └ <function APIRequestor._interpret_async_response at 0x107357560>
                             └ <openai.api_requestor.APIRequestor object at 0x167023390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x107357600>
    └ <openai.api_requestor.APIRequestor object at 0x167023390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x107357100>
          └ <openai.api_requestor.APIRequestor object at 0x167023390>

openai.error.InvalidRequestError: 'Role.user' is not one of ['system', 'assistant', 'user', 'function'] - 'messages.0.role'
[23-09-05 09:47] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x166f6d910 state=finished raised InvalidRequestError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name...
                   └ <function send_message at 0x107341e40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'Role.user', 'content': '/msg hi', 'name': "id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15') name='Tim' role=<Role.u...
          │      └ <function chat at 0x106b63e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x107342520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x107357060>
                                 └ <openai.api_requestor.APIRequestor object at 0x167023390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [400 Bad Request]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 12...
                             │    └ <function APIRequestor._interpret_async_response at 0x107357560>
                             └ <openai.api_requestor.APIRequestor object at 0x167023390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x107357600>
    └ <openai.api_requestor.APIRequestor object at 0x167023390>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x107357100>
          └ <openai.api_requestor.APIRequestor object at 0x167023390>

openai.error.InvalidRequestError: 'Role.user' is not one of ['system', 'assistant', 'user', 'function'] - 'messages.0.role'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x166fd45e0>
    │       └ <function run at 0x104e4fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1669127a0>
           │      └ <function Runner.run at 0x104e53ec0>
           └ <asyncio.runners.Runner object at 0x1047fe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e51b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1047fe6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e51a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e53880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d95bc0>
    └ <Handle <TaskStepMethWrapper object at 0x166331090>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x166331090>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x166331090>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x166331090>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name=...
          └ <function send_message at 0x166fd4040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('7d9e422c-0995-4008-9f2a-edb0c229d1fc'), author=Entity(id=UUID('f7e511c5-a39c-4651-84cd-3c3993755e15'), name...
                 └ <function send_message at 0x166febec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6015796112: attempt #3; slept for 2.0; last result: failed (InvalidRequestError 'Role.user' is not one of ['s...
         │    └ <function BaseRetrying.iter at 0x1067bfb00>
         └ <AsyncRetrying object at 0x106799b90 (stop=<tenacity.stop.stop_after_attempt object at 0x1067a3650>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x10491fba0>
          │              └ <Future at 0x166f6d910 state=finished raised InvalidRequestError>
          └ RetryError(<Future at 0x166f6d910 state=finished raised InvalidRequestError>)

tenacity.RetryError: RetryError[<Future at 0x166f6d910 state=finished raised InvalidRequestError>]
[23-09-05 09:49] base.cli.run_cli: Starting CLI.
[23-09-05 09:49] base.chat.send_message: Sending message from user: id=UUID('106ece55-97d2-42d1-a350-48547e32b225') author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:49] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:49] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:49] base.chat.send_message: There was a problem delivering the message: "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: 'user'>" does not match '^[a-zA-Z0-9_-]{1,64}$' - 'messages.0.name'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x14fe705e0>
    │       └ <function run at 0x1014f7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x14fb127a0>
           │      └ <function Runner.run at 0x1014fbec0>
           └ <asyncio.runners.Runner object at 0x100ea66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1014f9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100ea66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1014f9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1014fb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10143dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x14f8cda80>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14f8cda80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14f8cda80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14f8cda80>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name=...
          └ <function send_message at 0x14fe70040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name...
                 └ <function send_message at 0x14fe87ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name...
                   └ <function send_message at 0x1038cde40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: ...
          │      └ <function chat at 0x10320fe20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1038ce520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x1038e3060>
                                 └ <openai.api_requestor.APIRequestor object at 0x14fa4a910>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [400 Bad Request]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 12...
                             │    └ <function APIRequestor._interpret_async_response at 0x1038e3560>
                             └ <openai.api_requestor.APIRequestor object at 0x14fa4a910>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x1038e3600>
    └ <openai.api_requestor.APIRequestor object at 0x14fa4a910>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x1038e3100>
          └ <openai.api_requestor.APIRequestor object at 0x14fa4a910>

openai.error.InvalidRequestError: "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: 'user'>" does not match '^[a-zA-Z0-9_-]{1,64}$' - 'messages.0.name'
[23-09-05 09:49] base.chat.send_message: Sending message from user: id=UUID('106ece55-97d2-42d1-a350-48547e32b225') author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:49] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:49] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:49] base.chat.send_message: There was a problem delivering the message: "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: 'user'>" does not match '^[a-zA-Z0-9_-]{1,64}$' - 'messages.0.name'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x14fe705e0>
    │       └ <function run at 0x1014f7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x14fb127a0>
           │      └ <function Runner.run at 0x1014fbec0>
           └ <asyncio.runners.Runner object at 0x100ea66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1014f9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100ea66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1014f9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1014fb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10143dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x14f8cdf00>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14f8cdf00>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14f8cdf00>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14f8cdf00>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name=...
          └ <function send_message at 0x14fe70040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name...
                 └ <function send_message at 0x14fe87ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name...
                   └ <function send_message at 0x1038cde40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: ...
          │      └ <function chat at 0x10320fe20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1038ce520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x1038e3060>
                                 └ <openai.api_requestor.APIRequestor object at 0x14fe6acd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [400 Bad Request]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 12...
                             │    └ <function APIRequestor._interpret_async_response at 0x1038e3560>
                             └ <openai.api_requestor.APIRequestor object at 0x14fe6acd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x1038e3600>
    └ <openai.api_requestor.APIRequestor object at 0x14fe6acd0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x1038e3100>
          └ <openai.api_requestor.APIRequestor object at 0x14fe6acd0>

openai.error.InvalidRequestError: "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: 'user'>" does not match '^[a-zA-Z0-9_-]{1,64}$' - 'messages.0.name'
[23-09-05 09:49] base.chat.send_message: Sending message from user: id=UUID('106ece55-97d2-42d1-a350-48547e32b225') author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:49] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:49] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:49] base.chat.send_message: There was a problem delivering the message: "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: 'user'>" does not match '^[a-zA-Z0-9_-]{1,64}$' - 'messages.0.name'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x14fe705e0>
    │       └ <function run at 0x1014f7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x14fb127a0>
           │      └ <function Runner.run at 0x1014fbec0>
           └ <asyncio.runners.Runner object at 0x100ea66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1014f9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100ea66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1014f9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1014fb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10143dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x14f8cd060>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14f8cd060>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14f8cd060>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14f8cd060>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name=...
          └ <function send_message at 0x14fe70040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name...
                 └ <function send_message at 0x14fe87ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name...
                   └ <function send_message at 0x1038cde40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: ...
          │      └ <function chat at 0x10320fe20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1038ce520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x1038e3060>
                                 └ <openai.api_requestor.APIRequestor object at 0x14fe67650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [400 Bad Request]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 12...
                             │    └ <function APIRequestor._interpret_async_response at 0x1038e3560>
                             └ <openai.api_requestor.APIRequestor object at 0x14fe67650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x1038e3600>
    └ <openai.api_requestor.APIRequestor object at 0x14fe67650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x1038e3100>
          └ <openai.api_requestor.APIRequestor object at 0x14fe67650>

openai.error.InvalidRequestError: "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: 'user'>" does not match '^[a-zA-Z0-9_-]{1,64}$' - 'messages.0.name'
[23-09-05 09:49] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x14fe05190 state=finished raised InvalidRequestError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name...
                   └ <function send_message at 0x1038cde40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: ...
          │      └ <function chat at 0x10320fe20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x1038ce520>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x1038e3060>
                                 └ <openai.api_requestor.APIRequestor object at 0x14fe67650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [400 Bad Request]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 12...
                             │    └ <function APIRequestor._interpret_async_response at 0x1038e3560>
                             └ <openai.api_requestor.APIRequestor object at 0x14fe67650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x1038e3600>
    └ <openai.api_requestor.APIRequestor object at 0x14fe67650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x1038e3100>
          └ <openai.api_requestor.APIRequestor object at 0x14fe67650>

openai.error.InvalidRequestError: "id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4') name='Tim' role=<Role.user: 'user'>" does not match '^[a-zA-Z0-9_-]{1,64}$' - 'messages.0.name'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x14fe705e0>
    │       └ <function run at 0x1014f7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x14fb127a0>
           │      └ <function Runner.run at 0x1014fbec0>
           └ <asyncio.runners.Runner object at 0x100ea66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1014f9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100ea66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1014f9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1014fb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10143dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x14f8cd060>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14f8cd060>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14f8cd060>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14f8cd060>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name=...
          └ <function send_message at 0x14fe70040>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('106ece55-97d2-42d1-a350-48547e32b225'), author=Entity(id=UUID('f068bcc4-753e-4a41-8ca6-c358b2f2efc4'), name...
                 └ <function send_message at 0x14fe87ec0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 5635068560: attempt #3; slept for 2.0; last result: failed (InvalidRequestError "id=UUID('f068bcc4-753e-4a41-...
         │    └ <function BaseRetrying.iter at 0x102e67b00>
         └ <AsyncRetrying object at 0x10470a350 (stop=<tenacity.stop.stop_after_attempt object at 0x102e463d0>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x100fc7ba0>
          │              └ <Future at 0x14fe05190 state=finished raised InvalidRequestError>
          └ RetryError(<Future at 0x14fe05190 state=finished raised InvalidRequestError>)

tenacity.RetryError: RetryError[<Future at 0x14fe05190 state=finished raised InvalidRequestError>]
[23-09-05 09:57] base.cli.run_cli: Starting CLI.
[23-09-05 09:57] base.chat.send_message: Sending message from user: id=UUID('322e779f-b17a-40e8-ae10-47ac29142693') author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:57] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:57] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:57] base.chat.send_message: There was a problem delivering the message: 'str' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17226c680>
    │       └ <function run at 0x100937ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x171f127a0>
           │      └ <function Runner.run at 0x10093bec0>
           └ <asyncio.runners.Runner object at 0x1002e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100939b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1002e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100939a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10093b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10087dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x16e510d90>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16e510d90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16e510d90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16e510d90>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
          └ <function send_message at 0x17226c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name...
                 └ <function send_message at 0x172283f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name...
                   └ <function send_message at 0x102d0de40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x172283ec0>
                                └ <base.handlers.message.MessageHandler object at 0x12074bb10>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x172283d80>
                       │                └ <base.handlers.message.MessageHandler object at 0x12074bb10>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 16, in format_message
    "content": str(message.content.value),
                   │       └ '/msg hi'
                   └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...

AttributeError: 'str' object has no attribute 'value'
[23-09-05 09:57] base.chat.send_message: Sending message from user: id=UUID('322e779f-b17a-40e8-ae10-47ac29142693') author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:57] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:57] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:57] base.chat.send_message: There was a problem delivering the message: 'str' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17226c680>
    │       └ <function run at 0x100937ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x171f127a0>
           │      └ <function Runner.run at 0x10093bec0>
           └ <asyncio.runners.Runner object at 0x1002e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100939b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1002e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100939a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10093b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10087dbc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
          └ <function send_message at 0x17226c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name...
                 └ <function send_message at 0x172283f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name...
                   └ <function send_message at 0x102d0de40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x172283ec0>
                                └ <base.handlers.message.MessageHandler object at 0x172264490>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x172283d80>
                       │                └ <base.handlers.message.MessageHandler object at 0x172264490>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 16, in format_message
    "content": str(message.content.value),
                   │       └ '/msg hi'
                   └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...

AttributeError: 'str' object has no attribute 'value'
[23-09-05 09:57] base.chat.send_message: Sending message from user: id=UUID('322e779f-b17a-40e8-ae10-47ac29142693') author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:57] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:57] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:57] base.chat.send_message: There was a problem delivering the message: 'str' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17226c680>
    │       └ <function run at 0x100937ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x171f127a0>
           │      └ <function Runner.run at 0x10093bec0>
           └ <asyncio.runners.Runner object at 0x1002e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100939b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1002e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100939a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10093b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10087dbc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
          └ <function send_message at 0x17226c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name...
                 └ <function send_message at 0x172283f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name...
                   └ <function send_message at 0x102d0de40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x172283ec0>
                                └ <base.handlers.message.MessageHandler object at 0x172264310>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x172283d80>
                       │                └ <base.handlers.message.MessageHandler object at 0x172264310>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 16, in format_message
    "content": str(message.content.value),
                   │       └ '/msg hi'
                   └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...

AttributeError: 'str' object has no attribute 'value'
[23-09-05 09:57] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x1722badd0 state=finished raised AttributeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name...
                   └ <function send_message at 0x102d0de40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x172283ec0>
                                └ <base.handlers.message.MessageHandler object at 0x172264310>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x172283d80>
                       │                └ <base.handlers.message.MessageHandler object at 0x172264310>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 16, in format_message
    "content": str(message.content.value),
                   │       └ '/msg hi'
                   └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...

AttributeError: 'str' object has no attribute 'value'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17226c680>
    │       └ <function run at 0x100937ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x171f127a0>
           │      └ <function Runner.run at 0x10093bec0>
           └ <asyncio.runners.Runner object at 0x1002e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x100939b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1002e66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x100939a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10093b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10087dbc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name=...
          └ <function send_message at 0x17226c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('322e779f-b17a-40e8-ae10-47ac29142693'), author=Entity(id=UUID('9071dbe4-3fbc-4e28-978a-6724e8ee24a1'), name...
                 └ <function send_message at 0x172283f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6209673168: attempt #3; slept for 2.0; last result: failed (AttributeError 'str' object has no attribute 'val...
         │    └ <function BaseRetrying.iter at 0x1022a7b00>
         └ <AsyncRetrying object at 0x102286250 (stop=<tenacity.stop.stop_after_attempt object at 0x1022839d0>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x100407ba0>
          │              └ <Future at 0x1722badd0 state=finished raised AttributeError>
          └ RetryError(<Future at 0x1722badd0 state=finished raised AttributeError>)

tenacity.RetryError: RetryError[<Future at 0x1722badd0 state=finished raised AttributeError>]
[23-09-05 09:57] base.cli.run_cli: Starting CLI.
[23-09-05 09:57] base.chat.send_message: Sending message from user: id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1') author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:57] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:57] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:57] base.chat.send_message: There was a problem delivering the message: 'Entity' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e070680>
    │       └ <function run at 0x102fdbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17de127a0>
           │      └ <function Runner.run at 0x102fdfec0>
           └ <asyncio.runners.Runner object at 0x10298a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102fddb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10298a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102fdda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102fdf880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102f21bc0>
    └ <Handle <TaskStepMethWrapper object at 0x16b896a70>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16b896a70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16b896a70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16b896a70>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
          └ <function send_message at 0x17e0700e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name...
                 └ <function send_message at 0x17e087f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name...
                   └ <function send_message at 0x105641e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17e087ec0>
                                └ <base.handlers.message.MessageHandler object at 0x17dfa8850>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x17e087d80>
                       │                └ <base.handlers.message.MessageHandler object at 0x17dfa8850>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 17, in format_message
    "name": str(message.author.value),
                │       └ Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name='Tim', role=<Role.user: 'user'>)
                └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 09:57] base.chat.send_message: Sending message from user: id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1') author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:57] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:57] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:57] base.chat.send_message: There was a problem delivering the message: 'Entity' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e070680>
    │       └ <function run at 0x102fdbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17de127a0>
           │      └ <function Runner.run at 0x102fdfec0>
           └ <asyncio.runners.Runner object at 0x10298a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102fddb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10298a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102fdda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102fdf880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102f21bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
          └ <function send_message at 0x17e0700e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name...
                 └ <function send_message at 0x17e087f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name...
                   └ <function send_message at 0x105641e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17e087ec0>
                                └ <base.handlers.message.MessageHandler object at 0x17e0bf3d0>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x17e087d80>
                       │                └ <base.handlers.message.MessageHandler object at 0x17e0bf3d0>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 17, in format_message
    "name": str(message.author.value),
                │       └ Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name='Tim', role=<Role.user: 'user'>)
                └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 09:57] base.chat.send_message: Sending message from user: id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1') author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:57] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:57] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:57] base.chat.send_message: There was a problem delivering the message: 'Entity' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e070680>
    │       └ <function run at 0x102fdbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17de127a0>
           │      └ <function Runner.run at 0x102fdfec0>
           └ <asyncio.runners.Runner object at 0x10298a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102fddb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10298a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102fdda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102fdf880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102f21bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
          └ <function send_message at 0x17e0700e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name...
                 └ <function send_message at 0x17e087f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name...
                   └ <function send_message at 0x105641e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17e087ec0>
                                └ <base.handlers.message.MessageHandler object at 0x17e064250>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x17e087d80>
                       │                └ <base.handlers.message.MessageHandler object at 0x17e064250>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 17, in format_message
    "name": str(message.author.value),
                │       └ Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name='Tim', role=<Role.user: 'user'>)
                └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 09:57] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x17e069dd0 state=finished raised AttributeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name...
                   └ <function send_message at 0x105641e40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17e087ec0>
                                └ <base.handlers.message.MessageHandler object at 0x17e064250>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x17e087d80>
                       │                └ <base.handlers.message.MessageHandler object at 0x17e064250>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 17, in format_message
    "name": str(message.author.value),
                │       └ Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name='Tim', role=<Role.user: 'user'>)
                └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e070680>
    │       └ <function run at 0x102fdbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17de127a0>
           │      └ <function Runner.run at 0x102fdfec0>
           └ <asyncio.runners.Runner object at 0x10298a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102fddb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10298a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102fdda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102fdf880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102f21bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name=...
          └ <function send_message at 0x17e0700e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('641578e3-a871-4de7-8aee-356cc524d6d1'), author=Entity(id=UUID('7054d54f-afbb-421d-a1ff-67c2e2e225aa'), name...
                 └ <function send_message at 0x17e087f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6408515344: attempt #3; slept for 2.0; last result: failed (AttributeError 'Entity' object has no attribute '...
         │    └ <function BaseRetrying.iter at 0x10494bb00>
         └ <AsyncRetrying object at 0x10668e250 (stop=<tenacity.stop.stop_after_attempt object at 0x10492a5d0>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x102aabba0>
          │              └ <Future at 0x17e069dd0 state=finished raised AttributeError>
          └ RetryError(<Future at 0x17e069dd0 state=finished raised AttributeError>)

tenacity.RetryError: RetryError[<Future at 0x17e069dd0 state=finished raised AttributeError>]
[23-09-05 09:59] base.cli.run_cli: Starting CLI.
[23-09-05 09:59] base.chat.send_message: Sending message from user: id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038') author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:59] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:59] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:59] base.chat.send_message: There was a problem delivering the message: 'Entity' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17ead8680>
    │       └ <function run at 0x102e17ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e4127a0>
           │      └ <function Runner.run at 0x102e1bec0>
           └ <asyncio.runners.Runner object at 0x1027c66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102e19b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102e19a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102e1b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102d5dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x17c9802b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17c9802b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17c9802b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17c9802b0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
          └ <function send_message at 0x17ead80e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name...
                 └ <function send_message at 0x17eaeff60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name...
                   └ <function send_message at 0x1051ede40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17eaefec0>
                                └ <base.handlers.message.MessageHandler object at 0x17e55a450>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x17eaefd80>
                       │                └ <base.handlers.message.MessageHandler object at 0x17e55a450>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 17, in format_message
    "name": str(message.author.value),
                │       └ Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name='Tim', role=<Role.user: 'user'>)
                └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 09:59] base.chat.send_message: Sending message from user: id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038') author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:59] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:59] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:59] base.chat.send_message: There was a problem delivering the message: 'Entity' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17ead8680>
    │       └ <function run at 0x102e17ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e4127a0>
           │      └ <function Runner.run at 0x102e1bec0>
           └ <asyncio.runners.Runner object at 0x1027c66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102e19b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102e19a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102e1b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102d5dbc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
          └ <function send_message at 0x17ead80e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name...
                 └ <function send_message at 0x17eaeff60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name...
                   └ <function send_message at 0x1051ede40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17eaefec0>
                                └ <base.handlers.message.MessageHandler object at 0x17eacfc90>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x17eaefd80>
                       │                └ <base.handlers.message.MessageHandler object at 0x17eacfc90>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 17, in format_message
    "name": str(message.author.value),
                │       └ Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name='Tim', role=<Role.user: 'user'>)
                └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 09:59] base.chat.send_message: Sending message from user: id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038') author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 09:59] base.handlers.message.__init__: Message handler initialized.
[23-09-05 09:59] base.handlers.message.build_manifest: Building manifest.
[23-09-05 09:59] base.chat.send_message: There was a problem delivering the message: 'Entity' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17ead8680>
    │       └ <function run at 0x102e17ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e4127a0>
           │      └ <function Runner.run at 0x102e1bec0>
           └ <asyncio.runners.Runner object at 0x1027c66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102e19b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102e19a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102e1b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102d5dbc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
          └ <function send_message at 0x17ead80e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name...
                 └ <function send_message at 0x17eaeff60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name...
                   └ <function send_message at 0x1051ede40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17eaefec0>
                                └ <base.handlers.message.MessageHandler object at 0x17eb27910>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x17eaefd80>
                       │                └ <base.handlers.message.MessageHandler object at 0x17eb27910>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 17, in format_message
    "name": str(message.author.value),
                │       └ Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name='Tim', role=<Role.user: 'user'>)
                └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 09:59] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x17e5a8910 state=finished raised AttributeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name...
                   └ <function send_message at 0x1051ede40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17eaefec0>
                                └ <base.handlers.message.MessageHandler object at 0x17eb27910>

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 28, in build_manifest
    formatted_message: Dict[str, str] = self.format_message(message)
                       │                │    │              └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
                       │                │    └ <function MessageHandler.format_message at 0x17eaefd80>
                       │                └ <base.handlers.message.MessageHandler object at 0x17eb27910>
                       └ typing.Dict

  File "/Users/kaechle/Developer/projects/scint/base/handlers/message.py", line 17, in format_message
    "name": str(message.author.value),
                │       └ Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name='Tim', role=<Role.user: 'user'>)
                └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17ead8680>
    │       └ <function run at 0x102e17ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e4127a0>
           │      └ <function Runner.run at 0x102e1bec0>
           └ <asyncio.runners.Runner object at 0x1027c66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:53> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102e19b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1027c66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102e19a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102e1b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102d5dbc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name=...
          └ <function send_message at 0x17ead80e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('1908a953-8c1f-4327-84a6-b066ca5f7038'), author=Entity(id=UUID('c73e8d1e-fc70-45aa-a67b-9e968b9df27b'), name...
                 └ <function send_message at 0x17eaeff60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6419831952: attempt #3; slept for 2.0; last result: failed (AttributeError 'Entity' object has no attribute '...
         │    └ <function BaseRetrying.iter at 0x104787b00>
         └ <AsyncRetrying object at 0x1108b6410 (stop=<tenacity.stop.stop_after_attempt object at 0x104766590>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x1028e7ba0>
          │              └ <Future at 0x17e5a8910 state=finished raised AttributeError>
          └ RetryError(<Future at 0x17e5a8910 state=finished raised AttributeError>)

tenacity.RetryError: RetryError[<Future at 0x17e5a8910 state=finished raised AttributeError>]
[23-09-05 10:04] base.cli.run_cli: Starting CLI.
[23-09-05 10:04] base.chat.send_message: Sending message from user: id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821') author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:04] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:04] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:04] base.providers.openai.chat: There was a problem delivering the message: 'NoneType' object has no attribute 'content'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e8d8680>
    │       └ <function run at 0x103363ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e2127a0>
           │      └ <function Runner.run at 0x103367ec0>
           └ <asyncio.runners.Runner object at 0x1025966d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103365b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1025966d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103365a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103367880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1032a9bc0>
    └ <Handle <TaskStepMethWrapper object at 0x17dfcdd80>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17dfcdd80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17dfcdd80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17dfcdd80>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name=...
          └ <function send_message at 0x17e8d80e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name...
                 └ <function send_message at 0x17e8eff60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name...
                   └ <function send_message at 0x1069bde40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x106243e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response.content = data["message"]["content"]
    │                          └ <OpenAIObject at 0x17e8c4d10> JSON: {
    │                              "index": 0,
    │                              "message": {
    │                                "role": "assistant",
    │                                "content": "Hello! How can I ...
    └ None

AttributeError: 'NoneType' object has no attribute 'content'
[23-09-05 10:04] base.chat.send_message: There was a problem delivering the message: 'NoneType' object has no attribute 'content'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e8d8680>
    │       └ <function run at 0x103363ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e2127a0>
           │      └ <function Runner.run at 0x103367ec0>
           └ <asyncio.runners.Runner object at 0x1025966d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103365b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1025966d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103365a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103367880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1032a9bc0>
    └ <Handle <TaskStepMethWrapper object at 0x17dfcdd80>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17dfcdd80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17dfcdd80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17dfcdd80>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name=...
          └ <function send_message at 0x17e8d80e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name...
                 └ <function send_message at 0x17e8eff60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name...
                   └ <function send_message at 0x1069bde40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x106243e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response.content = data["message"]["content"]
    │                          └ <OpenAIObject at 0x17e8c4d10> JSON: {
    │                              "index": 0,
    │                              "message": {
    │                                "role": "assistant",
    │                                "content": "Hello! How can I ...
    └ None

AttributeError: 'NoneType' object has no attribute 'content'
[23-09-05 10:04] base.chat.send_message: Sending message from user: id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821') author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:04] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:04] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:04] base.providers.openai.chat: There was a problem delivering the message: 'NoneType' object has no attribute 'content'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e8d8680>
    │       └ <function run at 0x103363ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e2127a0>
           │      └ <function Runner.run at 0x103367ec0>
           └ <asyncio.runners.Runner object at 0x1025966d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103365b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1025966d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103365a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103367880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1032a9bc0>
    └ <Handle <TaskStepMethWrapper object at 0x17c7175b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17c7175b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17c7175b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17c7175b0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name=...
          └ <function send_message at 0x17e8d80e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name...
                 └ <function send_message at 0x17e8eff60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name...
                   └ <function send_message at 0x1069bde40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x106243e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response.content = data["message"]["content"]
    │                          └ <OpenAIObject at 0x17e8c4e90> JSON: {
    │                              "index": 0,
    │                              "message": {
    │                                "role": "assistant",
    │                                "content": "Hello there, how ...
    └ None

AttributeError: 'NoneType' object has no attribute 'content'
[23-09-05 10:04] base.chat.send_message: There was a problem delivering the message: 'NoneType' object has no attribute 'content'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e8d8680>
    │       └ <function run at 0x103363ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e2127a0>
           │      └ <function Runner.run at 0x103367ec0>
           └ <asyncio.runners.Runner object at 0x1025966d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:51> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103365b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1025966d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103365a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103367880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1032a9bc0>
    └ <Handle <TaskStepMethWrapper object at 0x17c7175b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x17c7175b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x17c7175b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x17c7175b0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name=...
          └ <function send_message at 0x17e8d80e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name...
                 └ <function send_message at 0x17e8eff60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821'), author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name...
                   └ <function send_message at 0x1069bde40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x106243e20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response.content = data["message"]["content"]
    │                          └ <OpenAIObject at 0x17e8c4e90> JSON: {
    │                              "index": 0,
    │                              "message": {
    │                                "role": "assistant",
    │                                "content": "Hello there, how ...
    └ None

AttributeError: 'NoneType' object has no attribute 'content'
[23-09-05 10:04] base.chat.send_message: Sending message from user: id=UUID('db3f95a9-8aed-4635-85d6-a92ff394b821') author=Entity(id=UUID('06c72069-f08b-484a-b8bc-22428a06c38a'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:04] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:04] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:06] base.cli.run_cli: Starting CLI.
[23-09-05 10:06] base.chat.send_message: Sending message from user: id=UUID('45be58c7-4ac5-498d-a8b2-ec788d10f737') author=Entity(id=UUID('bce4a67a-df76-428d-bd68-b473866f081c'), name='Tim', role=<Role.user: 'user'>) content='/msg'
[23-09-05 10:06] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:06] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:10] base.cli.run_cli: Starting CLI.
[23-09-05 10:10] base.chat.send_message: Sending message: id=UUID('b1a4392e-c116-45cb-b24d-b0a492dfb857') author=Entity(id=UUID('2340b5da-08b1-4147-990b-2dcacaeead51'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:10] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:10] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:11] base.cli.run_cli: Starting CLI.
[23-09-05 10:11] base.chat.send_message: Sending message: id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074') author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:11] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:11] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:11] base.chat.send_message: There was a problem delivering the message: object tuple can't be used in 'await' expression
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17c46c680>
    │       └ <function run at 0x102c5fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c4d7350>
           │      └ <function Runner.run at 0x102c63ec0>
           └ <asyncio.runners.Runner object at 0x10260e6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102c61b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10260e6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102c61a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102c63880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ba5bc0>
    └ <Handle <TaskStepMethWrapper object at 0x13fe9a800>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x13fe9a800>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x13fe9a800>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x13fe9a800>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name=...
          └ <function send_message at 0x17c46c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name...
                 └ <function send_message at 0x17c483f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name...
                   └ <function send_message at 0x106541e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17c483ec0>
                                └ <base.handlers.message.MessageHandler object at 0x17c401a90>

TypeError: object tuple can't be used in 'await' expression
[23-09-05 10:11] base.chat.send_message: Sending message: id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074') author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:11] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:11] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:11] base.chat.send_message: There was a problem delivering the message: object tuple can't be used in 'await' expression
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17c46c680>
    │       └ <function run at 0x102c5fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c4d7350>
           │      └ <function Runner.run at 0x102c63ec0>
           └ <asyncio.runners.Runner object at 0x10260e6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102c61b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10260e6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102c61a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102c63880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ba5bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name=...
          └ <function send_message at 0x17c46c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name...
                 └ <function send_message at 0x17c483f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name...
                   └ <function send_message at 0x106541e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17c483ec0>
                                └ <base.handlers.message.MessageHandler object at 0x17c38c490>

TypeError: object tuple can't be used in 'await' expression
[23-09-05 10:11] base.chat.send_message: Sending message: id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074') author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:11] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:11] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:11] base.chat.send_message: There was a problem delivering the message: object tuple can't be used in 'await' expression
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17c46c680>
    │       └ <function run at 0x102c5fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c4d7350>
           │      └ <function Runner.run at 0x102c63ec0>
           └ <asyncio.runners.Runner object at 0x10260e6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102c61b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10260e6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102c61a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102c63880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ba5bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name=...
          └ <function send_message at 0x17c46c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name...
                 └ <function send_message at 0x17c483f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name...
                   └ <function send_message at 0x106541e40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17c483ec0>
                                └ <base.handlers.message.MessageHandler object at 0x17c464190>

TypeError: object tuple can't be used in 'await' expression
[23-09-05 10:11] base.cli.run_cli: Error communicating with the assistant: RetryError[<Future at 0x17c4b9b50 state=finished raised TypeError>]

Traceback (most recent call last):

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name...
                   └ <function send_message at 0x106541e40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    messages, functions = await handler.build_manifest(message)
                                │       │              └ Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name=...
                                │       └ <function MessageHandler.build_manifest at 0x17c483ec0>
                                └ <base.handlers.message.MessageHandler object at 0x17c464190>

TypeError: object tuple can't be used in 'await' expression


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17c46c680>
    │       └ <function run at 0x102c5fce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c4d7350>
           │      └ <function Runner.run at 0x102c63ec0>
           └ <asyncio.runners.Runner object at 0x10260e6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102c61b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10260e6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102c61a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102c63880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102ba5bc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name=...
          └ <function send_message at 0x17c46c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('88eec580-a239-44fa-b66a-8ff175cd6074'), author=Entity(id=UUID('4aa39f9e-0e36-4521-9cfb-1971551b48e9'), name...
                 └ <function send_message at 0x17c483f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 47, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 6354258960: attempt #3; slept for 2.0; last result: failed (TypeError object tuple can't be used in 'await' e...
         │    └ <function BaseRetrying.iter at 0x1058bbb00>
         └ <AsyncRetrying object at 0x10589a290 (stop=<tenacity.stop.stop_after_attempt object at 0x104f9e1d0>, wait=<tenacity.wait.wait...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/__init__.py", line 326, in iter
    raise retry_exc from fut.exception()
          │              │   └ <function Future.exception at 0x10272fba0>
          │              └ <Future at 0x17c4b9b50 state=finished raised TypeError>
          └ RetryError(<Future at 0x17c4b9b50 state=finished raised TypeError>)

tenacity.RetryError: RetryError[<Future at 0x17c4b9b50 state=finished raised TypeError>]
[23-09-05 10:12] base.cli.run_cli: Starting CLI.
[23-09-05 10:12] base.chat.send_message: Sending message: id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933') author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:12] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:12] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:12] base.providers.openai.chat: There was a problem delivering the message: 'NoneType' object has no attribute 'content'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288d6c680>
    │       └ <function run at 0x104c07ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288dd7350>
           │      └ <function Runner.run at 0x104c0bec0>
           └ <asyncio.runners.Runner object at 0x1045b66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104c09b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1045b66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104c09a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104c0b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104b4dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x2880a0160>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x2880a0160>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x2880a0160>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x2880a0160>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name=...
          └ <function send_message at 0x288d6c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name...
                 └ <function send_message at 0x288d83f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name...
                   └ <function send_message at 0x106fdde40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x10691be20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response.content = data["message"]["content"]
    │                          └ <OpenAIObject at 0x288d5cd70> JSON: {
    │                              "index": 0,
    │                              "message": {
    │                                "role": "assistant",
    │                                "content": "Hello! How can I ...
    └ None

AttributeError: 'NoneType' object has no attribute 'content'
[23-09-05 10:12] base.chat.send_message: There was a problem delivering the message: 'NoneType' object has no attribute 'content'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288d6c680>
    │       └ <function run at 0x104c07ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288dd7350>
           │      └ <function Runner.run at 0x104c0bec0>
           └ <asyncio.runners.Runner object at 0x1045b66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104c09b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1045b66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104c09a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104c0b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104b4dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x2880a0160>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x2880a0160>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x2880a0160>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x2880a0160>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name=...
          └ <function send_message at 0x288d6c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name...
                 └ <function send_message at 0x288d83f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name...
                   └ <function send_message at 0x106fdde40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x10691be20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response.content = data["message"]["content"]
    │                          └ <OpenAIObject at 0x288d5cd70> JSON: {
    │                              "index": 0,
    │                              "message": {
    │                                "role": "assistant",
    │                                "content": "Hello! How can I ...
    └ None

AttributeError: 'NoneType' object has no attribute 'content'
[23-09-05 10:12] base.chat.send_message: Sending message: id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933') author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:12] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:12] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:12] base.providers.openai.chat: There was a problem delivering the message: 'NoneType' object has no attribute 'content'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288d6c680>
    │       └ <function run at 0x104c07ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288dd7350>
           │      └ <function Runner.run at 0x104c0bec0>
           └ <asyncio.runners.Runner object at 0x1045b66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104c09b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1045b66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104c09a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104c0b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104b4dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x2880a2020>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x2880a2020>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x2880a2020>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x2880a2020>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name=...
          └ <function send_message at 0x288d6c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name...
                 └ <function send_message at 0x288d83f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name...
                   └ <function send_message at 0x106fdde40>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x10691be20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response.content = data["message"]["content"]
    │                          └ <OpenAIObject at 0x288d5cef0> JSON: {
    │                              "index": 0,
    │                              "message": {
    │                                "role": "assistant",
    │                                "content": "Hi! How can I ass...
    └ None

AttributeError: 'NoneType' object has no attribute 'content'
[23-09-05 10:12] base.chat.send_message: There was a problem delivering the message: 'NoneType' object has no attribute 'content'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288d6c680>
    │       └ <function run at 0x104c07ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288dd7350>
           │      └ <function Runner.run at 0x104c0bec0>
           └ <asyncio.runners.Runner object at 0x1045b66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104c09b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1045b66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104c09a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104c0b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104b4dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x2880a2020>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x2880a2020>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x2880a2020>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x2880a2020>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name=...
          └ <function send_message at 0x288d6c0e0>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 88, in async_wrapped
    return await fn(*args, **kwargs)
                 │   │       └ {}
                 │   └ (Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name...
                 └ <function send_message at 0x288d83f60>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/tenacity/_asyncio.py", line 50, in __call__
    result = await fn(*args, **kwargs)
                   │   │       └ {}
                   │   └ (Message(id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933'), author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name...
                   └ <function send_message at 0x106fdde40>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x10691be20>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response.content = data["message"]["content"]
    │                          └ <OpenAIObject at 0x288d5cef0> JSON: {
    │                              "index": 0,
    │                              "message": {
    │                                "role": "assistant",
    │                                "content": "Hi! How can I ass...
    └ None

AttributeError: 'NoneType' object has no attribute 'content'
[23-09-05 10:12] base.chat.send_message: Sending message: id=UUID('b20e4cad-31d6-49e0-94d3-33aa9b961933') author=Entity(id=UUID('5b1c3fc0-50c5-4ba1-baa9-0f00ffd56ea1'), name='Tim', role=<Role.user: 'user'>) content='/msg hi'
[23-09-05 10:12] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:12] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:18] base.cli.run_cli: Starting CLI.
[23-09-05 10:18] base.chat.send_message: Sending message: /msg hi
[23-09-05 10:18] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:18] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:18] base.providers.openai.chat: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1549456c0>
    │       └ <function run at 0x1054bbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1543dec30>
           │      └ <function Runner.run at 0x1054bfec0>
           └ <asyncio.runners.Runner object at 0x104e6a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1054bdb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104e6a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1054bda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1054bf880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105401bc0>
    └ <Handle <TaskStepMethWrapper object at 0x154248640>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x154248640>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x154248640>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x154248640>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('ee405083-66e5-451a-936c-e5daaf070961'), author=Entity(id=UUID('dcfe71f2-0d42-4ba4-ab02-aefdb8b856b1'), name=...
          └ <function send_message at 0x106d87ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104dc3560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response = Message(
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 10:18] base.chat.send_message: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1549456c0>
    │       └ <function run at 0x1054bbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1543dec30>
           │      └ <function Runner.run at 0x1054bfec0>
           └ <asyncio.runners.Runner object at 0x104e6a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1054bdb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104e6a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1054bda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1054bf880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105401bc0>
    └ <Handle <TaskStepMethWrapper object at 0x154248640>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x154248640>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x154248640>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x154248640>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('ee405083-66e5-451a-936c-e5daaf070961'), author=Entity(id=UUID('dcfe71f2-0d42-4ba4-ab02-aefdb8b856b1'), name=...
          └ <function send_message at 0x106d87ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104dc3560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response = Message(
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 10:18] base.cli.run_cli: Error communicating with the assistant: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1549456c0>
    │       └ <function run at 0x1054bbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1543dec30>
           │      └ <function Runner.run at 0x1054bfec0>
           └ <asyncio.runners.Runner object at 0x104e6a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1054bdb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104e6a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1054bda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1054bf880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105401bc0>
    └ <Handle <TaskStepMethWrapper object at 0x154248640>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x154248640>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x154248640>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x154248640>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('ee405083-66e5-451a-936c-e5daaf070961'), author=Entity(id=UUID('dcfe71f2-0d42-4ba4-ab02-aefdb8b856b1'), name=...
          └ <function send_message at 0x106d87ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104dc3560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 37, in chat
    message_response = Message(
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 10:19] base.cli.run_cli: Starting CLI.
[23-09-05 10:20] base.chat.send_message: Sending message: /msg hi
[23-09-05 10:20] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:20] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:20] base.chat.send_message: There was a problem delivering the message: Bad gateway. {"error":{"code":502,"message":"Bad gateway.","param":null,"type":"cf_bad_gateway"}} 502 {'error': {'code': 502, 'message': 'Bad gateway.', 'param': None, 'type': 'cf_bad_gateway'}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:08 GMT', 'Content-Type': 'application/json', 'Content-Length': '84', 'Connection': 'keep-alive', 'X-Frame-Options': 'SAMEORIGIN', 'Referrer-Policy': 'same-origin', 'Cache-Control': 'private, max-age=0, no-store, no-cache, must-revalidate, post-check=0, pre-check=0', 'Expires': 'Thu, 01 Jan 1970 00:00:01 GMT', 'Server': 'cloudflare', 'CF-RAY': '801ec4656a98254d-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a07d90>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a07d90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a07d90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a07d90>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('040d9800-86e6-43b6-a5ff-44b368f1d3ec'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10328b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103287c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x10477de90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [502 Bad Gateway]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13...
                             │    └ <function APIRequestor._interpret_async_response at 0x103288180>
                             └ <openai.api_requestor.APIRequestor object at 0x10477de90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x103288220>
    └ <openai.api_requestor.APIRequestor object at 0x10477de90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103287ce0>
          └ <openai.api_requestor.APIRequestor object at 0x10477de90>

openai.error.APIError: Bad gateway. {"error":{"code":502,"message":"Bad gateway.","param":null,"type":"cf_bad_gateway"}} 502 {'error': {'code': 502, 'message': 'Bad gateway.', 'param': None, 'type': 'cf_bad_gateway'}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:08 GMT', 'Content-Type': 'application/json', 'Content-Length': '84', 'Connection': 'keep-alive', 'X-Frame-Options': 'SAMEORIGIN', 'Referrer-Policy': 'same-origin', 'Cache-Control': 'private, max-age=0, no-store, no-cache, must-revalidate, post-check=0, pre-check=0', 'Expires': 'Thu, 01 Jan 1970 00:00:01 GMT', 'Server': 'cloudflare', 'CF-RAY': '801ec4656a98254d-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 10:20] base.cli.run_cli: Error communicating with the assistant: Bad gateway. {"error":{"code":502,"message":"Bad gateway.","param":null,"type":"cf_bad_gateway"}} 502 {'error': {'code': 502, 'message': 'Bad gateway.', 'param': None, 'type': 'cf_bad_gateway'}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:08 GMT', 'Content-Type': 'application/json', 'Content-Length': '84', 'Connection': 'keep-alive', 'X-Frame-Options': 'SAMEORIGIN', 'Referrer-Policy': 'same-origin', 'Cache-Control': 'private, max-age=0, no-store, no-cache, must-revalidate, post-check=0, pre-check=0', 'Expires': 'Thu, 01 Jan 1970 00:00:01 GMT', 'Server': 'cloudflare', 'CF-RAY': '801ec4656a98254d-GIG', 'alt-svc': 'h3=":443"; ma=86400')>

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a07d90>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a07d90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a07d90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a07d90>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('040d9800-86e6-43b6-a5ff-44b368f1d3ec'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10328b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103287c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x10477de90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [502 Bad Gateway]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13...
                             │    └ <function APIRequestor._interpret_async_response at 0x103288180>
                             └ <openai.api_requestor.APIRequestor object at 0x10477de90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x103288220>
    └ <openai.api_requestor.APIRequestor object at 0x10477de90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103287ce0>
          └ <openai.api_requestor.APIRequestor object at 0x10477de90>

openai.error.APIError: Bad gateway. {"error":{"code":502,"message":"Bad gateway.","param":null,"type":"cf_bad_gateway"}} 502 {'error': {'code': 502, 'message': 'Bad gateway.', 'param': None, 'type': 'cf_bad_gateway'}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:08 GMT', 'Content-Type': 'application/json', 'Content-Length': '84', 'Connection': 'keep-alive', 'X-Frame-Options': 'SAMEORIGIN', 'Referrer-Policy': 'same-origin', 'Cache-Control': 'private, max-age=0, no-store, no-cache, must-revalidate, post-check=0, pre-check=0', 'Expires': 'Thu, 01 Jan 1970 00:00:01 GMT', 'Server': 'cloudflare', 'CF-RAY': '801ec4656a98254d-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 10:20] base.chat.send_message: Sending message: /msg hi
[23-09-05 10:20] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:20] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:20] base.chat.send_message: There was a problem delivering the message: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:27 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1646', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'f13cb54396c4a0d99f1a370ec01e2fc9', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec4ffc9992567-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a07fd0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a07fd0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a07fd0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a07fd0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('fb5afdfd-cdfb-4356-b16a-1e82c68c2602'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10328b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103287c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x103288180>
                             └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x103288220>
    └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103287ce0>
          └ <openai.api_requestor.APIRequestor object at 0x158829650>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:27 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1646', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'f13cb54396c4a0d99f1a370ec01e2fc9', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec4ffc9992567-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 10:20] base.cli.run_cli: Error communicating with the assistant: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:27 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1646', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'f13cb54396c4a0d99f1a370ec01e2fc9', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec4ffc9992567-GIG', 'alt-svc': 'h3=":443"; ma=86400')>

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a07fd0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a07fd0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a07fd0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a07fd0>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('fb5afdfd-cdfb-4356-b16a-1e82c68c2602'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10328b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103287c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x103288180>
                             └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x103288220>
    └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103287ce0>
          └ <openai.api_requestor.APIRequestor object at 0x158829650>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID f13cb54396c4a0d99f1a370ec01e2fc9 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:27 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1646', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'f13cb54396c4a0d99f1a370ec01e2fc9', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec4ffc9992567-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 10:20] base.chat.send_message: Sending message: /msg hi
[23-09-05 10:20] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:20] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:20] base.chat.send_message: There was a problem delivering the message: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:47 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1885', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '18881b8f79822b6d2711b1c52bf93308', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec57a98932761-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a040d0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a040d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a040d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a040d0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('345b0e4c-a276-4c46-a3bc-fd9636cc6764'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10328b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103287c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x158268750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x103288180>
                             └ <openai.api_requestor.APIRequestor object at 0x158268750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x103288220>
    └ <openai.api_requestor.APIRequestor object at 0x158268750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103287ce0>
          └ <openai.api_requestor.APIRequestor object at 0x158268750>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:47 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1885', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '18881b8f79822b6d2711b1c52bf93308', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec57a98932761-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 10:20] base.cli.run_cli: Error communicating with the assistant: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:47 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1885', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '18881b8f79822b6d2711b1c52bf93308', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec57a98932761-GIG', 'alt-svc': 'h3=":443"; ma=86400')>

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a040d0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a040d0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a040d0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a040d0>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('345b0e4c-a276-4c46-a3bc-fd9636cc6764'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10328b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103287c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x158268750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x103288180>
                             └ <openai.api_requestor.APIRequestor object at 0x158268750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x103288220>
    └ <openai.api_requestor.APIRequestor object at 0x158268750>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103287ce0>
          └ <openai.api_requestor.APIRequestor object at 0x158268750>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 18881b8f79822b6d2711b1c52bf93308 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:20:47 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1885', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '18881b8f79822b6d2711b1c52bf93308', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec57a98932761-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 10:21] base.chat.send_message: Sending message: /msg hi
[23-09-05 10:21] base.handlers.message.__init__: Message handler initialized.
[23-09-05 10:21] base.handlers.message.build_manifest: Building manifest.
[23-09-05 10:21] base.chat.send_message: There was a problem delivering the message: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:21:23 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1476', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'fa52231f60c269958f0acdf5142aeb92', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec65d59512567-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a07070>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a07070>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a07070>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a07070>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('2e263487-398a-4063-9d4c-0fe35eef1f9a'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10328b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103287c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x103288180>
                             └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x103288220>
    └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103287ce0>
          └ <openai.api_requestor.APIRequestor object at 0x158829650>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:21:23 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1476', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'fa52231f60c269958f0acdf5142aeb92', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec65d59512567-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 10:21] base.cli.run_cli: Error communicating with the assistant: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:21:23 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1476', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'fa52231f60c269958f0acdf5142aeb92', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec65d59512567-GIG', 'alt-svc': 'h3=":443"; ma=86400')>

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a07070>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a07070>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a07070>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a07070>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('2e263487-398a-4063-9d4c-0fe35eef1f9a'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10328b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103287c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x103288180>
                             └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x103288220>
    └ <openai.api_requestor.APIRequestor object at 0x158829650>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103287ce0>
          └ <openai.api_requestor.APIRequestor object at 0x158829650>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID fa52231f60c269958f0acdf5142aeb92 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 13:21:23 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1476', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'fa52231f60c269958f0acdf5142aeb92', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801ec65d59512567-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 11:08] base.chat.send_message: Sending message: /msg hi there.
[23-09-05 11:08] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:08] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:08] base.providers.openai.chat: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('1200cd61-e8bf-4fa8-be08-a75a570328c4'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi there.', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 39, in chat
    message_response = Message(author=author, content=content)
                       │              │               └ 'Hello! How can I assist you today?'
                       │              └ 'assistant'
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:08] base.chat.send_message: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('1200cd61-e8bf-4fa8-be08-a75a570328c4'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi there.', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 39, in chat
    message_response = Message(author=author, content=content)
                       │              │               └ 'Hello! How can I assist you today?'
                       │              └ 'assistant'
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:08] base.cli.run_cli: Error communicating with the assistant: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1588396c0>
    │       └ <function run at 0x101203ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1582e2c30>
           │      └ <function Runner.run at 0x101207ec0>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101205b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bb26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101205a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x101207880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101149bc0>
    └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x157a04550>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('1200cd61-e8bf-4fa8-be08-a75a570328c4'), author=Entity(id=UUID('e21001c1-b361-41f9-a3cc-f6ee0e28d5de'), name=...
          └ <function send_message at 0x102acfce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi there.', 'name': 'Tim'}]
          │      └ <function chat at 0x100b0b560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 39, in chat
    message_response = Message(author=author, content=content)
                       │              │               └ 'Hello! How can I assist you today?'
                       │              └ 'assistant'
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:11] base.cli.run_cli: Starting CLI.
[23-09-05 11:11] base.cli.run_cli: Error communicating with the assistant: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='Tim', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x2870d16c0>
    │       └ <function run at 0x1032fbce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x286fe2c30>
           │      └ <function Runner.run at 0x1032ffec0>
           └ <asyncio.runners.Runner object at 0x102caa6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1032fdb20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x102caa6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1032fda80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1032ff880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x103241bc0>
    └ <Handle <TaskStepMethWrapper object at 0x286f09870>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x286f09870>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x286f09870>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x286f09870>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 51, in run_cli
    message = Message(author=USER.name, content=message_content)
              │              │    │             └ '/msg hi'
              │              │    └ 'Tim'
              │              └ Entity(id=UUID('16c90d7d-70d9-4efb-9cad-e687db772cc3'), name='Tim', role=<Role.user: 'user'>)
              └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'Tim', 'content': '/msg hi'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='Tim', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:14] base.cli.run_cli: Starting CLI.
[23-09-05 11:14] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:14] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:14] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:15] base.cli.run_cli: Starting CLI.
[23-09-05 11:15] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:15] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:15] base.chat.send_message: There was a problem delivering the message: cannot unpack non-iterable coroutine object
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e8416c0>
    │       └ <function run at 0x104e43ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e2e2c30>
           │      └ <function Runner.run at 0x104e47ec0>
           └ <asyncio.runners.Runner object at 0x1047f26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e45b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1047f26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e45a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e47880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d89bc0>
    └ <Handle <TaskStepMethWrapper object at 0x16fa95b40>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16fa95b40>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16fa95b40>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16fa95b40>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('3a2e51ba-ced9-43db-b58c-342b8969c6f6'), author=Entity(id=UUID('7f58fd7b-ccc7-426d-8485-1c2232dbbe5b'), name=...
          └ <function send_message at 0x10670fce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 20, in send_message
    messages, functions = handler.build_manifest(message)
                          │       │              └ Message(id=UUID('3a2e51ba-ced9-43db-b58c-342b8969c6f6'), author=Entity(id=UUID('7f58fd7b-ccc7-426d-8485-1c2232dbbe5b'), name=...
                          │       └ <function MessageHandler.build_manifest at 0x17e8411c0>
                          └ <base.handlers.message.MessageHandler object at 0x16a5d6710>

TypeError: cannot unpack non-iterable coroutine object
[23-09-05 11:15] base.cli.run_cli: Error communicating with the assistant: cannot unpack non-iterable coroutine object

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17e8416c0>
    │       └ <function run at 0x104e43ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17e2e2c30>
           │      └ <function Runner.run at 0x104e47ec0>
           └ <asyncio.runners.Runner object at 0x1047f26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104e45b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1047f26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104e45a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104e47880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104d89bc0>
    └ <Handle <TaskStepMethWrapper object at 0x16fa95b40>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x16fa95b40>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x16fa95b40>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x16fa95b40>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('3a2e51ba-ced9-43db-b58c-342b8969c6f6'), author=Entity(id=UUID('7f58fd7b-ccc7-426d-8485-1c2232dbbe5b'), name=...
          └ <function send_message at 0x10670fce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 20, in send_message
    messages, functions = handler.build_manifest(message)
                          │       │              └ Message(id=UUID('3a2e51ba-ced9-43db-b58c-342b8969c6f6'), author=Entity(id=UUID('7f58fd7b-ccc7-426d-8485-1c2232dbbe5b'), name=...
                          │       └ <function MessageHandler.build_manifest at 0x17e8411c0>
                          └ <base.handlers.message.MessageHandler object at 0x16a5d6710>

TypeError: cannot unpack non-iterable coroutine object
[23-09-05 11:16] base.cli.run_cli: Starting CLI.
[23-09-05 11:16] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:16] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:16] base.chat.send_message: There was a problem delivering the message: cannot unpack non-iterable coroutine object
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x16883d6c0>
    │       └ <function run at 0x101217ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1682dec30>
           │      └ <function Runner.run at 0x10121bec0>
           └ <asyncio.runners.Runner object at 0x100bc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101219b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101219a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10121b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10115dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x167347b20>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x167347b20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x167347b20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x167347b20>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('fae279cd-3784-467b-9b42-be46c30f1b53'), author=Entity(id=UUID('452b7731-8a6f-4a53-8a7e-6b7f2343a71a'), name=...
          └ <function send_message at 0x102ae3ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 20, in send_message
    messages, functions = handler.build_manifest(message)
                          │       │              └ Message(id=UUID('fae279cd-3784-467b-9b42-be46c30f1b53'), author=Entity(id=UUID('452b7731-8a6f-4a53-8a7e-6b7f2343a71a'), name=...
                          │       └ <function MessageHandler.build_manifest at 0x16883d1c0>
                          └ <base.handlers.message.MessageHandler object at 0x12e764350>

TypeError: cannot unpack non-iterable coroutine object
[23-09-05 11:16] base.cli.run_cli: Error communicating with the assistant: cannot unpack non-iterable coroutine object

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x16883d6c0>
    │       └ <function run at 0x101217ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1682dec30>
           │      └ <function Runner.run at 0x10121bec0>
           └ <asyncio.runners.Runner object at 0x100bc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101219b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100bc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101219a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10121b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10115dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x167347b20>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x167347b20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x167347b20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x167347b20>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('fae279cd-3784-467b-9b42-be46c30f1b53'), author=Entity(id=UUID('452b7731-8a6f-4a53-8a7e-6b7f2343a71a'), name=...
          └ <function send_message at 0x102ae3ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 20, in send_message
    messages, functions = handler.build_manifest(message)
                          │       │              └ Message(id=UUID('fae279cd-3784-467b-9b42-be46c30f1b53'), author=Entity(id=UUID('452b7731-8a6f-4a53-8a7e-6b7f2343a71a'), name=...
                          │       └ <function MessageHandler.build_manifest at 0x16883d1c0>
                          └ <base.handlers.message.MessageHandler object at 0x12e764350>

TypeError: cannot unpack non-iterable coroutine object
[23-09-05 11:18] base.cli.run_cli: Starting CLI.
[23-09-05 11:18] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:18] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:18] base.chat.send_message: There was a problem delivering the message: cannot unpack non-iterable coroutine object
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1467d16c0>
    │       └ <function run at 0x10111bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1466e2c30>
           │      └ <function Runner.run at 0x10111fec0>
           └ <asyncio.runners.Runner object at 0x100aca6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10111db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100aca6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10111da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10111f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101061bc0>
    └ <Handle <TaskStepMethWrapper object at 0x14596ac80>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14596ac80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14596ac80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14596ac80>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('981adc36-ee94-48a0-aef4-6d2a9f3b192a'), author=Entity(id=UUID('c21d12d8-8026-45d2-a131-46748c8693dd'), name=...
          └ <function send_message at 0x1029e7ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 20, in send_message
    messages, functions = handler.build_manifest(message)
                          │       │              └ Message(id=UUID('981adc36-ee94-48a0-aef4-6d2a9f3b192a'), author=Entity(id=UUID('c21d12d8-8026-45d2-a131-46748c8693dd'), name=...
                          │       └ <function MessageHandler.build_manifest at 0x1467d11c0>
                          └ <base.handlers.message.MessageHandler object at 0x1466b1350>

TypeError: cannot unpack non-iterable coroutine object
[23-09-05 11:18] base.cli.run_cli: Error communicating with the assistant: cannot unpack non-iterable coroutine object

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1467d16c0>
    │       └ <function run at 0x10111bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1466e2c30>
           │      └ <function Runner.run at 0x10111fec0>
           └ <asyncio.runners.Runner object at 0x100aca6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10111db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100aca6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10111da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10111f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x101061bc0>
    └ <Handle <TaskStepMethWrapper object at 0x14596ac80>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14596ac80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14596ac80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14596ac80>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('981adc36-ee94-48a0-aef4-6d2a9f3b192a'), author=Entity(id=UUID('c21d12d8-8026-45d2-a131-46748c8693dd'), name=...
          └ <function send_message at 0x1029e7ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 20, in send_message
    messages, functions = handler.build_manifest(message)
                          │       │              └ Message(id=UUID('981adc36-ee94-48a0-aef4-6d2a9f3b192a'), author=Entity(id=UUID('c21d12d8-8026-45d2-a131-46748c8693dd'), name=...
                          │       └ <function MessageHandler.build_manifest at 0x1467d11c0>
                          └ <base.handlers.message.MessageHandler object at 0x1466b1350>

TypeError: cannot unpack non-iterable coroutine object
[23-09-05 11:19] base.cli.run_cli: Starting CLI.
[23-09-05 11:19] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:19] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:19] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:20] base.cli.run_cli: Starting CLI.
[23-09-05 11:20] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:20] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:20] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:20] base.chat.send_message: ([{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}], [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user requests or tasks.', 'parameters': {'type': 'object', 'properties': {'search_query': {'type': 'string', 'description': "Use this parameter to inform the user that you're initiating a search."}, 'success_definition': {'type': 'string', 'description': 'Based on the given query, provide a threshold of a successful search result.'}, 'user_response': {'type': 'string', 'description': "Inform the user that you're beginning the search process."}}, 'required': ['search_query', 'define_success', 'user_response']}}])
[23-09-05 11:20] base.providers.openai.chat: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x2806d56c0>
    │       └ <function run at 0x10493bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x2805e2b00>
           │      └ <function Runner.run at 0x10493fec0>
           └ <asyncio.runners.Runner object at 0x1042ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10493db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1042ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10493da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10493f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104881bc0>
    └ <Handle <TaskStepMethWrapper object at 0x280300190>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x280300190>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x280300190>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x280300190>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('8b9efde9-5d8d-4e17-bbaf-7dd3cc287251'), author=Entity(id=UUID('f6486db2-e792-456d-804b-a69cd5c9a6b1'), name=...
          └ <function send_message at 0x106207ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104243560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 39, in chat
    message_response = Message(author=author, content=content)
                       │              │               └ 'Hello! How can I assist you today?'
                       │              └ 'assistant'
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:20] base.chat.send_message: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x2806d56c0>
    │       └ <function run at 0x10493bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x2805e2b00>
           │      └ <function Runner.run at 0x10493fec0>
           └ <asyncio.runners.Runner object at 0x1042ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10493db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1042ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10493da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10493f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104881bc0>
    └ <Handle <TaskStepMethWrapper object at 0x280300190>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x280300190>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x280300190>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x280300190>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('8b9efde9-5d8d-4e17-bbaf-7dd3cc287251'), author=Entity(id=UUID('f6486db2-e792-456d-804b-a69cd5c9a6b1'), name=...
          └ <function send_message at 0x106207ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104243560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 39, in chat
    message_response = Message(author=author, content=content)
                       │              │               └ 'Hello! How can I assist you today?'
                       │              └ 'assistant'
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:20] base.cli.run_cli: Error communicating with the assistant: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x2806d56c0>
    │       └ <function run at 0x10493bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x2805e2b00>
           │      └ <function Runner.run at 0x10493fec0>
           └ <asyncio.runners.Runner object at 0x1042ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10493db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1042ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10493da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10493f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104881bc0>
    └ <Handle <TaskStepMethWrapper object at 0x280300190>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x280300190>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x280300190>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x280300190>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('8b9efde9-5d8d-4e17-bbaf-7dd3cc287251'), author=Entity(id=UUID('f6486db2-e792-456d-804b-a69cd5c9a6b1'), name=...
          └ <function send_message at 0x106207ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104243560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 39, in chat
    message_response = Message(author=author, content=content)
                       │              │               └ 'Hello! How can I assist you today?'
                       │              └ 'assistant'
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:24] base.cli.run_cli: Starting CLI.
[23-09-05 11:24] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:24] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:24] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:24] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:24] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:24] base.chat.send_message: ([{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}], [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user requests or tasks.', 'parameters': {'type': 'object', 'properties': {'search_query': {'type': 'string', 'description': "Use this parameter to inform the user that you're initiating a search."}, 'success_definition': {'type': 'string', 'description': 'Based on the given query, provide a threshold of a successful search result.'}, 'user_response': {'type': 'string', 'description': "Inform the user that you're beginning the search process."}}, 'required': ['search_query', 'define_success', 'user_response']}}])
[23-09-05 11:26] base.cli.run_cli: Starting CLI.
[23-09-05 11:26] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:26] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:26] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:26] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:26] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:26] base.chat.send_message: ([{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}], [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user requests or tasks.', 'parameters': {'type': 'object', 'properties': {'search_query': {'type': 'string', 'description': "Use this parameter to inform the user that you're initiating a search."}, 'success_definition': {'type': 'string', 'description': 'Based on the given query, provide a threshold of a successful search result.'}, 'user_response': {'type': 'string', 'description': "Inform the user that you're beginning the search process."}}, 'required': ['search_query', 'define_success', 'user_response']}}])
[23-09-05 11:26] base.chat.send_message: There was a problem delivering the message: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:26:41 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1939', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '3417c4c61cc664e59eba2ceee36d9e13', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f26068c231180-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288f456c0>
    │       └ <function run at 0x105317ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x2889e2b00>
           │      └ <function Runner.run at 0x10531bec0>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105319b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105319a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10531b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10525dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x28884a0e0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x28884a0e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x28884a0e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x28884a0e0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('55e3e2b9-21ba-4199-92eb-396e77b20384'), author=Entity(id=UUID('55073f9e-e49f-4219-9c14-f5bdbfc39dd9'), name=...
          └ <function send_message at 0x106be3ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104c1f560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10737b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x107363c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x17fad3950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x107378180>
                             └ <openai.api_requestor.APIRequestor object at 0x17fad3950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x107378220>
    └ <openai.api_requestor.APIRequestor object at 0x17fad3950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x107363ce0>
          └ <openai.api_requestor.APIRequestor object at 0x17fad3950>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:26:41 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1939', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '3417c4c61cc664e59eba2ceee36d9e13', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f26068c231180-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 11:26] base.cli.run_cli: Error communicating with the assistant: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:26:41 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1939', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '3417c4c61cc664e59eba2ceee36d9e13', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f26068c231180-GIG', 'alt-svc': 'h3=":443"; ma=86400')>

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288f456c0>
    │       └ <function run at 0x105317ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x2889e2b00>
           │      └ <function Runner.run at 0x10531bec0>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105319b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105319a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10531b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10525dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x28884a0e0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x28884a0e0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x28884a0e0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x28884a0e0>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('55e3e2b9-21ba-4199-92eb-396e77b20384'), author=Entity(id=UUID('55073f9e-e49f-4219-9c14-f5bdbfc39dd9'), name=...
          └ <function send_message at 0x106be3ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104c1f560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x10737b240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x107363c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x17fad3950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x107378180>
                             └ <openai.api_requestor.APIRequestor object at 0x17fad3950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x107378220>
    └ <openai.api_requestor.APIRequestor object at 0x17fad3950>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x107363ce0>
          └ <openai.api_requestor.APIRequestor object at 0x17fad3950>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 3417c4c61cc664e59eba2ceee36d9e13 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:26:41 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '1939', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '3417c4c61cc664e59eba2ceee36d9e13', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f26068c231180-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 11:27] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:27] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:27] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:27] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:27] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:27] base.chat.send_message: ([{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}], [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user requests or tasks.', 'parameters': {'type': 'object', 'properties': {'search_query': {'type': 'string', 'description': "Use this parameter to inform the user that you're initiating a search."}, 'success_definition': {'type': 'string', 'description': 'Based on the given query, provide a threshold of a successful search result.'}, 'user_response': {'type': 'string', 'description': "Inform the user that you're beginning the search process."}}, 'required': ['search_query', 'define_success', 'user_response']}}])
[23-09-05 11:27] base.providers.openai.chat: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288f456c0>
    │       └ <function run at 0x105317ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x2889e2b00>
           │      └ <function Runner.run at 0x10531bec0>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105319b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105319a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10531b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10525dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('8350e36a-fc56-401b-8ece-17858d94fb88'), author=Entity(id=UUID('55073f9e-e49f-4219-9c14-f5bdbfc39dd9'), name=...
          └ <function send_message at 0x106be3ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104c1f560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 39, in chat
    message_response = Message(author=author, content=content)
                       │              │               └ 'Hi! How can I assist you today?'
                       │              └ 'assistant'
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hi! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:27] base.chat.send_message: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288f456c0>
    │       └ <function run at 0x105317ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x2889e2b00>
           │      └ <function Runner.run at 0x10531bec0>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105319b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105319a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10531b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10525dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('8350e36a-fc56-401b-8ece-17858d94fb88'), author=Entity(id=UUID('55073f9e-e49f-4219-9c14-f5bdbfc39dd9'), name=...
          └ <function send_message at 0x106be3ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104c1f560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 39, in chat
    message_response = Message(author=author, content=content)
                       │              │               └ 'Hi! How can I assist you today?'
                       │              └ 'assistant'
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hi! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:27] base.cli.run_cli: Error communicating with the assistant: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288f456c0>
    │       └ <function run at 0x105317ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x2889e2b00>
           │      └ <function Runner.run at 0x10531bec0>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105319b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104cc66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105319a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10531b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10525dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x2888497b0>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('8350e36a-fc56-401b-8ece-17858d94fb88'), author=Entity(id=UUID('55073f9e-e49f-4219-9c14-f5bdbfc39dd9'), name=...
          └ <function send_message at 0x106be3ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x104c1f560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 39, in chat
    message_response = Message(author=author, content=content)
                       │              │               └ 'Hi! How can I assist you today?'
                       │              └ 'assistant'
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'assistant', 'content': 'Hi! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:29] base.cli.run_cli: Starting CLI.
[23-09-05 11:29] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:29] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:29] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:29] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:29] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:29] base.chat.send_message: ([{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}], [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user requests or tasks.', 'parameters': {'type': 'object', 'properties': {'search_query': {'type': 'string', 'description': "Use this parameter to inform the user that you're initiating a search."}, 'success_definition': {'type': 'string', 'description': 'Based on the given query, provide a threshold of a successful search result.'}, 'user_response': {'type': 'string', 'description': "Inform the user that you're beginning the search process."}}, 'required': ['search_query', 'define_success', 'user_response']}}])
[23-09-05 11:29] base.providers.openai.chat: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='Assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1590396c0>
    │       └ <function run at 0x10125bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x158ae2b00>
           │      └ <function Runner.run at 0x10125fec0>
           └ <asyncio.runners.Runner object at 0x100c0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10125db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100c0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10125da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10125f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011a1bc0>
    └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('4804505e-e95d-4b5d-bd91-5c4b98250ccb'), author=Entity(id=UUID('9f2ca285-0123-474e-b624-240154d3371b'), name=...
          └ <function send_message at 0x102b27ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b63560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 38, in chat
    message_response = Message(author=ASSISTANT.name, content=content)
                       │              │         │             └ 'Hello! How can I assist you today?'
                       │              │         └ 'Assistant'
                       │              └ Entity(id=UUID('0377f703-dc94-4cc3-babb-b758bef32e5f'), name='Assistant', role=<Role.assistant: 'assistant'>)
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'Assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='Assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:29] base.chat.send_message: There was a problem delivering the message: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='Assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1590396c0>
    │       └ <function run at 0x10125bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x158ae2b00>
           │      └ <function Runner.run at 0x10125fec0>
           └ <asyncio.runners.Runner object at 0x100c0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10125db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100c0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10125da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10125f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011a1bc0>
    └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('4804505e-e95d-4b5d-bd91-5c4b98250ccb'), author=Entity(id=UUID('9f2ca285-0123-474e-b624-240154d3371b'), name=...
          └ <function send_message at 0x102b27ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b63560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 38, in chat
    message_response = Message(author=ASSISTANT.name, content=content)
                       │              │         │             └ 'Hello! How can I assist you today?'
                       │              │         └ 'Assistant'
                       │              └ Entity(id=UUID('0377f703-dc94-4cc3-babb-b758bef32e5f'), name='Assistant', role=<Role.assistant: 'assistant'>)
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'Assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='Assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:29] base.cli.run_cli: Error communicating with the assistant: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='Assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1590396c0>
    │       └ <function run at 0x10125bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x158ae2b00>
           │      └ <function Runner.run at 0x10125fec0>
           └ <asyncio.runners.Runner object at 0x100c0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10125db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100c0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10125da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10125f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1011a1bc0>
    └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x15769aa70>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('4804505e-e95d-4b5d-bd91-5c4b98250ccb'), author=Entity(id=UUID('9f2ca285-0123-474e-b624-240154d3371b'), name=...
          └ <function send_message at 0x102b27ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x100b63560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 38, in chat
    message_response = Message(author=ASSISTANT.name, content=content)
                       │              │         │             └ 'Hello! How can I assist you today?'
                       │              │         └ 'Assistant'
                       │              └ Entity(id=UUID('0377f703-dc94-4cc3-babb-b758bef32e5f'), name='Assistant', role=<Role.assistant: 'assistant'>)
                       └ <class 'base.definitions.types.Message'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 165, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
    │                 │                      │               │                   └ <unprintable Message object>
    │                 │                      │               └ {'author': 'Assistant', 'content': 'Hello! How can I assist you today?'}
    │                 │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
    │                 └ SchemaValidator(title="Message", validator=Model(
    │                       ModelValidator {
    │                           revalidate: Never,
    │                           validator: ModelFie...
    └ <unprintable Message object>

pydantic_core._pydantic_core.ValidationError: 1 validation error for Message
author
  Input should be a valid dictionary or instance of Entity [type=model_type, input_value='Assistant', input_type=str]
    For further information visit https://errors.pydantic.dev/2.3/v/model_type
[23-09-05 11:29] base.cli.run_cli: Starting CLI.
[23-09-05 11:29] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:29] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:29] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:29] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:29] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:29] base.chat.send_message: ([{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}], [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user requests or tasks.', 'parameters': {'type': 'object', 'properties': {'search_query': {'type': 'string', 'description': "Use this parameter to inform the user that you're initiating a search."}, 'success_definition': {'type': 'string', 'description': 'Based on the given query, provide a threshold of a successful search result.'}, 'user_response': {'type': 'string', 'description': "Inform the user that you're beginning the search process."}}, 'required': ['search_query', 'define_success', 'user_response']}}])
[23-09-05 11:30] base.cli.run_cli: Starting CLI.
[23-09-05 11:30] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:30] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:30] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:30] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:30] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:30] base.chat.send_message: ([{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}], [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user requests or tasks.', 'parameters': {'type': 'object', 'properties': {'search_query': {'type': 'string', 'description': "Use this parameter to inform the user that you're initiating a search."}, 'success_definition': {'type': 'string', 'description': 'Based on the given query, provide a threshold of a successful search result.'}, 'user_response': {'type': 'string', 'description': "Inform the user that you're beginning the search process."}}, 'required': ['search_query', 'define_success', 'user_response']}}])
[23-09-05 11:30] base.chat.send_message: There was a problem delivering the message: 'Message' object has no attribute 'name'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x166e396c0>
    │       └ <function run at 0x1056b3ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1668e2b00>
           │      └ <function Runner.run at 0x1056b7ec0>
           └ <asyncio.runners.Runner object at 0x1050626d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1056b5b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1050626d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1056b5a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1056b7880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1055f9bc0>
    └ <Handle <TaskStepMethWrapper object at 0x166604fa0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x166604fa0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x166604fa0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x166604fa0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('ca159c11-35bc-49c7-8e59-8ee940cc4870'), author=Entity(id=UUID('e8ef5b6a-0331-4fa9-84ef-32cabdb2380e'), name=...
          └ <function send_message at 0x109fe7ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 23, in send_message
    logger.info(f"Response from {message.name}.\n ❯ {message.content}")
    │      └ <function Logger.info at 0x10bcb0d60>
    └ <loguru.logger handlers=[(id=1, level=20, sink='base/data/logs/logfile'), (id=2, level=20, sink=<stderr>)]>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Message' object has no attribute 'name'
[23-09-05 11:30] base.cli.run_cli: Error communicating with the assistant: 'Message' object has no attribute 'name'

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x166e396c0>
    │       └ <function run at 0x1056b3ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1668e2b00>
           │      └ <function Runner.run at 0x1056b7ec0>
           └ <asyncio.runners.Runner object at 0x1050626d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1056b5b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1050626d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1056b5a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1056b7880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1055f9bc0>
    └ <Handle <TaskStepMethWrapper object at 0x166604fa0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x166604fa0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x166604fa0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x166604fa0>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('ca159c11-35bc-49c7-8e59-8ee940cc4870'), author=Entity(id=UUID('e8ef5b6a-0331-4fa9-84ef-32cabdb2380e'), name=...
          └ <function send_message at 0x109fe7ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 23, in send_message
    logger.info(f"Response from {message.name}.\n ❯ {message.content}")
    │      └ <function Logger.info at 0x10bcb0d60>
    └ <loguru.logger handlers=[(id=1, level=20, sink='base/data/logs/logfile'), (id=2, level=20, sink=<stderr>)]>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Message' object has no attribute 'name'
[23-09-05 11:32] base.cli.run_cli: Starting CLI.
[23-09-05 11:32] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:32] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:32] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:32] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:32] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:32] base.chat.send_message: ([{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}], [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user requests or tasks.', 'parameters': {'type': 'object', 'properties': {'search_query': {'type': 'string', 'description': "Use this parameter to inform the user that you're initiating a search."}, 'success_definition': {'type': 'string', 'description': 'Based on the given query, provide a threshold of a successful search result.'}, 'user_response': {'type': 'string', 'description': "Inform the user that you're beginning the search process."}}, 'required': ['search_query', 'define_success', 'user_response']}}])
[23-09-05 11:32] base.chat.send_message: Response from id=UUID('c615ab12-f9a1-4036-b50b-4962bf91b83a') name='Tim' role=<Role.user: 'user'>.
 ❯ /msg hi
[23-09-05 11:36] base.cli.run_cli: Starting CLI.
[23-09-05 11:36] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:36] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:36] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:36] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:36] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:36] base.chat.send_message: Sending mmessage payload.
[23-09-05 11:36] base.providers.openai.chat: There was a problem delivering the message: cannot access local variable 'message_function' where it is not associated with a value
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x159e3d6c0>
    │       └ <function run at 0x102a57ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1599e2b00>
           │      └ <function Runner.run at 0x102a5bec0>
           └ <asyncio.runners.Runner object at 0x1024066d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102a59b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1024066d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102a59a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102a5b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10299dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x159749690>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x159749690>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x159749690>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x159749690>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('cb590186-a8b8-45dc-babd-f2e3c9d17e5a'), author=Entity(id=UUID('1aaae70e-40bc-4c23-8434-1bb611eb68e3'), name=...
          └ <function send_message at 0x104323ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x10235f560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

> File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 41, in chat
    if message_response and message_function is not None:
       └ Message(id=UUID('c126eef3-7798-4467-a79e-6e7c986fe8ec'), author=Entity(id=UUID('b01dfddd-45b2-42f0-b651-7b7fb106a531'), name=...

UnboundLocalError: cannot access local variable 'message_function' where it is not associated with a value
[23-09-05 11:36] base.chat.send_message: There was a problem delivering the message: cannot access local variable 'message_function' where it is not associated with a value
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x159e3d6c0>
    │       └ <function run at 0x102a57ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1599e2b00>
           │      └ <function Runner.run at 0x102a5bec0>
           └ <asyncio.runners.Runner object at 0x1024066d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102a59b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1024066d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102a59a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102a5b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10299dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x159749690>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x159749690>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x159749690>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x159749690>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('cb590186-a8b8-45dc-babd-f2e3c9d17e5a'), author=Entity(id=UUID('1aaae70e-40bc-4c23-8434-1bb611eb68e3'), name=...
          └ <function send_message at 0x104323ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x10235f560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 41, in chat
    if message_response and message_function is not None:
       └ Message(id=UUID('c126eef3-7798-4467-a79e-6e7c986fe8ec'), author=Entity(id=UUID('b01dfddd-45b2-42f0-b651-7b7fb106a531'), name=...

UnboundLocalError: cannot access local variable 'message_function' where it is not associated with a value
[23-09-05 11:36] base.cli.run_cli: Error communicating with the assistant: cannot access local variable 'message_function' where it is not associated with a value

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x159e3d6c0>
    │       └ <function run at 0x102a57ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1599e2b00>
           │      └ <function Runner.run at 0x102a5bec0>
           └ <asyncio.runners.Runner object at 0x1024066d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102a59b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1024066d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102a59a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102a5b880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10299dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x159749690>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x159749690>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x159749690>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x159749690>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('cb590186-a8b8-45dc-babd-f2e3c9d17e5a'), author=Entity(id=UUID('1aaae70e-40bc-4c23-8434-1bb611eb68e3'), name=...
          └ <function send_message at 0x104323ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x10235f560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 41, in chat
    if message_response and message_function is not None:
       └ Message(id=UUID('c126eef3-7798-4467-a79e-6e7c986fe8ec'), author=Entity(id=UUID('b01dfddd-45b2-42f0-b651-7b7fb106a531'), name=...

UnboundLocalError: cannot access local variable 'message_function' where it is not associated with a value
[23-09-05 11:39] base.cli.run_cli: Starting CLI.
[23-09-05 11:39] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:39] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:39] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:39] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:39] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:39] base.chat.send_message: Sending mmessage payload.
[23-09-05 11:39] base.chat.send_message: There was a problem delivering the message: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:39:20 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '2672', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '02e5575984d0de8a9141b39503767b25', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f38869ad92610-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x13f0396c0>
    │       └ <function run at 0x102bf7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x13eae2b00>
           │      └ <function Runner.run at 0x102bfbec0>
           └ <asyncio.runners.Runner object at 0x1025a66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102bf9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1025a66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102bf9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102bfb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102b3dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x1393b2fb0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1393b2fb0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1393b2fb0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1393b2fb0>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('a3503234-f235-4093-8b11-9cdbfe11a1c1'), author=Entity(id=UUID('7b7d06cb-37af-4844-87cf-d3b9706b88b5'), name=...
          └ <function send_message at 0x1044c3ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x1024ff560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x104c63240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x104c43c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x105e96050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x104c60180>
                             └ <openai.api_requestor.APIRequestor object at 0x105e96050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x104c60220>
    └ <openai.api_requestor.APIRequestor object at 0x105e96050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x104c43ce0>
          └ <openai.api_requestor.APIRequestor object at 0x105e96050>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:39:20 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '2672', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '02e5575984d0de8a9141b39503767b25', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f38869ad92610-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 11:39] base.cli.run_cli: Error communicating with the assistant: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:39:20 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '2672', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '02e5575984d0de8a9141b39503767b25', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f38869ad92610-GIG', 'alt-svc': 'h3=":443"; ma=86400')>

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x13f0396c0>
    │       └ <function run at 0x102bf7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x13eae2b00>
           │      └ <function Runner.run at 0x102bfbec0>
           └ <asyncio.runners.Runner object at 0x1025a66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102bf9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1025a66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102bf9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102bfb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102b3dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x1393b2fb0>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1393b2fb0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1393b2fb0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1393b2fb0>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('a3503234-f235-4093-8b11-9cdbfe11a1c1'), author=Entity(id=UUID('7b7d06cb-37af-4844-87cf-d3b9706b88b5'), name=...
          └ <function send_message at 0x1044c3ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    await openai.chat(messages, functions)
          │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
          │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
          │      └ <function chat at 0x1024ff560>
          └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x104c63240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x104c43c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x105e96050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x104c60180>
                             └ <openai.api_requestor.APIRequestor object at 0x105e96050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x104c60220>
    └ <openai.api_requestor.APIRequestor object at 0x105e96050>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x104c43ce0>
          └ <openai.api_requestor.APIRequestor object at 0x105e96050>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 02e5575984d0de8a9141b39503767b25 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:39:20 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '2672', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '02e5575984d0de8a9141b39503767b25', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f38869ad92610-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 11:39] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:39] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:39] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:39] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:39] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:39] base.chat.send_message: Sending mmessage payload.
[23-09-05 11:39] base.chat.send_message: There was a problem delivering the message: 'Entity' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x13f0396c0>
    │       └ <function run at 0x102bf7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x13eae2b00>
           │      └ <function Runner.run at 0x102bfbec0>
           └ <asyncio.runners.Runner object at 0x1025a66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102bf9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1025a66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102bf9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102bfb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102b3dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x1393b0100>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1393b0100>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1393b0100>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1393b0100>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('b65a8ec7-06c5-425e-860d-d4049c322f48'), author=Entity(id=UUID('7b7d06cb-37af-4844-87cf-d3b9706b88b5'), name=...
          └ <function send_message at 0x1044c3ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    logger.info(f"Response from {message.author.value}.\n ❯ {message.content}")
    │      └ <function Logger.info at 0x105ef8d60>
    └ <loguru.logger handlers=[(id=1, level=20, sink='base/data/logs/logfile'), (id=2, level=20, sink=<stderr>)]>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 11:39] base.cli.run_cli: Error communicating with the assistant: 'Entity' object has no attribute 'value'

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x13f0396c0>
    │       └ <function run at 0x102bf7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x13eae2b00>
           │      └ <function Runner.run at 0x102bfbec0>
           └ <asyncio.runners.Runner object at 0x1025a66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102bf9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1025a66d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102bf9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102bfb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102b3dbc0>
    └ <Handle <TaskStepMethWrapper object at 0x1393b0100>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x1393b0100>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x1393b0100>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x1393b0100>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('b65a8ec7-06c5-425e-860d-d4049c322f48'), author=Entity(id=UUID('7b7d06cb-37af-4844-87cf-d3b9706b88b5'), name=...
          └ <function send_message at 0x1044c3ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    logger.info(f"Response from {message.author.value}.\n ❯ {message.content}")
    │      └ <function Logger.info at 0x105ef8d60>
    └ <loguru.logger handlers=[(id=1, level=20, sink='base/data/logs/logfile'), (id=2, level=20, sink=<stderr>)]>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 11:41] base.cli.run_cli: Starting CLI.
[23-09-05 11:41] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:41] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:41] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:41] base.handlers.message.build_manifest: {'role': 'user', 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:41] base.handlers.message.build_manifest: [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:41] base.chat.send_message: Sending mmessage payload.
[23-09-05 11:41] base.chat.send_message: There was a problem delivering the message: 'Entity' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x164cd56c0>
    │       └ <function run at 0x105333ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x164be2b00>
           │      └ <function Runner.run at 0x105337ec0>
           └ <asyncio.runners.Runner object at 0x104ce26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105335b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104ce26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105335a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105337880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105279bc0>
    └ <Handle <TaskStepMethWrapper object at 0x13fd46470>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x13fd46470>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x13fd46470>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x13fd46470>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('ba8ee2ac-f0d5-47f1-8c3b-9e2a0f02be48'), author=Entity(id=UUID('cb5d2719-19d0-45f4-96cc-47d74b818237'), name=...
          └ <function send_message at 0x106bffce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    logger.info(f"Response from {message.author.value}.\n ❯ {message.content}")
    │      └ <function Logger.info at 0x1091e0d60>
    └ <loguru.logger handlers=[(id=1, level=20, sink='base/data/logs/logfile'), (id=2, level=20, sink=<stderr>)]>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 11:41] base.cli.run_cli: Error communicating with the assistant: 'Entity' object has no attribute 'value'

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x164cd56c0>
    │       └ <function run at 0x105333ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x164be2b00>
           │      └ <function Runner.run at 0x105337ec0>
           └ <asyncio.runners.Runner object at 0x104ce26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105335b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104ce26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105335a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x105337880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105279bc0>
    └ <Handle <TaskStepMethWrapper object at 0x13fd46470>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x13fd46470>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x13fd46470>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x13fd46470>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('ba8ee2ac-f0d5-47f1-8c3b-9e2a0f02be48'), author=Entity(id=UUID('cb5d2719-19d0-45f4-96cc-47d74b818237'), name=...
          └ <function send_message at 0x106bffce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    logger.info(f"Response from {message.author.value}.\n ❯ {message.content}")
    │      └ <function Logger.info at 0x1091e0d60>
    └ <loguru.logger handlers=[(id=1, level=20, sink='base/data/logs/logfile'), (id=2, level=20, sink=<stderr>)]>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 11:42] base.cli.run_cli: Starting CLI.
[23-09-05 11:42] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:42] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:42] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:42] base.handlers.message.build_manifest: {'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:42] base.handlers.message.build_manifest: [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:42] base.chat.send_message: Sending mmessage payload.
[23-09-05 11:42] base.chat.send_message: There was a problem delivering the message: 'Entity' object has no attribute 'value'
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17ca456c0>
    │       └ <function run at 0x1010b7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c5e2b00>
           │      └ <function Runner.run at 0x1010bbec0>
           └ <asyncio.runners.Runner object at 0x100a666d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010b9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100a666d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010b9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010bb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ffdbc0>
    └ <Handle <TaskStepMethWrapper object at 0x163508b80>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x163508b80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x163508b80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x163508b80>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('9fa57d34-2d47-40e0-960a-697506ccb84b'), author=Entity(id=UUID('516356fd-1c20-4cb0-8298-c23355797a07'), name=...
          └ <function send_message at 0x102983ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    logger.info(f"Response from {message.author.value}.\n ❯ {message.content}")
    │      └ <function Logger.info at 0x1045bcd60>
    └ <loguru.logger handlers=[(id=1, level=20, sink='base/data/logs/logfile'), (id=2, level=20, sink=<stderr>)]>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 11:42] base.cli.run_cli: Error communicating with the assistant: 'Entity' object has no attribute 'value'

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x17ca456c0>
    │       └ <function run at 0x1010b7ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x17c5e2b00>
           │      └ <function Runner.run at 0x1010bbec0>
           └ <asyncio.runners.Runner object at 0x100a666d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1010b9b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x100a666d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1010b9a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1010bb880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x100ffdbc0>
    └ <Handle <TaskStepMethWrapper object at 0x163508b80>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x163508b80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x163508b80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x163508b80>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('9fa57d34-2d47-40e0-960a-697506ccb84b'), author=Entity(id=UUID('516356fd-1c20-4cb0-8298-c23355797a07'), name=...
          └ <function send_message at 0x102983ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 24, in send_message
    logger.info(f"Response from {message.author.value}.\n ❯ {message.content}")
    │      └ <function Logger.info at 0x1045bcd60>
    └ <loguru.logger handlers=[(id=1, level=20, sink='base/data/logs/logfile'), (id=2, level=20, sink=<stderr>)]>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/pydantic/main.py", line 734, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')

AttributeError: 'Entity' object has no attribute 'value'
[23-09-05 11:43] base.cli.run_cli: Starting CLI.
[23-09-05 11:43] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:43] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:43] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:43] base.handlers.message.build_manifest: {'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:43] base.handlers.message.build_manifest: [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:43] base.chat.send_message: Sending mmessage payload.
[23-09-05 11:43] base.chat.send_message: Response from Tim.
 ❯ /msg hi
[23-09-05 11:46] base.cli.run_cli: Starting CLI.
[23-09-05 11:46] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:46] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:46] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:46] base.handlers.message.build_manifest: {'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:46] base.handlers.message.build_manifest: [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:46] base.chat.send_message: Sending mmessage payload.
[23-09-05 11:46] base.chat.send_message: There was a problem delivering the message: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:46:18 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '4248', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '5846c762533acf670f2c951c2b07395d', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f42b2cf9525a2-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x142ed96c0>
    │       └ <function run at 0x104f3bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x142de2b00>
           │      └ <function Runner.run at 0x104f3fec0>
           └ <asyncio.runners.Runner object at 0x1048ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f3db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1048ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f3da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f3f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104e81bc0>
    └ <Handle <TaskStepMethWrapper object at 0x134d18130>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x134d18130>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x134d18130>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x134d18130>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('d64353cb-fd22-4777-b7ff-51cb6b3e85ea'), author=Entity(id=UUID('55be0fc3-f2d9-44fa-acc3-cd79d2e63bfb'), name=...
          └ <function send_message at 0x106807ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 23, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x104843560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x106fa7240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x106f87c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x1328ae9d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x106fa4180>
                             └ <openai.api_requestor.APIRequestor object at 0x1328ae9d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x106fa4220>
    └ <openai.api_requestor.APIRequestor object at 0x1328ae9d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x106f87ce0>
          └ <openai.api_requestor.APIRequestor object at 0x1328ae9d0>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:46:18 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '4248', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '5846c762533acf670f2c951c2b07395d', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f42b2cf9525a2-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 11:46] base.cli.run_cli: Error communicating with the assistant: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:46:18 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '4248', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '5846c762533acf670f2c951c2b07395d', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f42b2cf9525a2-GIG', 'alt-svc': 'h3=":443"; ma=86400')>

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x142ed96c0>
    │       └ <function run at 0x104f3bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x142de2b00>
           │      └ <function Runner.run at 0x104f3fec0>
           └ <asyncio.runners.Runner object at 0x1048ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x104f3db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1048ea6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x104f3da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x104f3f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x104e81bc0>
    └ <Handle <TaskStepMethWrapper object at 0x134d18130>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x134d18130>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x134d18130>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x134d18130>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('d64353cb-fd22-4777-b7ff-51cb6b3e85ea'), author=Entity(id=UUID('55be0fc3-f2d9-44fa-acc3-cd79d2e63bfb'), name=...
          └ <function send_message at 0x106807ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 23, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x104843560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x106fa7240>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x106f87c40>
                                 └ <openai.api_requestor.APIRequestor object at 0x1328ae9d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x106fa4180>
                             └ <openai.api_requestor.APIRequestor object at 0x1328ae9d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x106fa4220>
    └ <openai.api_requestor.APIRequestor object at 0x1328ae9d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x106f87ce0>
          └ <openai.api_requestor.APIRequestor object at 0x1328ae9d0>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID 5846c762533acf670f2c951c2b07395d in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 14:46:18 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '4248', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': '5846c762533acf670f2c951c2b07395d', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f42b2cf9525a2-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 11:46] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:46] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:46] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:46] base.handlers.message.build_manifest: {'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}
[23-09-05 11:46] base.handlers.message.build_manifest: [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
[23-09-05 11:46] base.chat.send_message: Sending mmessage payload.
[23-09-05 11:47] base.cli.run_cli: Starting CLI.
[23-09-05 11:47] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:47] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:47] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:47] base.chat.send_message: Sending message payload.
[23-09-05 11:47] base.chat.send_message: There was a problem delivering the message: too many values to unpack (expected 2)
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1646d96c0>
    │       └ <function run at 0x102b43ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1645deb00>
           │      └ <function Runner.run at 0x102b47ec0>
           └ <asyncio.runners.Runner object at 0x1024f26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102b45b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1024f26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102b45a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102b47880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102a89bc0>
    └ <Handle <TaskStepMethWrapper object at 0x159191f60>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x159191f60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x159191f60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x159191f60>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('5043edbd-70be-4089-87e4-46e44e3f150f'), author=Entity(id=UUID('3c5193c4-cf41-45fa-b354-d3099cded449'), name=...
          └ <function send_message at 0x10440fce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 23, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x10244b560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

ValueError: too many values to unpack (expected 2)
[23-09-05 11:47] base.cli.run_cli: Error communicating with the assistant: too many values to unpack (expected 2)

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1646d96c0>
    │       └ <function run at 0x102b43ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1645deb00>
           │      └ <function Runner.run at 0x102b47ec0>
           └ <asyncio.runners.Runner object at 0x1024f26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102b45b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1024f26d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102b45a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102b47880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102a89bc0>
    └ <Handle <TaskStepMethWrapper object at 0x159191f60>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x159191f60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x159191f60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x159191f60>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('5043edbd-70be-4089-87e4-46e44e3f150f'), author=Entity(id=UUID('3c5193c4-cf41-45fa-b354-d3099cded449'), name=...
          └ <function send_message at 0x10440fce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 23, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x10244b560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

ValueError: too many values to unpack (expected 2)
[23-09-05 11:48] base.cli.run_cli: Starting CLI.
[23-09-05 11:48] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:48] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:48] base.chat.send_message: Sending message payload.
[23-09-05 11:48] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:49] base.cli.run_cli: Starting CLI.
[23-09-05 11:49] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:49] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:49] base.chat.send_message: Sending message payload.
[23-09-05 11:49] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:49] base.chat.send_message: There was a problem delivering the message: too many values to unpack (expected 2)
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1620d96c0>
    │       └ <function run at 0x102e53ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x14fee2b00>
           │      └ <function Runner.run at 0x102e57ec0>
           └ <asyncio.runners.Runner object at 0x1028026d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102e55b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1028026d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102e55a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102e57880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102d99bc0>
    └ <Handle <TaskStepMethWrapper object at 0x14f098d90>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14f098d90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14f098d90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14f098d90>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('9df399de-b585-44ed-a0fb-290751b57151'), author=Entity(id=UUID('acf2a35a-cd38-4bdc-bc6a-d9e765bd2fec'), name=...
          └ <function send_message at 0x10471fce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x10275b560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

ValueError: too many values to unpack (expected 2)
[23-09-05 11:49] base.cli.run_cli: Error communicating with the assistant: too many values to unpack (expected 2)

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1620d96c0>
    │       └ <function run at 0x102e53ce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x14fee2b00>
           │      └ <function Runner.run at 0x102e57ec0>
           └ <asyncio.runners.Runner object at 0x1028026d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102e55b20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1028026d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x102e55a80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102e57880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102d99bc0>
    └ <Handle <TaskStepMethWrapper object at 0x14f098d90>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x14f098d90>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x14f098d90>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x14f098d90>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('9df399de-b585-44ed-a0fb-290751b57151'), author=Entity(id=UUID('acf2a35a-cd38-4bdc-bc6a-d9e765bd2fec'), name=...
          └ <function send_message at 0x10471fce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': <Role.user: 'user'>, 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x10275b560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

ValueError: too many values to unpack (expected 2)
[23-09-05 11:51] base.cli.run_cli: Starting CLI.
[23-09-05 11:51] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:51] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:51] base.chat.send_message: Sending message payload.
[23-09-05 11:51] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:51] base.chat.send_message: There was a problem delivering the message: too many values to unpack (expected 2)
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1702d56c0>
    │       └ <function run at 0x10535bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1701e2b00>
           │      └ <function Runner.run at 0x10535fec0>
           └ <asyncio.runners.Runner object at 0x104d0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10535db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104d0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10535da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10535f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1052a1bc0>
    └ <Handle <TaskStepMethWrapper object at 0x150416020>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x150416020>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x150416020>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x150416020>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('875ca983-3f54-45b3-9a1f-215630b8c259'), author=Entity(id=UUID('ac6f1a85-f5c2-45c3-97fe-ed772b861972'), name=...
          └ <function send_message at 0x106c27ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x104c63560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

ValueError: too many values to unpack (expected 2)
[23-09-05 11:51] base.cli.run_cli: Error communicating with the assistant: too many values to unpack (expected 2)

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x1702d56c0>
    │       └ <function run at 0x10535bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x1701e2b00>
           │      └ <function Runner.run at 0x10535fec0>
           └ <asyncio.runners.Runner object at 0x104d0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10535db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x104d0a6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10535da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10535f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1052a1bc0>
    └ <Handle <TaskStepMethWrapper object at 0x150416020>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x150416020>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x150416020>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x150416020>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('875ca983-3f54-45b3-9a1f-215630b8c259'), author=Entity(id=UUID('ac6f1a85-f5c2-45c3-97fe-ed772b861972'), name=...
          └ <function send_message at 0x106c27ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x104c63560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

ValueError: too many values to unpack (expected 2)
[23-09-05 11:57] base.cli.run_cli: Starting CLI.
[23-09-05 11:57] base.chat.send_message: Sending message: /msg hi
[23-09-05 11:57] base.handlers.message.__init__: Message handler initialized.
[23-09-05 11:57] base.chat.send_message: Sending message payload.
[23-09-05 11:57] base.handlers.message.build_manifest: Building manifest.
[23-09-05 11:57] base.chat.send_message: There was a problem delivering the message: too many values to unpack (expected 2)
Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288dd16c0>
    │       └ <function run at 0x10571bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288cdeb00>
           │      └ <function Runner.run at 0x10571fec0>
           └ <asyncio.runners.Runner object at 0x1050ca6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:52> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10571db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1050ca6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10571da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10571f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105661bc0>
    └ <Handle <TaskStepMethWrapper object at 0x28895ac20>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x28895ac20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x28895ac20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x28895ac20>()>

  File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('c5701a1f-1134-446a-bd8a-5fa0d0cf3bcb'), author=Entity(id=UUID('84cd4e78-3106-4d88-8509-9b4622c37f08'), name=...
          └ <function send_message at 0x106fe7ce0>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x105023560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

ValueError: too many values to unpack (expected 2)
[23-09-05 11:57] base.cli.run_cli: Error communicating with the assistant: too many values to unpack (expected 2)

Traceback (most recent call last):

  File "/Users/kaechle/Developer/projects/scint/app.py", line 11, in <module>
    asyncio.run(run_cli())
    │       │   └ <function run_cli at 0x288dd16c0>
    │       └ <function run at 0x10571bce0>
    └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object run_cli at 0x288cdeb00>
           │      └ <function Runner.run at 0x10571fec0>
           └ <asyncio.runners.Runner object at 0x1050ca6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<run_cli() running at /Users/kaechle/Developer/projects/scint/base/cli.py:54> cb=[_run_until...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10571db20>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1050ca6d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10571da80>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10571f880>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x105661bc0>
    └ <Handle <TaskStepMethWrapper object at 0x28895ac20>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x28895ac20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x28895ac20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x28895ac20>()>

> File "/Users/kaechle/Developer/projects/scint/base/cli.py", line 52, in run_cli
    await send_message(message)
          │            └ Message(id=UUID('c5701a1f-1134-446a-bd8a-5fa0d0cf3bcb'), author=Entity(id=UUID('84cd4e78-3106-4d88-8509-9b4622c37f08'), name=...
          └ <function send_message at 0x106fe7ce0>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response_message, response_function = await openai.chat(messages, functions)
                                                │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                                                │      │    └ [{'role': 'user', 'content': '/msg hi', 'name': 'Tim'}]
                                                │      └ <function chat at 0x105023560>
                                                └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

ValueError: too many values to unpack (expected 2)
[23-09-05 12:01] base.cli.run_cli: Starting CLI.
[23-09-05 12:01] base.chat.send_message: Sending message: /msg hi
[23-09-05 12:01] base.handlers.message.__init__: Message handler initialized.
[23-09-05 12:01] base.chat.send_message: Sending message payload.
[23-09-05 12:01] base.handlers.message.build_manifest: Building manifest.
[23-09-05 12:01] base.chat.send_message: Response from Assistant.
 ❯ Hello, how can I assist you today?
[23-09-05 12:04] base.chat.send_message: Sending message: string
[23-09-05 12:04] base.handlers.message.__init__: Message handler initialized.
[23-09-05 12:04] base.chat.send_message: Sending message payload.
[23-09-05 12:04] base.handlers.message.build_manifest: Building manifest.
[23-09-05 12:04] base.chat.send_message: There was a problem delivering the message: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 15:04:06 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '4149', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'a07f8c13f231899868de89374747afa6', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f5cc23e2425cd-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100cb1760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100a23a60>
           └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100a22fc0>
    └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101d24810>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>
    │    └ <function subprocess_started at 0x101ca7380>
    └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101d25d10>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101ca6480>
           │       │   └ <uvicorn.server.Server object at 0x101d25d10>
           │       └ <function run at 0x1016671a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101d29470>
           │      └ <function Runner.run at 0x10166b380>
           └ <asyncio.runners.Runner object at 0x101cef9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101668fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101cef9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101668f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10166ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1015fbe20>
    └ <Handle <TaskStepMethWrapper object at 0x284164460>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x284164460>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x284164460>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x284164460>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101d26190>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x101d89410>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101d26190>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284d218d0>
          └ <fastapi.applications.FastAPI object at 0x101d89410>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284dd5440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284d21890>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284d218d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd5620>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284d21850>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284d21890>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd5620>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x101d7f2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284d21850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd5620>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x102ac37e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd5620>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284d0b100>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284de7390>
                     └ <function get_request_handler.<locals>.app at 0x284d0aca0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102ac22a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66a...
                 │         └ <function assistant_chat at 0x284d0a980>
                 └ <fastapi.dependencies.models.Dependant object at 0x284d113d0>

  File "/Users/kaechle/Developer/projects/scint/api.py", line 17, in assistant_chat
    response = await send_message(message)
                     │            └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                     └ <function send_message at 0x101d81b20>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'role': 'system', 'content': 'string', 'name': 'Helloooooo'}]
                     │      └ <function chat at 0x102b87880>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x103225120>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103229b20>
                                 └ <openai.api_requestor.APIRequestor object at 0x17fa6bc90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x10322a020>
                             └ <openai.api_requestor.APIRequestor object at 0x17fa6bc90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x10322a0c0>
    └ <openai.api_requestor.APIRequestor object at 0x17fa6bc90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103229bc0>
          └ <openai.api_requestor.APIRequestor object at 0x17fa6bc90>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 15:04:06 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '4149', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'a07f8c13f231899868de89374747afa6', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f5cc23e2425cd-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 12:04] api.assistant_chat: Error communicating with the Scint API: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 15:04:06 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '4149', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'a07f8c13f231899868de89374747afa6', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f5cc23e2425cd-GIG', 'alt-svc': 'h3=":443"; ma=86400')>

Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100cb1760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100a23a60>
           └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100a22fc0>
    └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101d24810>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>
    │    └ <function subprocess_started at 0x101ca7380>
    └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101d25d10>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101ca6480>
           │       │   └ <uvicorn.server.Server object at 0x101d25d10>
           │       └ <function run at 0x1016671a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101d29470>
           │      └ <function Runner.run at 0x10166b380>
           └ <asyncio.runners.Runner object at 0x101cef9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101668fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101cef9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101668f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10166ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1015fbe20>
    └ <Handle <TaskStepMethWrapper object at 0x284164460>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x284164460>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x284164460>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x284164460>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101d26190>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x101d89410>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101d26190>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284d218d0>
          └ <fastapi.applications.FastAPI object at 0x101d89410>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284dd5440>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284d21890>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284d218d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd5620>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284d21850>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284d21890>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd5620>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x101d7f2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284d21850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd5620>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x102ac37e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd5620>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca850>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284d0b100>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284de7390>
                     └ <function get_request_handler.<locals>.app at 0x284d0aca0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102ac22a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66a...
                 │         └ <function assistant_chat at 0x284d0a980>
                 └ <fastapi.dependencies.models.Dependant object at 0x284d113d0>

> File "/Users/kaechle/Developer/projects/scint/api.py", line 17, in assistant_chat
    response = await send_message(message)
                     │            └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                     └ <function send_message at 0x101d81b20>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'role': 'system', 'content': 'string', 'name': 'Helloooooo'}]
                     │      └ <function chat at 0x102b87880>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x103225120>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103229b20>
                                 └ <openai.api_requestor.APIRequestor object at 0x17fa6bc90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x10322a020>
                             └ <openai.api_requestor.APIRequestor object at 0x17fa6bc90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x10322a0c0>
    └ <openai.api_requestor.APIRequestor object at 0x17fa6bc90>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103229bc0>
          └ <openai.api_requestor.APIRequestor object at 0x17fa6bc90>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID a07f8c13f231899868de89374747afa6 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 15:04:06 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '4149', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'a07f8c13f231899868de89374747afa6', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f5cc23e2425cd-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 12:04] base.chat.send_message: Sending message: string
[23-09-05 12:04] base.handlers.message.__init__: Message handler initialized.
[23-09-05 12:04] base.chat.send_message: Sending message payload.
[23-09-05 12:04] base.handlers.message.build_manifest: Building manifest.
[23-09-05 12:04] base.chat.send_message: There was a problem delivering the message: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 15:04:35 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '14900', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'de35b8c74a95ffd24d3d651f4d3a15a6', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f5d352ff62555-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100cb1760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100a23a60>
           └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100a22fc0>
    └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101d24810>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>
    │    └ <function subprocess_started at 0x101ca7380>
    └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101d25d10>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101ca6480>
           │       │   └ <uvicorn.server.Server object at 0x101d25d10>
           │       └ <function run at 0x1016671a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101d29470>
           │      └ <function Runner.run at 0x10166b380>
           └ <asyncio.runners.Runner object at 0x101cef9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101668fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101cef9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101668f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10166ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1015fbe20>
    └ <Handle <TaskStepMethWrapper object at 0x284164f10>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x284164f10>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x284164f10>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x284164f10>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101d26190>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x101d89410>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101d26190>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284d218d0>
          └ <fastapi.applications.FastAPI object at 0x101d89410>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284d0b420>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284d21890>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284d218d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd54e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284d21850>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284d21890>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd54e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x101d7f2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284d21850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd54e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x102ac37e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd54e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284d0b100>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284dca890>
                     └ <function get_request_handler.<locals>.app at 0x284d0aca0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102ac22a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66a...
                 │         └ <function assistant_chat at 0x284d0a980>
                 └ <fastapi.dependencies.models.Dependant object at 0x284d113d0>

  File "/Users/kaechle/Developer/projects/scint/api.py", line 17, in assistant_chat
    response = await send_message(message)
                     │            └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                     └ <function send_message at 0x101d81b20>

> File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'role': 'system', 'content': 'string', 'name': 'Helloooooo'}]
                     │      └ <function chat at 0x102b87880>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x103225120>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103229b20>
                                 └ <openai.api_requestor.APIRequestor object at 0x284dda110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x10322a020>
                             └ <openai.api_requestor.APIRequestor object at 0x284dda110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x10322a0c0>
    └ <openai.api_requestor.APIRequestor object at 0x284dda110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103229bc0>
          └ <openai.api_requestor.APIRequestor object at 0x284dda110>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 15:04:35 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '14900', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'de35b8c74a95ffd24d3d651f4d3a15a6', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f5d352ff62555-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 12:04] api.assistant_chat: Error communicating with the Scint API: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 15:04:35 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '14900', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'de35b8c74a95ffd24d3d651f4d3a15a6', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f5d352ff62555-GIG', 'alt-svc': 'h3=":443"; ma=86400')>

Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x100cb1760>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x100a23a60>
           └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x100a22fc0>
    └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x101d24810>, 'target': <bound method Server.run of <uvicorn.server.Server object...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>
    │    └ <function subprocess_started at 0x101ca7380>
    └ <SpawnProcess name='SpawnProcess-1' parent=27296 started>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/_subprocess.py", line 76, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x101d25d10>>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/server.py", line 61, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=2, type=1, proto=0, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x101ca6480>
           │       │   └ <uvicorn.server.Server object at 0x101d25d10>
           │       └ <function run at 0x1016671a0>
           └ <module 'asyncio' from '/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyn...

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x101d29470>
           │      └ <function Runner.run at 0x10166b380>
           └ <asyncio.runners.Runner object at 0x101cef9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at /Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x101668fe0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x101cef9d0>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x101668f40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10166ad40>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1015fbe20>
    └ <Handle <TaskStepMethWrapper object at 0x284164f10>()>

  File "/opt/homebrew/Cellar/python@3.11/3.11.5/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x284164f10>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x284164f10>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x284164f10>()>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101d26190>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x101d89410>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x101d26190>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/applications.py", line 289, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284d218d0>
          └ <fastapi.applications.FastAPI object at 0x101d89410>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x284d0b420>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284d21890>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x284d218d0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd54e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284d21850>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x284d21890>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd54e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <fastapi.routing.APIRouter object at 0x101d7f2d0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x284d21850>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd54e0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x102ac37e0>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ExceptionMiddleware.__call__.<locals>.sender at 0x284dd54e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x284dca2d0>>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x284d0b100>
          └ APIRoute(path='/assistant/', name='assistant_chat', methods=['POST'])
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x284dca890>
                     └ <function get_request_handler.<locals>.app at 0x284d0aca0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 273, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102ac22a0>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/fastapi/routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'message': Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66a...
                 │         └ <function assistant_chat at 0x284d0a980>
                 └ <fastapi.dependencies.models.Dependant object at 0x284d113d0>

> File "/Users/kaechle/Developer/projects/scint/api.py", line 17, in assistant_chat
    response = await send_message(message)
                     │            └ Message(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), author=Entity(id=UUID('3fa85f64-5717-4562-b3fc-2c963f66afa6'), name=...
                     └ <function send_message at 0x101d81b20>

  File "/Users/kaechle/Developer/projects/scint/base/chat.py", line 22, in send_message
    response = await openai.chat(messages, functions)
                     │      │    │         └ [{'name': 'locator', 'description': 'Initialize the locator state to search for files, data, or information required for user...
                     │      │    └ [{'role': 'system', 'content': 'string', 'name': 'Helloooooo'}]
                     │      └ <function chat at 0x102b87880>
                     └ <module 'base.providers.openai' from '/Users/kaechle/Developer/projects/scint/base/providers/openai.py'>

  File "/Users/kaechle/Developer/projects/scint/base/providers/openai.py", line 19, in chat
    response = await ChatCompletion.acreate(
                     │              └ <classmethod(<function ChatCompletion.acreate at 0x103225120>)>
                     └ <class 'openai.api_resources.chat_completion.ChatCompletion'>

  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/chat_completion.py", line 45, in acreate
    return await super().acreate(*args, **kwargs)
                                  │       └ {'model': 'gpt-4-0613', 'temperature': 1.8, 'top_p': 1, 'frequency_penalty': 0.4, 'presence_penalty': 0.4, 'logit_bias': {110...
                                  └ ()
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_resources/abstract/engine_api_resource.py", line 217, in acreate
    response, _, api_key = await requestor.arequest(
                                 │         └ <function APIRequestor.arequest at 0x103229b20>
                                 └ <openai.api_requestor.APIRequestor object at 0x284dda110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 382, in arequest
    resp, got_stream = await self._interpret_async_response(result, stream)
                             │    │                         │       └ False
                             │    │                         └ <ClientResponse(https://api.openai.com/v1/chat/completions) [500 Internal Server Error]>
                             │    │                           <CIMultiDictProxy('Date': 'Tue, 05 S...
                             │    └ <function APIRequestor._interpret_async_response at 0x10322a020>
                             └ <openai.api_requestor.APIRequestor object at 0x284dda110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 728, in _interpret_async_response
    self._interpret_response_line(
    │    └ <function APIRequestor._interpret_response_line at 0x10322a0c0>
    └ <openai.api_requestor.APIRequestor object at 0x284dda110>
  File "/Users/kaechle/Library/Caches/pypoetry/virtualenvs/scint-tXXp93ol-py3.11/lib/python3.11/site-packages/openai/api_requestor.py", line 765, in _interpret_response_line
    raise self.handle_error_response(
          │    └ <function APIRequestor.handle_error_response at 0x103229bc0>
          └ <openai.api_requestor.APIRequestor object at 0x284dda110>

openai.error.APIError: The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.) {
  "error": {
    "message": "The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.)",
    "type": "server_error",
    "param": null,
    "code": null
  }
}
 500 {'error': {'message': 'The server had an error processing your request. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if you keep seeing this error. (Please include the request ID de35b8c74a95ffd24d3d651f4d3a15a6 in your email.)', 'type': 'server_error', 'param': None, 'code': None}} <CIMultiDictProxy('Date': 'Tue, 05 Sep 2023 15:04:35 GMT', 'Content-Type': 'application/json', 'Content-Length': '366', 'Connection': 'keep-alive', 'Access-Control-Allow-Origin': '*', 'openai-model': 'gpt-4-0613', 'openai-organization': 'buftype', 'openai-processing-ms': '14900', 'openai-version': '2020-10-01', 'strict-transport-security': 'max-age=15724800; includeSubDomains', 'x-ratelimit-limit-requests': '200', 'x-ratelimit-limit-tokens': '40000', 'x-ratelimit-remaining-requests': '199', 'x-ratelimit-remaining-tokens': '39981', 'x-ratelimit-reset-requests': '300ms', 'x-ratelimit-reset-tokens': '28ms', 'x-request-id': 'de35b8c74a95ffd24d3d651f4d3a15a6', 'CF-Cache-Status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '801f5d352ff62555-GIG', 'alt-svc': 'h3=":443"; ma=86400')>
[23-09-05 12:04] base.chat.send_message: Sending message: string
[23-09-05 12:04] base.handlers.message.__init__: Message handler initialized.
[23-09-05 12:04] base.chat.send_message: Sending message payload.
[23-09-05 12:04] base.handlers.message.build_manifest: Building manifest.
[23-09-05 12:08] base.chat.send_message: Sending message: Hellooooo
[23-09-05 12:08] base.handlers.message.__init__: Message handler initialized.
[23-09-05 12:08] base.chat.send_message: Sending message payload.
[23-09-05 12:08] base.handlers.message.build_manifest: Building manifest.
[23-09-05 12:08] base.chat.send_message: Response from Assistant.
 ❯ # Salutations typingsSlinky
[23-09-05 12:09] base.chat.send_message: Sending message: Hellooooo
[23-09-05 12:09] base.handlers.message.__init__: Message handler initialized.
[23-09-05 12:09] base.chat.send_message: Sending message payload.
[23-09-05 12:09] base.handlers.message.build_manifest: Building manifest.
[23-09-05 12:09] base.chat.send_message: Response from Assistant.
 ❯ # Example

## User
Hey, can you find me a recipe for apple pie?

## Assistant to=functions.locator
{
  "search_query": "apple pie recipe",
  "success_definition": "A detailed recipe for apple pie including ingredients and instructions",
  "user_response": "Sure, I'm searching for an apple pie recipe now."
}
[23-09-05 12:39] base.chat.send_message: Sending message: Hello there. How are you?
[23-09-05 12:39] base.handlers.message.__init__: Message handler initialized.
[23-09-05 12:39] base.chat.send_message: Sending message payload.
[23-09-05 12:39] base.handlers.message.build_manifest: Building manifest.
[23-09-05 12:39] base.chat.send_message: Response from Assistant.
 ❯ Hi! I'm an AI developed by OpenAI. I don't have feelings, but I'm here to help you. How can I assist you today?
